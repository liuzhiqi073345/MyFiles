ik.qb=ik.qb||{};ik=window.ik=window.ik||{};ik.editor=function(C,B,F){var E=baidu.g(C);if(!E){return }if(baidu.lang.isFunction(B)){F=B;B=undefined}var A=++ik.editor.fn.guid;E.guid="editor_"+ik.editor.fn.now()+"_"+A;E.innerHTML='<div class="title editor_title"></div><div class="word-error num_error editor_txtoverrange">输入内容已经达到长度限制</div><div class="word-tip editor_txtremain">还能输入<span class="f20">&nbsp;<span class="count editor_txtremain_count">9999</span>&nbsp;</span>字</div><div class="clear"></div><div class="box-gr mb20"><div class="bar editor_bar"><span class="editor_pic"><span class="icon i-insertimg editor_btnpic">插入图片</span><span class="icon i-deleteimg editor_btnpic_del" title="删除图片">删除图片</span></span><span class="editor_map"><span class="icon i-insertmap editor_btnmap">插入地图</span><span class="icon i-deletemap editor_btnmap_del" title="删除地图">删除地图</span></span><span class="editor_v"><span class="icon i-insertvideo editor_btnvideo">插入视频</span><span class="editor_btnvideo_del" title="视频地图">视频地图</span></span></div><textarea class="editor_txt"></textarea></div><div class="err-tip editor_summary"></div><span class="refer editor_refer"><label class="f12 editor_referlabel">参考资料：</label><input class="editor_txtrefer" value="" name="" /></span><button class="btn btn-submit editor_btnsubmit" type="button"><span><b>确定</b></span></button><div class="clear"></div>';E.options=baidu.extend({},ik.editor.option);if(B){E.options=baidu.extend(E.options,B)}E.pic_wrap=baidu.dom.query(".editor_pic",E)[0];E.map_wrap=baidu.dom.query(".editor_map",E)[0];E.video_wrap=baidu.dom.query(".editor_v",E)[0];E.refer_wrap=baidu.dom.query(".editor_refer",E)[0];E.title_wrap=baidu.dom.query(".editor_title",E)[0];E.bar_wrap=baidu.dom.query(".editor_bar",E)[0];E.btnpic=baidu.dom.query(".editor_btnpic",E)[0];E.btnmap=baidu.dom.query(".editor_btnmap",E)[0];E.btnvideo=baidu.dom.query(".editor_btnvideo",E)[0];E.btnpic_del=baidu.dom.query(".editor_btnpic_del",E)[0];E.btnmap_del=baidu.dom.query(".editor_btnmap_del",E)[0];E.btnvideo_del=baidu.dom.query(".editor_btnvideo_del",E)[0];E.btnsubmit=baidu.dom.query(".editor_btnsubmit",E)[0];E.txtcontent=baidu.dom.query(".editor_txt",E)[0];E.txtrefer=baidu.dom.query(".editor_txtrefer",E)[0];E.txtoverrange=baidu.dom.query(".editor_txtoverrange",E)[0];E.txtremain=baidu.dom.query(".editor_txtremain",E)[0];E.txtremain_count=baidu.dom.query(".editor_txtremain_count",E)[0];E.tipsummary=baidu.dom.query(".editor_summary",E)[0];E.values={pic:"",map:"",text:"",refer:""};E._submit=function(){ik.editor.config.pageModify=false;var H={};H.co=E.values.text;H.pid=E.values.pic;H.sn=E.values.refer;H.exturl=E.values.map;H.cite=E.values.refer;H.map=E.values.map;E.options.onsubmit.call(E,H)};E.setTitle=function(H){E.title_wrap.innerHTML=H;return E};E.setPic=function(H){baidu.hide(E.btnpic_del);E.values.pic="";if(E.options.pic){if(H&&H.length>1){E.values.pic=H;baidu.show(E.btnpic_del);baidu.hide(E.btnpic)}}return E};E.setMap=function(H){baidu.hide(E.btnmap_del);E.values.map="";if(E.options.map){if(H&&H.length>1){E.values.map=H;baidu.hide(E.btnmap);baidu.show(E.btnmap_del)}}return E};E.setValue=function(H){E.txtcontent.value=H;E.values.text=E.txtcontent.value;E._checkNum();ik.editor.fn.unsetTip(E.txtcontent);return E};E.setRefer=function(H){baidu.hide(E.refer_wrap);E.txtrefer.value="";if(E.options.refer){if(H&&H.length>1){E.txtrefer.value=H}baidu.show(E.refer_wrap)}ik.editor.fn.unsetTip(E.txtrefer);E.values.refer=E.txtrefer.value;return E};E.showSummary=function(H){baidu.hide(E.tipsummary);if(H&&H.length>1){E.tipsummary.innerHTML=H;baidu.show(E.tipsummary)}return E};E.getPic=function(){return E.values.pic};E.getMap=function(){return E.values.map};E.getValue=function(){if(E.txtcontent.value==(E.options.txttiptype?E.options.txttip[0]:E.options.txttip[1])){return E.values.text=""}return E.values.text=ik.editor.fn.trim(E.txtcontent.value)};E.getRefer=function(){if(E.txtrefer.value==E.options.refertip){return E.values.refer=""}return E.values.refer=ik.editor.fn.trim(E.txtrefer.value)};E.txtnum=0;E._checkNum=function(){var H=ik.editor.fn.byteLength(ik.editor.fn.trim(E.txtcontent.value));E.txtnum=0;E.values.text=ik.editor.fn.trim(E.txtcontent.value);ik.editor.config.pageModify=true;var I=Math.floor((E.options.maxLength-H)/2);if(I<0){baidu.show(E.txtoverrange);baidu.hide(E.txtremain)}else{E.txtnum=1;baidu.hide(E.txtoverrange);E.txtremain_count.innerHTML=I;baidu.show(E.txtremain)}};baidu.hide(E.video_wrap);baidu.hide(E.tipsummary);baidu.hide(E.txtoverrange);baidu.hide(E.txtremain);if(E.options.value.length>1){E.setValue(E.options.value)}else{ik.editor.fn.setTip(E.txtcontent,E.options.txttiptype?E.options.txttip[0]:E.options.txttip[1])}E._timer={t:null,r:null,fn:{t:function(){E._checkNum();E._timer.t=setTimeout("editor._timer.fn.t()",10)},r:function(){E._timer.r=setTimeout(E._timer.fn.r(),10)}}};baidu.on(E.txtcontent,"keyup",function(H){E._checkNum();baidu.hide(E.tipsummary)});baidu.on(E.txtcontent,"focus",function(H){E._timer.t=setTimeout("editor._timer.fn.t()",10)});baidu.on(E.txtcontent,"blur",function(H){try{clearTimeout(E._timer.t)}catch(H){E._timer.t=null}});baidu.on(E.txtrefer,"keyup",function(H){baidu.hide(E.tipsummary)});if(E.options.pic){window.editor=E;E.options.picSetEnable.call(E);baidu.on(E.btnpic,"click",function(H){window.editor=E;E.options.picFn.call(E);baidu.event.preventDefault(H)})}else{window.editor=E;E.options.picSetDisable.call(E);baidu.on(E.btnpic,"click",function(H){baidu.event.preventDefault(H)})}baidu.on(E.btnpic_del,"click",function(H){E.setPic();baidu.show(E.btnpic);baidu.event.preventDefault(H)});if(E.options.map){window.editor=E;E.options.mapSetEnable.call(E);baidu.on(E.btnmap,"click",function(H){window.editor=E;E.options.mapFn.call(E);baidu.event.preventDefault(H)})}else{window.editor=E;E.options.mapSetDisable.call(E);baidu.on(E.btnmap,"click",function(H){baidu.event.preventDefault(H)})}baidu.on(E.btnmap_del,"click",function(H){window.editor=E;E.setMap();baidu.show(E.btnmap);baidu.event.preventDefault(H)});if(!E.options.bar){baidu.hide(E.bar_wrap)}if(E.options.refer){window.editor=E;baidu.show(E.refer_wrap);if(E.options.referValue.length>1){E.setRefer(E.options.referValue)}else{ik.editor.fn.setTip(E.txtrefer,E.options.refertip)}}else{baidu.hide(E.refer_wrap)}baidu.on(E.btnsubmit,"click",function(H){window.editor=E;if(E.options.beforSubmit.call(E)&&E.txtnum){E._submit()}baidu.event.preventDefault(H)});var D=E.txtcontent.parentNode.offsetWidth;E.txtcontent.style.width=(D-14)+"px";E.setTitle(E.options.title);E.setPic(E.options.picvalue);E.setMap(E.options.mapvalue);if(F&&baidu.lang.isFunction(F)){F.call(E)}return E};ik.editor.config={pageModify:false};ik.editor.fn={pageunload:function(A){if(ik.editor.config.pageModify){A.returnValue="请注意：您的编辑内容还没有进行保存!"}},setTipStyle:function(A){this.style.color="#000";this.value="";baidu.un(this,"focus",ik.editor.fn.setTipStyle)},setTip:function(B,A){B.style.color="#ccc";B.value=A;baidu.on(B,"focus",ik.editor.fn.setTipStyle)},unsetTip:function(A){A.style.color="#000";baidu.un(A,"focus",ik.editor.fn.setTipStyle)},guid:0,now:function(){return(new Date).getTime()},trim:function(A){return A.replace(/(^[\s\t\xa0\u3000]+)|([\u3000\xa0\s\t]+$)/g,"")},byteLength:function(A){return A.replace(/[^\u0000-\u007f]/g,"\u0061\u0061").length}};ik.editor.option={maxLength:19999,title:"",value:"",allowNull:false,txttiptype:false,txttip:["该提问求助发自手机，请精简回答，方便查看","回答即可得2分经验值，回答被采纳可同步增加经验值和财富值"],txtMaxText:function(){return"您提交的答案超过"+Math.floor(this.maxLength/2)+"字，请删减"},txtBlankText:function(){return"请您输入文字内容"},bar:true,pic:true,pictip:["二级及以上用户登录后可以上传图片。","图片可用于辅助说明回答，请勿上传签名档等与回答无关的图片。"],picvalue:"",picSetEnable:function(){this.btnpic.title=this.options.pictip[1]},picSetDisable:function(){this.btnpic.title=this.options.pictip[0];this.btnpic.disabled=true;baidu.addClass(this.btnpic,"i-insertimg-disable")},picFn:function(){var B="http://pp.zhidao.baidu.com";pop.show("插入图片",{url:B+"/g?ct=16&cm=1&tn=ikimageupload&t="+(new Date()).getTime(),width:450,height:260});var A=window.IknowImage=window.IknowImage||{};A.uploadImageSuccess=function(C){editor.setPic(C)};A.showSmallImage=function(){}},map:true,mapvalue:"",maptip:["登录后可以插入地图。","地图可以帮助您更直观有效的表述回答。"],mapSetEnable:function(){this.btnmap.title=this.options.maptip[1]},mapSetDisable:function(){this.btnmap.title=this.options.maptip[0];this.btnmap.disabled=true;baidu.addClass(this.btnmap,"i-insertmap-disable")},mapFn:function(){pop.show("插入地图",{url:"http://zhidao.baidu.com/html/map.html",width:710,height:480});var B=null;var A=window.iknowMap=window.iknowMap||{};A.ondata=function(C){pop.hide();if(!C){return }if(C.url){editor.setMap("<a href='"+C.url+"' rel='baidu:map:maplink'>百度地图</a>")}if(C.info!=""){editor.txtcontent.focus();setTimeout(function(){editor.setValue(editor.getValue()+"\n"+decodeURIComponent(C.info))},200)}pop.alert("插入地图",{info:'<div style="text-align:center;margin-top:20px;font-size:14px;">地图插入成功</div>',onclose:function(){clearTimeout(B)},width:350,height:100});clearTimeout(B);B=setTimeout(function(){pop.hide()},3000);editor.txtcontent.focus()}},refer:true,referValue:"",referMaxLength:100,referMaxText:function(){return"您提交的参考资料超过"+Math.floor(this.referMaxLength/2)+"字，请删除"},refertip:"如果您的回答是从其他地方引用，请表明出处",beforSubmit:function(){var B=1;var A=ik.editor.fn.byteLength(editor.getValue());if(A<1&&!editor.options.allowNull){editor.showSummary(editor.options.txtBlankText());editor.txtcontent.focus();return B=0}else{if(A>editor.options.maxLength){editor.showSummary(editor.options.txtMaxText());editor.txtcontent.focus();return B=0}}if(editor.options.refer){A=ik.editor.fn.byteLength(editor.getRefer());if(A>editor.options.referMaxLength){editor.showSummary(editor.options.referMaxText());editor.txtrefer.focus();return B=0}}return B},onsubmit:function(B){var A=["values.text:"+B.text,"values.pic:"+B.pic,"values.map:"+B.map,"values.refer:"+B.refer];alert(A.join("\n"))}};baidu.on(window,"beforeunload",function(A){ik.editor.fn.pageunload(A)});ik=window.ik=window.ik||{};ik.vCfg=function(A){this.q={};this.a={};this.ext=function(D,E){if(D&&"object"==typeof D){var B=!!E?this[E]:this.q;B=B||{};for(var C in D){B[C]=D[C]}}return this};this.ext({tn:"",cname:"",bar:"购买要求",expand:1,hasfix:0,title:""}).ext({hastn:0,hasbar:0,tn:""},"a").ext(A)};ik.vCfg.medical=function(B,A){return new ik.vCfg().ext({tn:"medical",cname:"医疗健康 -&gt; "+B+(!!A?" -&gt; "+A:""),bar:"患者咨询（选填）"})};ik.vCfg.car=function(B,A){return new ik.vCfg().ext({tn:"car",cname:"生活 -&gt; "+B+(!!A?" -&gt; "+A:""),title:"请清晰、简明的描述您的问题，并且填写下面的购买要求。",bar:"请选择您的提问目的",hasfix:1}).ext({hastn:1},"a")};ik.vCfg.phone=function(B,A){return new ik.vCfg().ext({tn:"phone",cname:"电子数码 -&gt; "+B+(!!A?" -&gt; "+A:""),title:"请清晰、简明的描述您的问题，并且填写下面的购买要求。",bar:"请选择您的提问目的",hasfix:1})};ik.verticalCfg={"155":ik.vCfg.car("购车养车"),"858":ik.vCfg.car("购车养车","汽车购买"),"859":ik.vCfg.car("购车养车","汽车养护"),"1078":ik.vCfg.phone("手机/通讯"),"839":ik.vCfg.phone("手机/通讯","手机购买"),"1040":ik.vCfg.phone("手机/通讯","手机使用"),"1105":ik.vCfg.phone("手机/通讯","通讯服务"),"790":ik.vCfg.medical("内科"),"940":ik.vCfg.medical("内科","呼吸内科"),"939":ik.vCfg.medical("内科","心血管内科"),"1082":ik.vCfg.medical("内科","消化内科"),"1080":ik.vCfg.medical("内科","肾内科"),"941":ik.vCfg.medical("内科","神经内科"),"1083":ik.vCfg.medical("内科","内分泌科"),"938":ik.vCfg.medical("内科","血液科"),"1081":ik.vCfg.medical("内科","风湿科"),"791":ik.vCfg.medical("外科"),"1091":ik.vCfg.medical("外科","心胸外科"),"1085":ik.vCfg.medical("外科","脑外科"),"1087":ik.vCfg.medical("外科","肝胆外科"),"1084":ik.vCfg.medical("外科","泌尿外科"),"1086":ik.vCfg.medical("外科","肛肠外科"),"936":ik.vCfg.medical("外科","骨科"),"937":ik.vCfg.medical("外科","外伤科"),"770":ik.vCfg.medical("肿瘤科"),"792":ik.vCfg.medical("妇产科"),"931":ik.vCfg.medical("妇产科","妇科"),"935":ik.vCfg.medical("妇产科","产科"),"793":ik.vCfg.medical("儿科"),"795":ik.vCfg.medical("五官科"),"1088":ik.vCfg.medical("五官科","眼科"),"1089":ik.vCfg.medical("五官科","耳鼻喉科"),"1090":ik.vCfg.medical("五官科","口腔科"),"930":ik.vCfg.medical("男科"),"796":ik.vCfg.medical("传染科"),"143":ik.vCfg.medical("精神心理科"),"794":ik.vCfg.medical("皮肤科")};ik.verticalCfg.init=function(B){if(this[B].constructor!==ik.vCfg){var A=new ik.vCfg();if(!this[B].q&&!this[B].a){A.ext(this[B])}else{A.ext(this[B].q).ext(this[B].a,"a")}this[B]=A}};defalutLoginSuccess=function(){window.location=window.location};var IknowEgg=(function(){var time=new Date(new Date().getTime()+3600000*24);var eggtype=ik.qb.data.get("extra","eggType");var crypt=ik.qb.data.get("extra","eggCrypt");var _cookie=cookie.get("IKNEGG");function hide(){G("iknowguidecontent").innerHTML="";baidu.hide("iknowguideegg")}function delay(){hide();cookie.set("IKNEGG","0_"+eggtype+"_"+crypt,time,"/")}function close(){hide();cookie.set("IKNEGG","9_0_0",time,"/")}function reg(){hide();cookie.set("IKNEGG","1_"+eggtype+"_"+crypt,time,"/");login.register()}function dologin(){hide();cookie.set("IKNEGG","1_"+eggtype+"_"+crypt,time,"/");login.log()}function done(){baidu.ajax.post("/q","ct=22&cm=100505&word="+crypt+"&qid="+eggtype+"&tn=ikajaxsubmit",function(xhr){var res;res=eval("("+xhr.responseText+")");if(res.result=="0"&&res.browseEggType>0){IknowEgg.success(res.browseEggType)}if(res.result=="12500"){pop.show("友情提示",{info:"您今天已中过彩蛋",width:"350",height:"100"});setTimeout(pop.hide,3000)}});cookie.set("IKNEGG","2_0_0",time,"/")}function init(){var wrap=baidu.dom.create("div",{id:"iknowguideegg",style:"position:absolute;top:200px;left:560px;z-index:500"});wrap.appendChild(baidu.dom.create("div",{id:"iknowguidehandle",style:"position:absolute;top:0;left:0;width:300px;height:35px;cursor:move;z-index:500"}));wrap.appendChild(baidu.dom.create("div",{id:"iknowguidecontent"}));document.body.appendChild(wrap);baidu.hide("iknowguideegg");var islogin=(ik.qb.data.get("user","isLogin")=="1");var newegg=false;if(!_cookie){_cookie="0_"+eggtype+"_"+crypt;newegg=true}var egg=_cookie.split("_");var status=egg[0];eggtype=eggtype>0?eggtype:(egg[1]||0);crypt=crypt.length==0?(egg[2]||0):crypt;if(!eggtype||eggtype<=0||status>1){return }_cookie=[status,eggtype,crypt].join("_");var qbguide=cookie.get("IKGUIDE");if(!islogin&&(qbguide=="-1"&&G("newuserguide"))){return }if(status=="0"){G("iknowguidecontent").innerHTML='<object title="知道彩蛋" onmousedown="EggCallBack('+eggtype+')" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,28,0" width="150" height="150"><param name="movie" value="http://img.baidu.com/img/iknow/egg/egg.swf" /><param name="quality" value="high" /><param name="wmode" value="transparent" /><embed src="http://img.baidu.com/img/iknow/egg/egg.swf" width="150" height="150" quality="high" pluginspage="http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash" type="application/x-shockwave-flash" wmode="transparent"></embed></object>';log.send(location.href,100,{cmd:"eggshow",eggid:eggtype});baidu.show("iknowguideegg");if(!newegg){cookie.set("IKNEGG",_cookie,new Date(0),"/")}}if(status=="1"){if(ik.qb.data.get("user","isLogin")=="1"){IknowEgg.done()}}baidu.sio.callByBrowser("http://iknow.bdimg.com/base/js/baidu.dragable.js",function(){try{baidu.dragable(G("iknowguideegg"),{handler:G("iknowguidehandle")})}catch(e){}})}function success(type){if(type>0){baidu.show("iknowguideegg");try{G("iknowguidecontent").innerHTML='<iframe id="IKNEGGframe" name="IKNEGGframe"  style="width:420px;height:360px;border:0;" frameborder="no" scrolling="no"></iframe>';setTimeout(function(){G("IKNEGGframe").src="/egg/"+type+"done.html?t="+time.getTime()},150)}catch(e){}}}return{hide:hide,close:close,success:success,done:done,reg:reg,login:dologin,delay:delay,init:init}})();function EggCallBack(A){log.send(location.href,101,{cmd:"eggclick",eggid:A});if((ik.qb.data.get("user","isLogin")=="1")){baidu.hide("iknowguideegg");IknowEgg.done()}else{G("iknowguidecontent").innerHTML='<iframe src="/egg/'+A+'.html" width="420" height="360" frameborder="no" border="0" marginwidth="0" marginheight="0" scrolling="no"></iframe>'}}ik.qb.logKey=2014;ik.qb.time={pageStart:(new Date()).getTime()};ik.qb.fn={getReplyInfo:function(E){if(baidu.g(E)){var C={};var A=baidu.dom.getAncestorByClass(E,"entry");if(A&&/reply-box-\d+/.test(A.id)){var B=baidu.dom.query("#"+A.id+" .reply-data input");baidu.each(B,function(I,H){C[I.name]=I.value});return C}var F=baidu.dom.getAncestorByClass(E,"best-answer-panel");if(F){var B=baidu.dom.query(".best-answer-panel .reply-data input");baidu.each(B,function(I,H){C[I.name]=I.value});return C}var D=baidu.dom.getAncestorByClass(E,"recommend-answer-panel");if(D){var B=baidu.dom.query(".recommend-answer-panel .reply-data input");baidu.each(B,function(I,H){C[I.name]=I.value});return C}return null}return null},getQuestionInfo:function(){var C=baidu.g("question-box");if(C){var A={};var B=baidu.dom.query("#question-box .question-data input");baidu.each(B,function(E,D){A[E.name]=E.value});return A}return null},getDataById:function(D){var B={};var C=D;if(/\D[0-9]*$/.test(C)){C=C.match(/[0-9]*$/)[0]}var A=baidu.dom.query("#data-"+C+" input");baidu.array.each(A,function(F,E){B[F.name]=F.value});return B},parseData:function(){var A=baidu.dom.query(".question-data input");baidu.each(A,function(D,C){ik.qb.data.add("q",D.name,D.value)});var B=[];if(baidu.g("reply-panel")||baidu.g("recommend-answer-panel")){baidu.each(baidu.q("reply-data"),function(E,C){var D={};baidu.each(E.getElementsByTagName("input"),function(F){D[F.name]=F.value});B.push(D);D=null})}ik.qb.data.add("reply",B)},createBox:function(E,D,A){var C=baidu.dom.create("div",{className:"box-gray "+E});var B='<div class="header mb10">'+D+"</div>";B+='<div class="body">'+A+"</div>";C.innerHTML=B;return C}};ik.qb.user=(function(){return{init:function(){if(ik.qb.data.get("user","isLogin")=="0"){var A=baidu.g("login-kernel").getElementsByTagName("input");baidu.each(A,function(D,C){if(/password|text/.test(D.type)){var B=D.className;baidu.on(D,"focus",function(E){baidu.addClass(this,"text-focus")});baidu.on(D,"blur",function(E){baidu.removeClass(this,"text-focus")})}});baidu._on("pass-login-form","submit",function(B){log.send(location.href,ik.qb.logKey,{area:"user",pos:"login",action:"login"});baidu.event.preventDefault(B);if(baidu.string.trim(this.username.value)==""){this.username.focus();return }if(baidu.string.trim(this.password.value)==""){this.password.focus();return }this.mem_pass.value=(this.mem_pass.checked)?"on":"off";this.submit()})}else{ik.qb.user.build(ik.qb.data.get("user"))}},build:function(E){var D=E;var B=D.iconType,H=D.userSex,K=D.gradeIndex;var C=baidu.g("user-kernel");if(C){var F=baidu.dom.create("img",{height:66,width:66,src:"http://img.baidu.com/img/iknow/avarta/66/r"+B+"s"+H+"g"+K+".gif",className:"user-head-img"});var I=baidu.dom.query("#user-kernel .avarta a")[0];I.appendChild(F);I.href="/q?ct=24&cm=16&tn=ucframework";baidu.dom.query("#user-kernel .user-name")[0].innerHTML=D.userName;var L=baidu.dom.query("#user-kernel .i-grade")[0];L.innerHTML=D.gradeIndexName+"级";L.title="采纳率："+D.goodRate;baidu.dom.addClass(L,"i-grade-"+D.userLevel+" i-star-"+D.userSubLevel);var J=baidu.dom.create("li",{className:"msg-num"});var A=parseInt(ik.qb.data.get("user","msgNum"));if(A>0){baidu.dom.addClass(J,"red");J.innerHTML='<a log="user.msglink.click" href="/q?ct=24&cm=16&tn=ucframework#msglink" target="_blank">（'+A+"）条消息等待处理</a>"}else{baidu.dom.addClass(J,"gray");J.innerHTML="（0）条消息等待处理"}baidu.dom.query("#user-kernel ul")[0].appendChild(J)}}}})();ik.qb.answer=(function(){var A={cm:100009,qid:ik.qb.data.get("page","qid"),cid:ik.qb.data.get("page","cid"),path:"/question/"+ik.qb.data.get("page","qid")+".html",code:"",title:ik.qb.data.get("extra","ti")};return{formInstance:null,init:function(){var C=ik.qb.data.get("user","uploadImg");var B=ik.qb.data.get("user","uploadMap");var D=ik.qb.data.get("page","fromWap");ik.editor("answer-editor",{onsubmit:function(I){var F=baidu.g("unname-reply");if(F&&F.checked){I.anoy=1}var E=ik.qb.vertical;if(E.hastn&&E.isInit&&E.tplStr){var H=E.tplStr;I.co=H+I.co}ik.qb.answer.check(I)},bar:(D=="1")?false:true,pic:(C=="1")?true:false,map:(B=="1")?true:false,txttiptype:(D=="1")?true:false,maxLength:(D=="1")?200:19999},function(){baidu.addClass(editor.btnsubmit,"submit-reply");this.btnsubmit.innerHTML="<span><b>提交回答</b></span>";if(ik.qb.data.get("user","isLogin")=="1"){var E=baidu.dom.create("span",{className:"unname"});E.innerHTML='<input type="checkbox" id="unname-reply" name="md" />匿名回答';baidu.dom.insertBefore(E,this.btnsubmit)}});ik.qb.vertical.init()},check:function(B){baidu.object.extend(A,B);baidu.object.extend(A,{title:ik.qb.data.get("extra","ti"),answerfr:ik.qb.data.get("extra","referKey")});ik.qb.answer.formInstance=A;login.check(ik.qb.answer.doSubmit,function(){pop.show("我要回答",{url:"/html/useranswer.html?t="+(new Date().getTime()),width:600,height:300})})},doSubmit:function(){var C=function(){var F=ik.qb.vertical;if(F.hastn&&F.isInit&&F.getTplJsonData){var E=F.getCidCfg().q.tn;F.logObj.v_qb_tpl_used=(F.tplStr?(E+"_used"):(E+"_not_used"));log.send(location.href,ik.qb.logKey,F.logObj);var H="cid="+ik.qb.data.get("page","cid")+"&qid="+ik.qb.data.get("page","qid")+"&tn="+E+"&type=100009&co="+encodeURIComponent(A.co)+"&json_data="+encodeURIComponent(F.getTplJsonData());baidu.ajax.request("/qrhelper/save",{method:"POST",sync:true,data:H})}};if(ik.qb.answer.formInstance){var B=["tn=ikqb","qid="+ik.qb.data.get("page","qid"),"user="+ik.qb.data.get("user","userName"),"referrer="+escape(document.referrer)];log.stat(B.join("&"));var D=new ik.submit(ik.qb.answer.formInstance,null,true);D.action(true,C)}}}})();ik.submit.iframeCallback=function(I,K,E,B,D,L,N,C,J,H){var M={ct:22,tn:"ikmiddlepage",pn:0,qid:E,cid:B,c:D,cm:I,no:(function(){var O;if(K==100400){O=100009}else{if(K==100401){O=100010}else{O=K}}return O})(),ck:L,ig:N,egg:C,eno:J,etp:H,answerfr:ik.qb.data.get("extra","referKey")};var F=new ik.submit(M);var A=F.getForm();A.action="/q?fr=post&pv=rem";F.action()};ik.qb.share=(function(C){var B=[{id:"share-itieba",action:function(D){log.send(location.href,ik.qb.logKey,{order:D.order,test:D.logtag,qstatus:D.qstatus,area:"share",action:"itieba",title:encodeURI(D.logtitle)});var E=["http://tieba.baidu.com/i/sys/share?link="+encodeURIComponent(D.link),"type=text","title="+encodeURIComponent(baidu.string.subByte(D.title,52)),"content="+encodeURIComponent(baidu.string.subByte(D.content,228))];D.tag.href=E.join("&")}},{id:"share-sina",action:function(D){log.send(location.href,ik.qb.logKey,{order:D.order,test:D.logtag,qstatus:D.qstatus,area:"share",action:"sina",title:encodeURI(D.logtitle)});var E=["http://v.t.sina.com.cn/share/share.php?appkey=312479806","url="+encodeURIComponent(D.link),"title="+encodeURIComponent(D.title),"content="+encodeURIComponent("gb2312"),"ralateUid=1647299133","pic="];D.tag.href=E.join("&")}},{id:"share-qqzone",action:function(D){var E="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url="+encodeURIComponent(D.link);log.send(location.href,ik.qb.logKey,{order:D.order,test:D.logtag,qstatus:D.qstatus,area:"share",action:"qqzone",title:encodeURI(D.logtitle)});D.tag.href=E}},{id:"share-renren",action:function(D){var E="http://share.renren.com/share/buttonshare.do?link="+encodeURIComponent(D.link);log.send(location.href,ik.qb.logKey,{order:D.order,test:D.logtag,qstatus:D.qstatus,area:"share",action:"renren",title:encodeURI(D.logtitle)});D.tag.href=E}},{id:"share-msn",action:function(D){var E="http://profile.live.com/badge?url="+encodeURIComponent(D.link)+"&title="+encodeURIComponent(D.title)+encodeURIComponent(D.suffix);log.send(location.href,ik.qb.logKey,{order:D.order,test:D.logtag,qstatus:D.qstatus,area:"share",action:"msn",title:encodeURI(D.logtitle)});D.tag.href=E}},{id:"share-qqwb",action:function(D){var E="http://v.t.qq.com/share/share.php?url="+encodeURIComponent(D.link)+encodeURIComponent(D.suffix)+"&appkey=4889d932e5e04299a774282957f4ff9f&site=http://zhidao.baidu.com&pic=&title="+encodeURIComponent(D.title);log.send(location.href,ik.qb.logKey,{order:D.order,test:D.logtag,qstatus:D.qstatus,area:"share",action:"qqwb",title:encodeURI(D.logtitle)});D.tag.href=E}},{id:"share-douban",action:function(D){var E="http://www.douban.com/recommend/?url="+encodeURIComponent(D.link)+"&title="+encodeURIComponent(D.title)+encodeURIComponent(D.suffix);log.send(location.href,ik.qb.logKey,{order:D.order,test:D.logtag,qstatus:D.qstatus,area:"share",action:"douban",title:encodeURI(D.logtitle)});D.tag.href=E}}];function A(){var F=baidu.dom.query("#question-title .question-title")[0].innerHTML;var E=baidu.g("question-content").innerHTML;if(ik.qb.data.get("page","status")=="finish"&&baidu.g("best-answer-content")){E="[最佳答案]"+baidu.g("best-answer-content").innerHTML}var D="http://"+location.host+location.pathname;return{title:F,content:E,link:D}}return{init:function(){baidu.each(B,function(H,E){var D=baidu.dom.query("."+H.id+"-e");var F=ik.qb.data.get("page","status");if(D.length){baidu.each(D,function(I){baidu.on(I,"click",function(){var K=A(),J={tag:this,qstatus:F,logtag:baidu.dom.getAttr(I,"rel"),order:baidu.dom.getAttr(I,"data"),logtitle:K.title,link:K.link+"?frm=snsrefer",content:K.content,title:(F=="being")?" #你知道么# 有个问题我很想知道答案，谁能帮帮我："+K.title:" #你知道么#  刚刚看到一个不错的问题："+K.title,suffix:(F=="being")?" （分享自 @百度知道）":" 快来看看吧 （来自 @百度知道）"};H.action(J);if(baidu.g("layer-share")){baidu.hide("layer-share")}})})}});if(baidu.g("ask-to-team")){baidu.on("ask-to-team","click",function(D){log.send(location.href,ik.qb.logKey,{area:"share",action:"team"});pop.show("向团队求助",{url:"/html/qbasktoteam.html",width:408,height:270});baidu.event.preventDefault(D)})}}}})();ik.qb.image=(function(){var host="http://pp.zhidao.baidu.com/g?";var bImg={url:"http://hiphotos.baidu.com/zhidao/pic/item/",width:600,height:600};var sImg={url:"http://hiphotos.baidu.com/zhidao/abpic/item/",width:120,height:120};function getImgID(list){if(list.length==0){return false}var params=["ct=16","cm=6","tn=ikqbimagedatajson","co="+list.join("_"),"nu="+ik.qb.data.get("page","imgCount"),"bl="+baidu.string.getByteLength(list.join("_")),"callback=ik.qb.image.show","t="+(new Date().getTime())];baidu.sio.callByBrowser(host+params.join("&"))}function savePid(ele,pid){var qbox=baidu.dom.getAncestorByClass(ele,"qbox");if(qbox){var ipts=baidu.dom.query("#"+qbox.id+" .question-data input");baidu.each(ipts,function(ipt,key){if(ipt.name=="pid"){ipt.value=pid;return }})}var cns=["entry","best-answer-panel","recommend-answer-panel"];baidu.each(cns,function(item,key){var replyBox=baidu.dom.getAncestorByClass(ele,item);if(replyBox){var ipts=baidu.dom.query("#"+replyBox.id+" .reply-data input");baidu.each(ipts,function(ipt,key){if(ipt.name=="pid"){ipt.value=pid;return }})}})}return{init:function(){if(ik.qb.data.get("page","imgCount")!="0"){var list=[];var imgHolders=baidu.q("img-holder");if(imgHolders.length>0){baidu.each(imgHolders,function(item,key){var a=item.getElementsByTagName("a")[0];var pattern=/image-([0-9]+_[0-9]+)/;if(pattern.test(a.id)){list.push(a.id.match(pattern)[1])}});getImgID(list)}}},show:function(data){var obj=eval("("+data+")");if(obj&&obj.length>0){for(var i=0;i<obj.length;i++){var ele=baidu.g("image-"+obj[i]["qid"]+"_"+obj[i]["aid"]);if(ele&&obj[i]["status"]&&obj[i]["pidenc"]){savePid(ele,obj[i]["pidenc"]);ele.title="点击查看大图";var img=baidu.dom.create("img",{src:bImg.url+obj[i]["pidenc"]+".jpg"});ele.appendChild(img);img.onload=function(){this.parentNode.parentNode.style.width=this.width+"px";setTimeout(function(){img.parentNode.parentNode.style.width=img.width+"px"},300)};img.src=sImg.url+obj[i]["pidenc"]+".jpg?t="+(new Date()).getTime();baidu.show(ele.parentNode);baidu.on(ele,"click",function(ev){var container=baidu.g("origin-image");if(container){baidu.dom.remove(container)}var src=this.getElementsByTagName("img")[0]["src"].replace(/abpic/,"pic");pop.alert("查看大图",{info:'<div style="text-align:center;" id="origin-image"></div>',width:400,height:400,onopen:function(){var oImg=baidu.dom.create("img");var container=baidu.g("origin-image");container.appendChild(oImg);oImg.onload=function(){var nw=(this.width<=300)?300:this.width;var nh=(this.height<=200)?200:this.height;if(nw>500){nh=(this.height/this.width)*500;nw=500;this.style.width=nw+"px";this.style.height=nh+"px"}container.style.width=nw+"px";container.style.height=nh+"px";pop.resize(nw,nh+10)};oImg.src=src+"&t="+(new Date().getTime())}});baidu.event.preventDefault(ev)})}else{var officialAdminBtn=baidu.dom.next(ele.parentNode);if(officialAdminBtn&&baidu.dom.hasClass(officialAdminBtn,"offical-admin")){baidu.hide(officialAdminBtn)}}}}},adminDel:function(aid){var qid=ik.qb.data.get("page","qid");var i=new Image();i.onload=i.onerror=function(){window.location.reload()};i.src=host+"ct=16&cm=4&qid="+qid+"&aid="+aid}}})();ik.qb.replyAsk={viewBigImage:function(){var A=baidu.dom.query(".replyask-img-e");var B=baidu.dom.create("div",{id:"replyask-temp-images-wrap",stlye:"display : none"});if(A.length!=0){baidu.each(A,function(C){baidu.on(C,"click",function(E){var D=new Image();D.src=baidu.dom.getAttr(this,"href")+"&t="+(new Date().getTime());D.onload=function(){var F=(D.width<=300)?300:D.width;var H=(D.height<=200)?200:D.height;if(F>500){H=(D.height/D.width)*500;F=500;D.style.width=F+"px";D.style.height=H+"px"}pop.alert("查看大图",{info:D,width:F,height:H})};baidu.event.preventDefault(E)})})}},deleteReplyAsk:function(){var A=baidu.dom.query(".del-replyask-e");baidu.each(A,function(B){baidu.on(B,"click",function(D){baidu.event.preventDefault(D);var C=baidu.dom.getAttr(B,"href");var E=C.match(/[0-9]+/gi).reverse()[2].substr(2);baidu.ajax.get(C,function(H,F){if(H.status==200){baidu.fx.collapse("replyask-"+E,{duration:500})}})})})}};ik.qb.visitedTimes=function(A){if(A!=0){var B='<span class="visited-times">浏览次数：'+A+"次</span>";baidu.dom.insertHTML(baidu.dom.query(".question .details")[0],"afterBegin",B)}};ik.qb.openIknow=function(){var A=baidu.dom.query(".open-username-e"),C=0,B="http://bae.open.zhidao.baidu.com/expert/index.php?",D=function(){if(A.length!=0){var F=A[C],E=B+baidu.dom.getAttr(F,"info");baidu.sio.callByBrowser(E,function(){if("undefined"!=typeof expert_info){var I=expert_info.expert_info;if(I.expert_name&&I.expert_url){F.innerHTML='- <a href="'+I.expert_url+'" target="_blank" onclick="log.send(location.href, ik.qb.logKey, {area : \'openiknow\', pos : \'openusername\'})">'+I.expert_name+" </a>"}if(C<A.length-1){var H=setTimeout(D,100);C+=1}else{clearTimeout(H)}}})}};D()};ik.qb.push=(function(){var B=0;var A=0;return{show:function(H){if(!H){return }var D=ik.qb.data.get("page","status");if(D=="being"||D=="voting"){return }if(H.pushQuestion.length>0){log.global.add("push_question","1");log.global.add("push_type",H.pushQuestion[0].questionType);if(H.pushQuestion[0].questionType=="core"){cookie.set("CPLN",H.pushListNum,"","/",location.host.replace(/:\d+/,""));cookie.set("CPOFF",H.pushOffset,"","/",location.host.replace(/:\d+/,""))}if(B==1){if(H.pushListNum<=8){pop.show("知道提示",{info:'<div class="push-nochange"><p>不能再换一批喽:(</p><p>推荐给您的问题就剩这么多了</p><p class="push-nochange-gray">请继续答题或者稍等查看我们为您推荐的新问题:)</p></div>',width:400,height:200})}}var C="";if(!B&&!A){var I='<span class="icon i-waitinganswer"><strong class="push-panel-title">等待您来回答</strong></span>';C+='<ul id="push-ul">'}for(var F=0;F<H.pushQuestion.length-1;F++){C+='<li class="cle">';if((H.pushListNum>0)&&(H.pushQuestion[0].questionType=="core")){C+='<span title="不再推荐" onclick="log.send(location.href,ik.qb.logKey,log.parse(\'push.delete.click\'));ik.qb.push.del('+H.pushQuestion[F].qid+')" class="push-del" id="'+H.pushQuestion[F].qid+'">del</span>'}C+='<span class="push-ans-num">'+H.pushQuestion[F].answerNum+"回答</span>";if(H.pushQuestion[F].score>0){C+='<span class="push-score">'+H.pushQuestion[F].score+"</span>"}if((H.pushQuestion[0].questionType=="core")||(H.pushQuestion[0].questionType=="reduce")){C+='<a log="push.title.click" class="push-ans-title" href="/question/'+H.pushQuestion[F].qid+".html?push="+H.pushQuestion[F].questionType+"&group="+H.pushQuestion[F].expGroup+'" target="_blank" title="'+H.pushQuestion[F].questionTitFull+'">'+H.pushQuestion[F].questionTitle+"</a>"}else{C+='<a log="push.title.click" class="push-ans-title" href="/question/'+H.pushQuestion[F].qid+".html?push="+H.pushQuestion[F].questionType+'" target="_blank" title="'+H.pushQuestion[F].questionTitFull+'">'+H.pushQuestion[F].questionTitle+"</a>"}if(H.pushQuestion[F].cellphone==1){C+='<span class="push-ans-cell" title="手机知道">cell</span>'}C+="</li>"}if(!B&&!A){C+="</ul>";C+='<div class="push-more"><a href="'+H.moreUrl+'" target="_blank">更多等待您来回答的问题&gt;&gt;</a></div>'}if(!B&&!A){if((H.pushListNum>0)&&(H.pushQuestion[0].questionType=="core")){C+='<div class="push-change mt10" id="push-change-div"><span>没有感兴趣的问题？试试</span><span id="push-change" onclick="log.send(location.href,ik.qb.logKey,log.parse(\'push.change.click\'));ik.qb.push.change();">换一批</span></div>'}C+='<div style="clear:both;zoom:1;font-size:0px;line-height:0px;"></div>';if(baidu.g("push-panel")){baidu.g("push-panel").innerHTML='<div class="header">'+I+'</div><div class="body">'+C+"</div>";baidu.show("push-panel")}}else{C+='<div style="clear:both;zoom:1;font-size:0px;line-height:0px;"></div>';baidu.g("push-ul").innerHTML=C}if((H.pushListNum>0)&&(H.pushQuestion[0].questionType=="core")){var E=setInterval(function(){if(baidu.g("push-ul")){for(var J=0;J<baidu.g("push-ul").getElementsByTagName("li").length;J++){baidu.on(baidu.g("push-ul").getElementsByTagName("li")[J],"mouseover",function(){this.getElementsByTagName("span")[0].style.visibility="visible";baidu.on(this.getElementsByTagName("span")[0],"mouseover",function(){this.style.backgroundPosition="0 -932px"});baidu.on(this.getElementsByTagName("span")[0],"mouseout",function(){this.style.backgroundPosition="0 -902px"})});baidu.on(baidu.g("push-ul").getElementsByTagName("li")[J],"mouseout",function(){this.getElementsByTagName("span")[0].style.visibility="hidden"})}clearInterval(E)}},200)}}else{if(A==1){baidu.g("push-ul").innerHTML='<p class="push-del-all">推荐给您的问题已经删完了！请继续答题或者稍等查看我们为您推荐的新问题：）<a href="http://zhidao.baidu.com/browse/?lm=2&fr=nw" target="_blank"><strong>现在就去回答>></strong></a></p>';baidu.g("push-change-div").innerHTML=""}}},del:function(D){A=1;B=0;clearTimeout(C);baidu.ajax.post("/q","ct=22&cm=100580&qid="+D+"&tn=ikframesubmit");var C=setTimeout(function(){baidu.sio.callByServer("/q?ct=15&cm=2&tn=ikqb_push&qid="+ik.qb.data.get("page","qid")+"&t="+(new Date()).getTime(),"ik.qb.push.show")},500)},change:function(){B=1;A=0;clearTimeout(C);var C=setTimeout(function(){baidu.sio.callByServer("/q?ct=15&cm=3&tn=ikqb_push&t="+(new Date()).getTime(),"ik.qb.push.show")},10)}}})();ik.qb.value=(function(){function showMsg(type){var msg={tip:"对我有帮助",success:"评价成功！",fail:"您已评价！"};var btn=baidu.g("btn-value");var tip=btn.getElementsByTagName("div")[0];tip.innerHTML=msg[type];setTimeout(function(){showMsg("tip")},3000)}baidu.dom.ready(function(){var btn=baidu.g("btn-value");if(btn){var tip=baidu.dom.first(btn);var num=baidu.dom.last(btn);var share=baidu.g("layer-share");var timer0=null;var toggleShareBox=function(hide){hide=hide||false;if(hide){if(share.canHide){baidu.hide(share);share.canHide=false}}else{baidu.fx.expand("layer-share",{duration:300});share.canHide=false}};baidu.on(btn,"mouseover",function(ev){baidu.hide(num);baidu.show(tip);baidu.dom.addClass(btn,"value-block-hover");share.canHide=false;window.clearTimeout(timer0)});baidu.on(btn,"mouseout",function(ev){baidu.hide(tip);baidu.show(num);baidu.dom.removeClass(btn,"value-block-hover");share.canHide=true;window.clearTimeout(timer0);timer0=window.setTimeout(function(){toggleShareBox(true)},600)});baidu.on(btn,"click",function(argument){log.send(location.href,ik.qb.logKey,{area:"bestanswer",pos:"pingjia",action:"btnclick"});var me=this;if(me.clicked){showMsg("fail");toggleShareBox();return false}var params=["ct=19","tn=ikasyndatajson","cm=100003","at=10002","qid="+ik.qb.data.get("page","qid"),"bid="+ik.qb.fn.getReplyInfo(btn)["userId"],"bun="+ik.qb.fn.getReplyInfo(btn)["userName"],"t="+(new Date().getTime())];baidu.ajax.post("/q?ct=19&tn=ikasyndatajson",params.join("&"),function(xhr,responseText){if(!!eval(responseText)){showMsg("success");var num=btn.getElementsByTagName("div")[1];num.innerHTML=parseInt(num.innerHTML)+1}else{showMsg("fail")}toggleShareBox();me.clicked=true;setTimeout(function(){me.clicked=false},10000)})});baidu.on("layer-share","mouseout",function(E){var evtArg=baidu.event.get(E);if(evtArg.target.id=="layer-share"){window.clearTimeout(timer0);timer0=window.setTimeout(function(){toggleShareBox(true)},600)}});baidu.on("layer-share","mouseover",function(E){window.clearTimeout(timer0)});baidu.on("layer-share-inner","mouseout",function(E){baidu.event.stopPropagation(E)});baidu.on("share-arrow","mouseover",function(E){baidu.event.stopPropagation(E)});baidu.on("layer-share-inner","mouseover",function(E){share.canHide=true})}})})();ik.qb.extra={qPush:function(B){if(ik.qb.data.get("user","isLogin")==1){var A="?qpush";var D=cookie.get("QB_UID");if(D&&D==ik.qb.data.get("user","userUid")){return }var C=cookie.get("BAIDUID").replace(":FG=1","");baidu.sio.callByBrowser("/qforward/user_insert.php?baiduid="+C+"&uid="+ik.qb.data.get("user","userUid"),function(){cookie.set("QB_UID",ik.qb.data.get("user","userUid"),new Date(new Date().getTime()+3600*1000*24))})}}};ik.qb.accuse=function(A,B){login.check(baidu.proxy(function(D,C){setTimeout(function(){pop.show("我来检举",{url:"http://mt.zhidao.baidu.com/onClick?typeid="+D+"&itemid="+C+"&t="+(new Date().getTime()),width:400,height:300})},300)},A,B))};ik.qb.taskEntrance=(function(){var A={ql:/browse(?:\/\d+(?:$|\?lm=2|\?[^lm])|$|\/$|\/\?lm=2)/i,ql_tab_hscore:/browse\/\d*\?lm\=4/,ql_tab_zero:/browse\/\d*\?lm\=8/,ql_tab_emergency:/browse\/\d*\?lm\=16/,uc_tab_class:/tn=ucpushlist\S+tab=2/,uc_tab_recommand:/tn=ucpushlist&cookie=\w+&um=\w+$/,uc_tab_keyword:/tn=uckeywordpushlist\S+tab=1/,zhuanti:/zhidao\.baidu\.com\/s\/([a-zA-Z0-9_\-]+)/,search:/&tn=ikaslist/i};return{init:function(){var F=this.getRefer();var E="",B;for(var D in A){B=F.match(A[D]);if(B){E=D;break}}if(E&&E=="zhuanti"){E=B[1]}var C=ik.qb.data.get("page","fromWap");var H=E+(parseInt(C)?";wap_question_replyed":"");ik.qb.data.add("extra","ti",H);ik.qb.data.add("extra","referKey",H)},getRefer:function(){return document.referrer}}})();ik.qb.log={userDetect:function(){var A="";A=(baidu.browser.ie)?"IE:"+baidu.browser.ie:"";A=(baidu.browser.firefox)?"FF:"+baidu.browser.firefox:A;A=(baidu.browser.chrome)?"CHROME:"+baidu.browser.chrome:A;A=(baidu.browser.maxthon)?"MAXTHON:"+baidu.browser.maxthon:A;A=(baidu.browser.opera)?"OPERA:"+baidu.browser.opera:A;A=(baidu.browser.safari)?"SAFARI:"+baidu.browser.safari:A;var B=0;B=(/微软雅黑/.test(baidu.getStyle("question-title","fontFamily")))?"1":"0";log.send(location.href,ik.qb.logKey,{area:"userDetect",browser:A,msyh:B,refer:encodeURIComponent(document.referrer)})},common:function(){if(ik.qb.data.get("page","status")=="finish"&&baidu.g("best-answer-panel")){var D=baidu.page.getViewHeight();var F=baidu.g("wrap").offsetHeight;var A=baidu.g("best-answer-panel").offsetHeight;function C(){var M=baidu.page.getScrollTop();var L=baidu.dom.getPosition("best-answer-panel")["top"];var K=L-M;var N=D-K;if((N*3)>=D&&(N-D<=A-200)){return true}else{return false}}function B(O){if(!baidu.g(O)){return }var M=baidu.page.getScrollTop();var L=baidu.dom.getPosition(O)["top"];var K=L-M;var N=D-K;if(N>=baidu.g(O).offsetHeight){return true}else{return false}}var J=null;var E=null;var I=0;var H=0;setInterval(function(){if(C()){if(J==null){J=(new Date()).getTime()}else{E=(new Date()).getTime()-J}}if(B("relative-panel")){I=1}if(B("push-panel")){H=1}},500);baidu.on(window,"beforeunload",function(L){var K=(new Date()).getTime()-ik.qb.time.pageStart;log.send(location.href,ik.qb.logKey,{pageStayTime:K,bestStayTime:E,domreadyTime:ik.qb.time.domready-ik.qb.time.pageStart,relatedAccess:I,pushAccess:H})})}},related:function(A){var B=baidu.g("relative-panel");if(B){baidu.each(B.getElementsByTagName("a"),function(D,C){baidu.on(D,"click",function(H){var F="other";if(/fr=qrl/.test(this.href)){F="q"}if(/word=/.test(this.href)){F="more"}if(/topic/.test(this.href)){F="topic"}var E=this.href.match(/index=(\d+)/);if(E){E=E[1]}else{E=0}log.send(this.href,11,{relate:"relate",index:E,pos:F,qid:ik.qb.data.get("page","qid"),cid:ik.qb.data.get("page","cid")})})})}},push:function(B){var A=baidu.g("push-panel");if(A){baidu.each(A.getElementsByTagName("a"),function(D,C){baidu.on(D,"click",function(E){if(baidu.dom.hasClass(this,"push-ans-title")){log.send(this.href,12,{cmd:"qb_push"})}})})}},init:function(){ik.qb.log.userDetect();ik.qb.log.common();ik.qb.log.related();ik.qb.log.push()}};ik.qb.vertical=(function(){var C=ik.qb.data.get("page","cid");if(C in ik.verticalCfg){var B=ik.verticalCfg[C];if(B.a.hastn){var A=B.q.tn;return{hastn:1,isInit:0,isRunning:0,init:function(){if(!window.editor||!window.editor.txtcontent){this.hastn=0;return }baidu.on(editor.txtcontent,"focus",function(D){if(ik.qb.vertical.isInit||ik.qb.vertical.isRunning){return }ik.qb.vertical.isRunning=1;ik.qb.vertical.getTpl()})},logObj:{},getTpl:function(){var E="/qrhelper/reply";var D=E+"?cid="+ik.qb.data.get("page","cid")+"&qid="+ik.qb.data.get("page","qid");baidu.sio.callByBrowser(D,function(){if(!self.vertical){ik.qb.vertical.hastn=0;ik.qb.vertical.isInit=1;ik.qb.vertical.isRunning=0;return }var I=baidu.dom.create("div",{id:"vertical_box",className:"box-gr mb20"});var H=baidu.dom.create("div",{className:"bar editor_bar"});H.innerHTML='<span class="icon i-otheranswer f12"> 该问题可以使用回答模板</span>';var F=baidu.dom.create("div",{id:"verticalBoxCon"});I.appendChild(H);I.appendChild(F);baidu.dom.insertBefore(I,editor.firstChild);if(ik.qb.vertical.tplInit("verticalBoxCon")){editor.title_wrap.style.backgroundPosition="0px -46px";baidu.fx.expand(I,{duration:300});ik.qb.vertical.getCidCfg=function(){return B};ik.qb.vertical.getTplStrData=function(){if(self.vertical[A].createContent){return self.vertical[A].createContent()}};ik.qb.vertical.getTplJsonData=function(){if(self.vertical[A].createJSON){return self.vertical[A].createJSON(true)}};ik.qb.vertical._beforeSubmit=editor.options.beforSubmit;ik.qb.vertical.tplStr="";editor.options.beforSubmit=function(){ik.qb.vertical.tplStr=ik.qb.vertical.getTplStrData();editor.options.allowNull=(baidu.string.trim(ik.qb.vertical.tplStr)==""?false:true);return ik.qb.vertical._beforeSubmit.call(editor)};ik.qb.vertical.isExpand=true;baidu.on(H,"click",function(L){var J=ik.qb.vertical.isExpand;var K=J?"collapse":"expand";var M=J?" 该问题可以使用回答模板（点击展开模板）":" 该问题可以使用回答模板";baidu.fx[K](F,{duration:300,onafterfinish:function(){baidu.setStyle(F,"height","auto");H.firstChild.innerHTML=M}});ik.qb.vertical.isExpand=!J});if(self.vertical[A]){self.vertical[A].onStatusChange=function(J){if(!J){baidu.fx.collapse(F,{duration:300,onafterfinish:function(){H.firstChild.innerHTML="该问题可以使用回答模板（点击展开模板）"}});ik.qb.vertical.isExpand=false}}}ik.qb.vertical.isInit=1;ik.qb.vertical.isRunning=0;ik.qb.vertical.logObj.v_qb_tpl_show=A+"tpl_show"}})},tplInit:function(E){if(self.vertical&&self.vertical[A]&&self.vertical[A].init){var D=self.vertical[A].init(E);return D?true:false}else{return false}}}}else{if(B.a.hasbar){return{hastn:0,init:function(){ik.qb.vertical.getBar()},getBar:function(){var D="/qrhelper/replytool";var E=D+"?cid="+ik.qb.data.get("page","cid")+"&qid="+ik.qb.data.get("page","qid");baidu.sio.callByServer(E,this.getBarCallBack)},getBarCallBack:function(D){if(!D||D.length<1){return }var J=D;var H=baidu.dom.create("div",{className:"verticalBar"});var I=['<div class="v-bar-tit">参考：</div><div class="v-bar-linkwrap">'];for(var F=0,E=J.length;F<E;F++){I.push((F!=0?(F%2?"&nbsp;&nbsp;":'<span class="v-bar-split">|</span>'):"")+'<span><a href="'+J[F].link+'" target="_blank" onclick="log.send(location.href,ik.qb.logKey,{\'v_qb_bar_click\':\''+(F%2?"search":"baike")+"'})\">"+J[F].title+"</a></span>")}I.push("</div>");H.innerHTML=I.join("");baidu.dom.insertBefore(H,editor.txtcontent.parentNode);if(baidu.browser.ie){baidu.setStyles(H.previousSibling,{height:"0",lineHeight:"0"})}log.send(location.href,ik.qb.logKey,{v_qb_bar_show:"bar_show"})}}}else{return{hastn:0,init:function(){}}}}}else{return{hastn:0,init:function(){}}}})();baidu.dom.ready(function(){log.global.add("page","ikqb");log.global.add("iknowstatus","ok");log.global.add("qcid",ik.qb.data.get("page","cid"));log.global.add("status",ik.qb.data.get("page","status"));log.global.add("login",ik.qb.data.get("user","isLogin"));log.init(ik.qb.logKey);ik.qb.log.init();ik.qb.time.domready=(new Date()).getTime();if(ik.qb.data.get("page","referQuery")!=""){document["top-search-form"].word.value=baidu.string.decodeHTML(ik.qb.data.get("page","referQuery"))}baidu.g("kw").focus();if(G("usrbar-login")){baidu.on("usrbar-login","click",function(){log.send(location.href,ik.qb.logKey,{qb_login_click:"click"})})}ik.qb.fn.parseData();ik.qb.image.init();ik.qb.replyAsk.viewBigImage();ik.qb.taskEntrance.init();ik.qb.taskEntrance.init();ik.qb.share.init();if((ik.qb.data.get("q","isAskerLogin")==1&&/being|overdue/.test(ik.qb.data.get("page","status")))||/from=emailmsg/.test(location.search)){baidu.sio.callByBrowser("http://iknow.bdimg.com/qb/asker.js",function(B){ik.qb.asker.init()})}if(ik.qb.data.get("page","status")=="voting"){baidu.sio.callByBrowser("http://iknow.bdimg.com/qb/vote.js")}if(ik.qb.data.get("user","isOfficalAdmin")=="1"){baidu.sio.callByBrowser("http://iknow.bdimg.com/qb/officialAdmin.js",function(B){ik.qb.officialAdmin.init()});ik.qb.replyAsk.deleteReplyAsk()}if(ik.qb.data.get("user","isUserAdmin")=="1"){baidu.sio.callByBrowser("http://iknow.bdimg.com/qb/userAdmin.js",function(B){ik.qb.userAdmin.init()})}if(ik.qb.data.get("q","isReplyerLogin")=="1"){baidu.sio.callByBrowser("http://iknow.bdimg.com/qb/replyer.js")}if(ik.qb.data.get("user","userType")==1&&ik.qb.data.get("user","isLogin")==0){baidu.sio.callByBrowser("http://iknow.bdimg.com/qb/guide.js",function(){ik.qb.guide.init()})}if(ik.qb.data.get("extra","taskid")==1004){baidu.sio.callByBrowser("http://iknow.bdimg.com/qb/task/task.js",function(){ik.qb.task.fish()})}IknowEgg.init();if(ik.qb.data.get("user","isLogin")==1){baidu.sio.callByBrowser("http://iknow.bdimg.com/qb/task/task_guide.js")}ik.qb.extra.qPush();var A=window.location.hash;if(A!=""){window.location.hash=A}if(baidu.dom.query(".replyask-box")){baidu.sio.callByBrowser("http://iknow.bdimg.com/qb/autoHide.js")}ik.qb.openIknow();baidu.sio.callByBrowser("http://cp.zhidao.baidu.com/v.php?q="+ik.qb.data.get("page","qid")+"&callback=ik.qb.visitedTimes")});baidu.dom.ready(function(){if(ik.qb.data.get("page","isLinger")=="1"){baidu.sio.callByBrowser("http://exp.zhidao.baidu.com?qid="+ik.qb.data.get("page","qid"),"linger")}});function linger(E){var D=[];if(E.result=="ok"){if(E.position=="1"){baidu.dom.insertHTML(baidu.dom.children("question-box")[1],"afterBegin",'<div id="linger-tag1"><div>');for(var C=0;C<E.content.length;C++){D.push('<a class="tag1-bg1" href="'+E.content[C].tagurl+'" target="_blank">');D.push('<span class="tag1-bg2">');D.push('<span class="tag1-bg3">'+E.content[C].tags+"</span>");D.push("</span>");D.push("</a>")}G("linger-tag1").innerHTML=D.join("")}if(E.position=="2"){baidu.dom.insertHTML(baidu.dom.children("question-box")[1],"afterEnd",'<div id="linger-tag2"><div>');D.push('<span class="tag2-span">相关主题：</span>');for(var C=0;C<E.content.length;C++){if(C==E.content.length-1){D.push('<span class="tag2-bg tag2-bg-last">')}else{D.push('<span class="tag2-bg">')}D.push('<a class="tag2-a" href="'+E.content[C].tagurl+'" target="_blank">'+E.content[C].tags+"</a>");D.push("</span>")}G("linger-tag2").innerHTML=D.join("")}if(E.position=="3"){D.push('<div class="header">');D.push('<span class="icon i-relatedanswer"><strong class="relative-panel-title">相关内容</strong></span>');D.push("</div>");D.push('<div class="body">');D.push('<div id="linger-tag3">');for(var C=0;C<E.content.length;C++){if(C!=0){D.push('<a class="tag3-a" id="tag3-a'+C+'" href="'+E.content[C].tagurl+'" target="_blank" onmouseover="showTagList('+C+');">'+E.content[C].tags+"</a>")}else{D.push('<a class="tag3-a tag3-a-hover" id="tag3-a'+C+'" href="'+E.content[C].tagurl+'" target="_blank" onmouseover="showTagList('+C+');">'+E.content[C].tags+"</a>")}}D.push("</div>");for(var C=0;C<E.content.length;C++){if(E.content[C].tagcontent!=null){if(C!=0){D.push('<ul class="mb10 tag3-ul" style="display:none;" id="tag3-ul'+C+'">')}else{D.push('<ul class="mb10 tag3-ul" id="tag3-ul'+C+'">')}for(var B=0;B<E.content[C].tagcontent.length;B++){D.push("<li>");D.push('<span class="details">'+E.content[C].tagcontent[B].date+"</span>");D.push('<a log="relative.title.click" title="'+E.content[C].tagcontent[B].title+'" href="'+E.content[C].tagcontent[B].titleurl+'" target="_blank">'+subTagTitle(E.content[C].tagcontent[B].title,68)+"</a>");D.push("</li>")}D.push("</ul>")}}D.push("</div>");G("relative-panel").innerHTML=D.join("")}if((E.position=="4")&&(G("best-answer-content"))){var A=baidu.dom.children("question-title")[1].innerHTML;baidu.dom.insertHTML("best-answer-content","beforeBegin",'<div id="linger-tag4"><div>');baidu.dom.insertHTML("best-answer-content","afterEnd",'<div><a href="http://zhidao.baidu.com/q?word='+encodeURIComponent(A)+'&ct=17&pn=0&tn=ikaslist&rn=10&lm=0&fr=llwf" target="_blank">更多最佳答案>></a></div>');D.push("<span>对于婴儿奶粉的知识，推荐给你几个链接：</span>");for(var C=0;C<E.content.length;C++){D.push("<span>");if(C==E.content.length-1){D.push('<a href="'+E.content[C].tagurl+'" target="_blank">'+E.content[C].tags+"</a>")}else{D.push('<a href="'+E.content[C].tagurl+'" target="_blank">'+E.content[C].tags+"</a>、")}D.push("</span>")}D.push("<span>，肯定对你有帮助。</span>");G("linger-tag4").innerHTML=D.join("")}if((E.position=="5")&&(G("best-answer-content"))){var A=baidu.dom.children("question-title")[1].innerHTML;baidu.dom.insertHTML("best-answer-content","afterEnd",'<div><a href="http://zhidao.baidu.com/q?word='+encodeURIComponent(A)+'&ct=17&pn=0&tn=ikaslist&rn=10&lm=0&fr=llwf" target="_blank">更多最佳答案>></a></div>')}if((E.position=="6")&&(G("best-answer-content"))){var A=baidu.dom.children("question-title")[1].innerHTML;var D=[];D.push('<div class="linger-tag6"><input id="tag6-input" class="tag6-input" value="'+A+'" maxlength="256" size="46" autocomplete="off" />');D.push('<input id="tag6-btn" type="button" value="搜索更多答案" class="tag6-btn" /></div>');baidu.dom.insertHTML("best-answer-panel","beforeEnd",D.join(""));baidu.on("tag6-input","keyup",function(F){if(baidu.event.getKeyCode(F)==13){baidu.g("tag6-btn").click()}});baidu.on("tag6-btn","click",function(){var F=baidu.trim(baidu.g("tag6-input").value);if(F!=""){baidu.g("kw").value=F;baidu.g("top-search-btn").click()}else{baidu.g("tag6-input").focus()}})}}}function showTagList(A){if(G("tag3-ul"+A)){G("tag3-ul"+A).style.display="block";baidu.addClass("tag3-a"+A,"tag3-a-hover");for(var B=0;B<baidu.q("tag3-ul").length;B++){if(B!=A){G("tag3-ul"+B).style.display="none";baidu.removeClass("tag3-a"+B,"tag3-a-hover")}}}}function subTagTitle(C,B){var D=/[^\x00-\xff]/g;if(C.replace(D,"ff").length<B){return C}B=B-3;for(var A=0;A<C.length;A++){if(C.substr(0,A).replace(D,"ff").length>B){return C.substr(0,A)+"..."}}return C};