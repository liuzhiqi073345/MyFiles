<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0054)http://www.nowamagic.net/php/php_PhpDesignPatterns.php -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>PHP一些常用的设计模式介绍 -- 简明现代魔法</title> 
<meta name="copyright" content="PHP一些常用的设计模式介绍"> 
<meta name="keywords" content="PHP一些常用的设计模式介绍"> 
<meta name="description" content="PHP一些常用的设计模式介绍"> 
<link rel="shortcut icon" href="http://www.nowamagic.net/images/icon.gif">
<link href="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/style4.css" rel="stylesheet" type="text/css">
</head>

<body><script src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/jiathis.php" charset="utf-8"></script><link href="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/jiathis_share.css" rel="stylesheet" type="text/css"><iframe style="position: absolute; display: none; opacity: 0; " frameborder="0"></iframe><div class="jiathis_style" style="position: absolute; z-index: 1000000000; display: none; top: 50%; left: 50%; overflow: auto; "></div><div class="jiathis_style" style="position: absolute; z-index: 1000000000; display: none; overflow: auto; "></div><iframe style="display: none; " frameborder="0" src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/jiathis_utility.htm"></iframe>

<div class="background" id="background">

  	<div class="top" id="top">  </div>
  	<div class="header" id="header"> <table width="958" border="0" align="center">
  <tbody><tr>
    <td width="220"><img src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/logo.gif" width="210" height="230"></td>
    <td width="520" rowspan="2">
    <object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" id="scriptmain" name="scriptmain" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,29,0" width="515" height="270">
    <param name="movie" value="banner_english.swf?bcastr_xml_url=../xml/bcastr2.xml">
    <param name="quality" value="high">
    <param name="scale" value="noscale">
    <param name="LOOP" value="false">
    <param name="menu" value="false">
    <param name="wmode" value="transparent">
    <embed src="banner_english.swf?bcastr_xml_url=../xml/bcastr2.xml" width="515" height="270" loop="false" quality="high" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" salign="T" name="scriptmain" menu="false" wmode="transparent">
  </object>    </td>
    <td width="220" rowspan="2" style=" background-image:url(../images/headerbg.jpg)" valign="top">
<div class="headerword"><a href="http://www.nowamagic.net/index.php"><img border="none" src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/headerword.jpg" width="135" height="150"></a></div></td>
  </tr>
  <tr>
    <td align="center">专注于互联网主流的各种技术</td>
  </tr>
  <tr>
    <td height="5" colspan="3" bgcolor="#66CC00"></td>
  </tr>
</tbody></table>

<style type="text/css">
.tbtns{width:143px; height:39px; background:url(../images/tbtn.gif) no-repeat; display:block; margin:0 auto; font:700 14px/34px Verdana, Geneva, sans-serif!important;color:#FFF!important; margin-top:6px}
.t-b{background-position:0 -78px}
.t-r{background-position:0 0}
.t-g{background-position:0 -39px}
</style>

  <div class="leftfower">
<object height="285" width="95" border="0"><param value="../images/swf/flower.swf" name="movie"><param value="High" name="quality"><param value="ExactFit" name="scale"> <param value="transparent" name="wmode">
<embed height="285" width="95" scale="ExactFit" wmode="transparent" quality="High" name="FlashH" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" src="../images/swf/flower.swf">

</object></div>

  <div class="rightfower"><object height="285" width="80" border="0"><param value="../images/swf/right.swf" name="movie"><param value="High" name="quality"><param value="ExactFit" name="scale"> <param value="transparent" name="wmode"><embed height="285" width="80" scale="ExactFit" wmode="transparent" quality="High" name="FlashH" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" src="../images/swf/right.swf"></object></div> </div>
  	<div class="navigation" id="navigation"> <!-- navigation START -->
<div id="navigationMenu"> 
	<ul id="menus"> 
		<li class="current_page_item"><a class="home" title="首页" href="http://www.nowamagic.net/">首页</a></li> 
		<li><a href="http://www.nowamagic.net/" title="简明现代魔法"><span id="licontent">简明现代魔法</span></a></li> 
		<li><a href="http://www.nowamagic.net/admin/article_ArticleQuery.php" title="资料文献总汇"><span id="licontent">资料文献总汇</span></a></li> 
		<li><a href="http://www.nowamagic.net/librarys/veda/" title="Veda 原型" target="_blank"><span id="licontent">Veda 原型</span></a></li>
        <li><a href="http://www.nowamagic.net/librarys/news/" title="互联网资讯"><span id="licontent">互联网资讯</span></a></li> 
		<li><a href="http://www.nowamagic.net/librarys/" title="图书馆"><span id="licontent">魔法图书馆</span></a></li>
		<li><a href="http://www.nowamagic.net/librarys/eight/" title="晚八点"><span id="licontent">晚上八点</span></a></li>
        <!-- <li><a href="../space.php" title="社区～魔法"><span id="licontent">社区～魔法</span></a></li> -->
		<li><a class="lastmenu" href="javascript:void(0);"></a></li> 
	</ul> 
</div> 

<style>
.topads { border:2px solid #e6e6fa; margin-top:3px; overflow:hidden; }
.topads:hover { border:2px solid #b0e0e6; margin-top:3px; }
</style>
<!-- navigation END --> 
<div class="topads">
<script type="text/javascript"><!--
google_ad_client = "pub-3908995730077629";
/* 728x90, 创建于 10-6-25 */
google_ad_slot = "0450659969";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div> </div>
  	<div class="search" id="search"> 	<div id="searchbox"> 
		<form method="post" action="http://www.nowamagic.net/admin/article_SearchResult.php" name="search">
		<div class="content"> 
			<input type="text" class="textfield" name="search" size="24" value=""> 
            <input type="submit" class="button" value=""> 
		</div> 
		</form> 
	</div> 
    
<style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-bottom" style="background-color:#FFFFFF;color:#000000">
  <div class="cse-branding-form">
    <form action="http://www.google.com.hk/cse" id="cse-search-box" target="_blank">
      <div>
        <input type="hidden" name="cx" value="partner-pub-3908995730077629:6018213656">
        <input type="hidden" name="ie" value="UTF-8">
        <input type="text" name="q" size="22" class="inputstyle">
      </div>
	    <input type="submit" name="sa" value=" 搜索 ">
	  <div>
	  </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/poweredby_FFFFFF.gif" alt="Google">
  </div>
  <div class="cse-branding-text">
    自定义搜索
  </div>
</div>

<script type="text/javascript" src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/query_renderer.js"></script>
<div id="queries"></div>
<script src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/js"></script>


 </div>

  	<div class="mainContent" id="mainContent"> 
  		<div class="gen3_nav"><a href="http://www.nowamagic.net/index.php">简明现代魔法</a> -&gt; <a href="http://www.nowamagic.net/php/php.php">PHP服务器脚本</a> -&gt; PHP一些常用的设计模式介绍</div>
  
  	<h1 align="center">PHP一些常用的设计模式介绍</h1>
  	<p align="center">2011-03-23</p>
  
  	<div class="gen3">
  
  	<p>设计模式一书将设计模式引入软件社区，该书的作者是 Erich Gamma、Richard Helm、Ralph Johnson 和 John Vlissides Design（俗称 "四人帮"）。所介绍的设计模式背后的核心概念非常简单。经过多年的软件开发实践，Gamma 等人发现了某些具有固定设计的模式，就像建筑师设计房子和建筑物一样，可以为浴室的位置或厨房的构造方式开发模板。使用这些模板或者说设计模式意味着可以更快地设计更好的建筑物。同样的概念也适用于软件。</p>
  
  	<p>设计模式不仅代表着更快开发健壮软件的有用方法，而且还提供了以友好的术语封装大型理念的方法。例如，您可以说您正在编写一个提供松散耦合的消息传递系统，也可以说你正在编写名称为观察者的模式。</p>
    
    <p>用较小的示例展示模式的价值是非常困难的。这往往有些大材小用的意味，因为模式实际上是在大型代码库中发挥作用的。本文不展示大型应用程序，所以您需要思索的是在您自己的大型应用程序中应用示例原理的方法 —— 而不是本文演示的代码本身。这不是说您不应该在小应用程序中使用模式。很多良好的应用程序都以小应用程序为起点，逐渐发展到大型应用程序，所以没有理由不以此类扎实的编码实践为基础。</p>
  
  	<p>既然您已经了解了设计模式以及它们的有用之处，现在我们来看看 PHP V5 的五种常用模式。</p>
    
    <h4>工厂模式</h4>
	
	<p>最初在设计模式 一书中，许多设计模式都鼓励使用松散耦合。要理解这个概念，让我们最好谈一下许多开发人员从事大型系统的艰苦历程。在更改一个代码片段时，就会发生问题，系统其他部分 —— 您曾认为完全不相关的部分中也有可能出现级联破坏。</p>
  
  	<p>该问题在于紧密耦合。系统某个部分中的函数和类严重依赖于系统的其他部分中函数和类的行为和结构。您需要一组模式，使这些类能够相互通信，但不希望将它们紧密绑定在一起，以避免出现联锁。</p>
    
    <p>在大型系统中，许多代码依赖于少数几个关键类。需要更改这些类时，可能会出现困难。例如，假设您有一个从文件读取的 User 类。您希望将其更改为从数据库读取的其他类，但是，所有的代码都引用从文件读取的原始类。这时候，使用工厂模式会很方便。</p>
  
  	<p>工厂模式 是一种类，它具有为您创建对象的某些方法。您可以使用工厂类创建对象，而不直接使用 new。这样，如果您想要更改所创建的对象类型，只需更改该工厂即可。使用该工厂的所有代码会自动更改。</p>
    
    <p>清单 1 显示工厂类的一个示列。等式的服务器端包括两个部分：数据库和一组 PHP 页面，这些页面允许您添加反馈、请求反馈列表并获取与特定反馈相关的文章。</p>
	
	<p>清单 1. Factory1.php</p>
	
<div id="highlighter_419003" class="syntaxhighlighter  "><div class="bar   "><div class="toolbar"><a href="http://www.nowamagic.net/php/php_PhpDesignPatterns.php#viewSource" title="view source" style="width: 16px; height: 16px; " class="item viewSource">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_419003_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_419003" menu="false" src="../includes/syntaxhighlighter_2.1.364/scripts/clipboard.swf"></div><a href="http://www.nowamagic.net/php/php_PhpDesignPatterns.php#printSource" title="print" style="width: 16px; height: 16px; " class="item printSource">print</a><a href="http://www.nowamagic.net/php/php_PhpDesignPatterns.php#about" title="?" style="width: 16px; height: 16px; " class="item about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="plain">&lt;?php</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="keyword">interface</code> <code class="plain">IUser</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">function</code> <code class="plain">getName();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="keyword">class</code> <code class="plain">User </code><code class="keyword">implements</code> <code class="plain">IUser</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="keyword">function</code> <code class="plain">__construct( </code><code class="variable">$id</code> <code class="plain">) { }</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="keyword">function</code> <code class="plain">getName()</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">return</code> <code class="string">"Jack"</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="keyword">class</code> <code class="plain">UserFactory</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="keyword">static</code> <code class="keyword">function</code> <code class="plain">Create( </code><code class="variable">$id</code> <code class="plain">)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">return</code> <code class="keyword">new</code> <code class="plain">User( </code><code class="variable">$id</code> <code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>24</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>25</code></td><td class="content"><code class="variable">$uo</code> <code class="plain">= UserFactory::Create( 1 );</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>26</code></td><td class="content"><code class="functions">echo</code><code class="plain">( </code><code class="variable">$uo</code><code class="plain">-&gt;getName().</code><code class="string">"\n"</code> <code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>27</code></td><td class="content"><code class="plain">?&gt;</code></td></tr></tbody></table></div></div></div>
  
  	<p>IUser 接口定义用户对象应执行什么操作。IUser 的实现称为 User，UserFactory 工厂类则创建 IUser 对象。此关系可以用图 1 中的 UML 表示。</p>
    
	<div style="background:url(images/design-patterns.png) no-repeat 0px 0px; width:229px; height:86px;"></div>
	
    <p>测试代码会向工厂请求 User 对象，并输出 getName 方法的结果。</p>
  
  	<p>有一种工厂模式的变体使用工厂方法。类中的这些公共静态方法构造该类型的对象。如果创建此类型的对象非常重要，此方法非常有用。例如，假设您需要先创建对象，然后设置许多属性。此版本的工厂模式会将该进程封装在单个位置中，这样，不用复制复杂的初始化代码，也不必将复制好的代码在在代码库中到处粘贴。</p>
    
    <p>清单 2 显示使用工厂方法的一个示例。</p>
	
<div id="highlighter_355111" class="syntaxhighlighter  "><div class="bar  "><div class="toolbar"><a href="http://www.nowamagic.net/php/php_PhpDesignPatterns.php#viewSource" title="view source" style="width: 16px; height: 16px; " class="item viewSource">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_355111_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_355111" menu="false" src="../includes/syntaxhighlighter_2.1.364/scripts/clipboard.swf"></div><a href="http://www.nowamagic.net/php/php_PhpDesignPatterns.php#printSource" title="print" style="width: 16px; height: 16px; " class="item printSource">print</a><a href="http://www.nowamagic.net/php/php_PhpDesignPatterns.php#about" title="?" style="width: 16px; height: 16px; " class="item about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="plain">&lt;?php</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="keyword">interface</code> <code class="plain">IUser</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">function</code> <code class="plain">getName();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="keyword">class</code> <code class="plain">User </code><code class="keyword">implements</code> <code class="plain">IUser</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="keyword">static</code> <code class="keyword">function</code> <code class="plain">Load( </code><code class="variable">$id</code> <code class="plain">) </code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">return</code> <code class="keyword">new</code> <code class="plain">User( </code><code class="variable">$id</code> <code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="keyword">static</code> <code class="keyword">function</code> <code class="plain">Create( ) </code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">return</code> <code class="keyword">new</code> <code class="plain">User( null );</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="keyword">function</code> <code class="plain">__construct( </code><code class="variable">$id</code> <code class="plain">) { }</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="keyword">function</code> <code class="plain">getName()</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">return</code> <code class="string">"Jack"</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>24</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>25</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>26</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>27</code></td><td class="content"><code class="variable">$uo</code> <code class="plain">= User::Load( 1 );</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>28</code></td><td class="content"><code class="functions">echo</code><code class="plain">( </code><code class="variable">$uo</code><code class="plain">-&gt;getName().</code><code class="string">"\n"</code> <code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>29</code></td><td class="content"><code class="plain">?&gt;</code></td></tr></tbody></table></div></div></div>
	
	<p>这段代码要简单得多。它仅有一个接口 IUser 和一个实现此接口的 User 类。User 类有两个创建对象的静态方法。此关系可用图 2 中的 UML 表示。</p>
  
  	<p>图 2. IUser 接口和带有工厂方法的 user 类</p>
	
	<div style="background:url(images/design-patterns.png) no-repeat 0px -89px; width:95px; height:113px;"></div>
    
    <p>如上所述，有时此类模式在规模较小的环境中似乎有些大材小用。不过，最好还是学习这种扎实的编码形式，以便应用于任意规模的项目中。</p>
  
  	<h4>单元素模式</h4>
    
    <p>某些应用程序资源是独占的，因为有且只有一个此类型的资源。例如，通过数据库句柄到数据库的连接是独占的。您希望在应用程序中共享数据库句柄，因为在保持连接打开或关闭时，它是一种开销，在获取单个页面的过程中更是如此。</p>
	
	<p>单元素模式可以满足此要求。如果应用程序每次包含且仅包含一个对象，那么这个对象就是一个单元素（Singleton）。清单 3 中的代码显示了 PHP V5 中的一个数据库连接单元素。</p>
  
  	<p>清单 3. Singleton.php</p>
	
<div id="highlighter_307014" class="syntaxhighlighter  "><div class="bar  "><div class="toolbar"><a href="http://www.nowamagic.net/php/php_PhpDesignPatterns.php#viewSource" title="view source" style="width: 16px; height: 16px; " class="item viewSource">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_307014_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_307014" menu="false" src="../includes/syntaxhighlighter_2.1.364/scripts/clipboard.swf"></div><a href="http://www.nowamagic.net/php/php_PhpDesignPatterns.php#printSource" title="print" style="width: 16px; height: 16px; " class="item printSource">print</a><a href="http://www.nowamagic.net/php/php_PhpDesignPatterns.php#about" title="?" style="width: 16px; height: 16px; " class="item about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="plain">&lt;?php</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="keyword">require_once</code><code class="plain">(</code><code class="string">"DB.php"</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="keyword">class</code> <code class="plain">DatabaseConnection</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="keyword">static</code> <code class="keyword">function</code> <code class="plain">get()</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">static</code> <code class="variable">$db</code> <code class="plain">= null;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">if</code> <code class="plain">( </code><code class="variable">$db</code> <code class="plain">== null )</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="variable">$db</code> <code class="plain">= </code><code class="keyword">new</code> <code class="plain">DatabaseConnection();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">return</code> <code class="variable">$db</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">private</code> <code class="variable">$_handle</code> <code class="plain">= null;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">private</code> <code class="keyword">function</code> <code class="plain">__construct()</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="variable">$dsn</code> <code class="plain">= </code><code class="string">'<a href="mysql://root:password@localhost/photos">mysql://root:password@localhost/photos</a>'</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="variable">$this</code><code class="plain">-&gt;_handle =&amp; DB::Connect( </code><code class="variable">$dsn</code><code class="plain">, </code><code class="keyword">array</code><code class="plain">() );</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code>&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="keyword">function</code> <code class="plain">handle()</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>24</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">return</code> <code class="variable">$this</code><code class="plain">-&gt;_handle;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>25</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>26</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>27</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>28</code></td><td class="content"><code class="plain">print( </code><code class="string">"Handle = "</code><code class="plain">.DatabaseConnection::get()-&gt;handle().</code><code class="string">"\n"</code> <code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>29</code></td><td class="content"><code class="plain">print( </code><code class="string">"Handle = "</code><code class="plain">.DatabaseConnection::get()-&gt;handle().</code><code class="string">"\n"</code> <code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>30</code></td><td class="content"><code class="plain">?&gt;</code></td></tr></tbody></table></div></div></div>
    
    <p>此代码显示名为 DatabaseConnection 的单个类。您不能创建自已的 DatabaseConnection，因为构造函数是专用的。但使用静态 get 方法，您可以获得且仅获得一个 DatabaseConnection 对象。此代码的 UML 如图 3 所示。</p>
  
  	<p>图 3. 数据库连接单元素</p>
	
	<div style="background:url(images/design-patterns.png) no-repeat 0px -203px; width:165px; height:41px;"></div>
    
    <p>在两次调用间，handle 方法返回的数据库句柄是相同的，这就是最好的证明。返回的两个句柄是同一对象。如果您在整个应用程序中使用数据库连接单元素，那么就可以在任何地方重用同一句柄。</p>
	
	<p>您可以使用全局变量存储数据库句柄，但是，该方法仅适用于较小的应用程序。在较大的应用程序中，应避免使用全局变量，并使用对象和方法访问资源。</p>
  
  	<h4>观察者模式</h4>
    
    <p>观察者模式为您提供了避免组件之间紧密耦合的另一种方法。该模式非常简单：一个对象通过添加一个方法（该方法允许另一个对象，即观察者 注册自己）使本身变得可观察。当可观察的对象更改时，它会将消息发送到已注册的观察者。这些观察者使用该信息执行的操作与可观察的对象无关。结果是对象可以相互对话，而不必了解原因。</p>
  
  	<p>一个简单示例是系统中的用户列表。清单 4 中的代码显示一个用户列表，添加用户时，它将发送出一条消息。添加用户时，通过发送消息的日志观察者可以观察此列表。</p>
    
    <p>清单 4. Observer.php</p>
	
<div id="highlighter_227298" class="syntaxhighlighter  "><div class="bar    "><div class="toolbar"><a href="http://www.nowamagic.net/php/php_PhpDesignPatterns.php#viewSource" title="view source" style="width: 16px; height: 16px; " class="item viewSource">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_227298_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_227298" menu="false" src="../includes/syntaxhighlighter_2.1.364/scripts/clipboard.swf"></div><a href="http://www.nowamagic.net/php/php_PhpDesignPatterns.php#printSource" title="print" style="width: 16px; height: 16px; " class="item printSource">print</a><a href="http://www.nowamagic.net/php/php_PhpDesignPatterns.php#about" title="?" style="width: 16px; height: 16px; " class="item about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="plain">&lt;?php</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="keyword">interface</code> <code class="plain">IObserver</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">function</code> <code class="plain">onChanged( </code><code class="variable">$sender</code><code class="plain">, </code><code class="variable">$args</code> <code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="keyword">interface</code> <code class="plain">IObservable</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">function</code> <code class="plain">addObserver( </code><code class="variable">$observer</code> <code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="keyword">class</code> <code class="plain">UserList </code><code class="keyword">implements</code> <code class="plain">IObservable</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">private</code> <code class="variable">$_observers</code> <code class="plain">= </code><code class="keyword">array</code><code class="plain">();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="keyword">function</code> <code class="plain">addCustomer( </code><code class="variable">$name</code> <code class="plain">)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">foreach</code><code class="plain">( </code><code class="variable">$this</code><code class="plain">-&gt;_observers </code><code class="keyword">as</code> <code class="variable">$obs</code> <code class="plain">)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="variable">$obs</code><code class="plain">-&gt;onChanged( </code><code class="variable">$this</code><code class="plain">, </code><code class="variable">$name</code> <code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="keyword">function</code> <code class="plain">addObserver( </code><code class="variable">$observer</code> <code class="plain">)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>24</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="variable">$this</code><code class="plain">-&gt;_observers []= </code><code class="variable">$observer</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>25</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>26</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>27</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>28</code></td><td class="content"><code class="keyword">class</code> <code class="plain">UserListLogger </code><code class="keyword">implements</code> <code class="plain">IObserver</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>29</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>30</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="keyword">function</code> <code class="plain">onChanged( </code><code class="variable">$sender</code><code class="plain">, </code><code class="variable">$args</code> <code class="plain">)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>31</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>32</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions">echo</code><code class="plain">( </code><code class="string">"'$args' added to user list\n"</code> <code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>33</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>34</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>35</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>36</code></td><td class="content"><code class="variable">$ul</code> <code class="plain">= </code><code class="keyword">new</code> <code class="plain">UserList();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>37</code></td><td class="content"><code class="variable">$ul</code><code class="plain">-&gt;addObserver( </code><code class="keyword">new</code> <code class="plain">UserListLogger() );</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>38</code></td><td class="content"><code class="variable">$ul</code><code class="plain">-&gt;addCustomer( </code><code class="string">"Jack"</code> <code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>39</code></td><td class="content"><code class="plain">?&gt;</code></td></tr></tbody></table></div></div></div>
	
	<p>此代码定义四个元素：两个接口和两个类。IObservable 接口定义可以被观察的对象，UserList 实现该接口，以便将本身注册为可观察。IObserver 列表定义要通过怎样的方法才能成为观察者，UserListLogger 实现 IObserver 接口。图 4 的 UML 中展示了这些元素。</p>
  
  	<p>图 4. 可观察的用户列表和用户列表事件日志程序</p>
	
	<div style="background:url(images/design-patterns.png) no-repeat 0px -246px; width:414px; height:99px;"></div>
    
    <p>测试代码创建 UserList，并将 UserListLogger 观察者添加到其中。然后添加一个消费者，并将这一更改通知 UserListLogger。</p>
  
  	<p>认识到 UserList 不知道日志程序将执行什么操作很关键。可能存在一个或多个执行其他操作的侦听程序。例如，您可能有一个向新用户发送消息的观察者，欢迎新用户使用该系统。这种方法的价值在于 UserList 忽略所有依赖它的对象，它主要关注在列表更改时维护用户列表并发送消息这一工作。</p>
    
    <p>此模式不限于内存中的对象。它是在较大的应用程序中使用的数据库驱动的消息查询系统的基础。</p>
	
	<h4>命令链模式</h4>
  
  	<p>命令链 模式以松散耦合主题为基础，发送消息、命令和请求，或通过一组处理程序发送任意内容。每个处理程序都会自行判断自己能否处理请求。如果可以，该请求被处理，进程停止。您可以为系统添加或移除处理程序，而不影响其他处理程序。清单 5 显示了此模式的一个示例。</p>
    
    <p>清单 5. Chain.php</p>
	
<div id="highlighter_957790" class="syntaxhighlighter  "><div class="bar     "><div class="toolbar"><a href="http://www.nowamagic.net/php/php_PhpDesignPatterns.php#viewSource" title="view source" style="width: 16px; height: 16px; " class="item viewSource">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_957790_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_957790" menu="false" src="../includes/syntaxhighlighter_2.1.364/scripts/clipboard.swf"></div><a href="http://www.nowamagic.net/php/php_PhpDesignPatterns.php#printSource" title="print" style="width: 16px; height: 16px; " class="item printSource">print</a><a href="http://www.nowamagic.net/php/php_PhpDesignPatterns.php#about" title="?" style="width: 16px; height: 16px; " class="item about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="plain">&lt;?php</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="keyword">interface</code> <code class="plain">ICommand</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="keyword">function</code> <code class="plain">onCommand( </code><code class="variable">$name</code><code class="plain">, </code><code class="variable">$args</code> <code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="keyword">class</code> <code class="plain">CommandChain</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="keyword">private</code> <code class="variable">$_commands</code> <code class="plain">= </code><code class="keyword">array</code><code class="plain">();</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="keyword">function</code> <code class="plain">addCommand( </code><code class="variable">$cmd</code> <code class="plain">)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="variable">$this</code><code class="plain">-&gt;_commands []= </code><code class="variable">$cmd</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="keyword">function</code> <code class="plain">runCommand( </code><code class="variable">$name</code><code class="plain">, </code><code class="variable">$args</code> <code class="plain">)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">foreach</code><code class="plain">( </code><code class="variable">$this</code><code class="plain">-&gt;_commands </code><code class="keyword">as</code> <code class="variable">$cmd</code> <code class="plain">)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">if</code> <code class="plain">( </code><code class="variable">$cmd</code><code class="plain">-&gt;onCommand( </code><code class="variable">$name</code><code class="plain">, </code><code class="variable">$args</code> <code class="plain">) )</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">return</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>24</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>25</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>26</code></td><td class="content"><code class="keyword">class</code> <code class="plain">UserCommand </code><code class="keyword">implements</code> <code class="plain">ICommand</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>27</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>28</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="keyword">function</code> <code class="plain">onCommand( </code><code class="variable">$name</code><code class="plain">, </code><code class="variable">$args</code> <code class="plain">)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>29</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>30</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">if</code> <code class="plain">( </code><code class="variable">$name</code> <code class="plain">!= </code><code class="string">'addUser'</code> <code class="plain">) </code><code class="keyword">return</code> <code class="plain">false;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>31</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions">echo</code><code class="plain">( </code><code class="string">"UserCommand handling 'addUser'\n"</code> <code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>32</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">return</code> <code class="plain">true;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>33</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>34</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>35</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>36</code></td><td class="content"><code class="keyword">class</code> <code class="plain">MailCommand </code><code class="keyword">implements</code> <code class="plain">ICommand</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>37</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>38</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="keyword">function</code> <code class="plain">onCommand( </code><code class="variable">$name</code><code class="plain">, </code><code class="variable">$args</code> <code class="plain">)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>39</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>40</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">if</code> <code class="plain">( </code><code class="variable">$name</code> <code class="plain">!= </code><code class="string">'mail'</code> <code class="plain">) </code><code class="keyword">return</code> <code class="plain">false;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>41</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions">echo</code><code class="plain">( </code><code class="string">"MailCommand handling 'mail'\n"</code> <code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>42</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">return</code> <code class="plain">true;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>43</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>44</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>45</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>46</code></td><td class="content"><code class="variable">$cc</code> <code class="plain">= </code><code class="keyword">new</code> <code class="plain">CommandChain();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>47</code></td><td class="content"><code class="variable">$cc</code><code class="plain">-&gt;addCommand( </code><code class="keyword">new</code> <code class="plain">UserCommand() );</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>48</code></td><td class="content"><code class="variable">$cc</code><code class="plain">-&gt;addCommand( </code><code class="keyword">new</code> <code class="plain">MailCommand() );</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>49</code></td><td class="content"><code class="variable">$cc</code><code class="plain">-&gt;runCommand( </code><code class="string">'addUser'</code><code class="plain">, null );</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>50</code></td><td class="content"><code class="variable">$cc</code><code class="plain">-&gt;runCommand( </code><code class="string">'mail'</code><code class="plain">, null );</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>51</code></td><td class="content"><code class="plain">?&gt;</code></td></tr></tbody></table></div></div></div>
  
  	<p>此代码定义维护 ICommand 对象列表的 CommandChain 类。两个类都可以实现 ICommand 接口 —— 一个对邮件的请求作出响应，另一个对添加用户作出响应。 图 5 给出了 UML。</p>
    
    <p>图 5. 命令链及其相关命令</p>
	
	<div style="background:url(images/design-patterns.png) no-repeat 0px -347px; width:359px; height:121px;"></div>
	
	<p>代码首先创建 CommandChain 对象，并为它添加两个命令对象的实例。然后运行两个命令以查看谁对这些命令作出了响应。如果命令的名称匹配 UserCommand 或 MailCommand，则代码失败，不发生任何操作。为处理请求而创建可扩展的架构时，命令链模式很有价值，使用它可以解决许多问题。</p>
  
  	<h4>策略模式</h4>
    
    <p>我们讲述的最后一个设计模式是策略 模式。在此模式中，算法是从复杂类提取的，因而可以方便地替换。例如，如果要更改搜索引擎中排列页的方法，则策略模式是一个不错的选择。思考一下搜索引擎的几个部分 —— 一部分遍历页面，一部分对每页排列，另一部分基于排列的结果排序。在复杂的示例中，这些部分都在同一个类中。通过使用策略模式，您可将排列部分放入另一个类中，以便更改页排列的方式，而不影响搜索引擎的其余代码。</p>
  
  	<p>作为一个较简单的示例，清单 6 显示了一个用户列表类，它提供了一个根据一组即插即用的策略查找一组用户的方法。</p>
    
    <p>清单 6. Strategy.php</p>
	
<div id="highlighter_389574" class="syntaxhighlighter  "><div class="bar                           show"><div class="toolbar"><a href="http://www.nowamagic.net/php/php_PhpDesignPatterns.php#viewSource" title="view source" style="width: 16px; height: 16px; " class="item viewSource">view source</a><div class="item copyToClipboard"><embed width="16" height="16" id="highlighter_389574_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_389574" menu="false" src="../includes/syntaxhighlighter_2.1.364/scripts/clipboard.swf"></div><a href="http://www.nowamagic.net/php/php_PhpDesignPatterns.php#printSource" title="print" style="width: 16px; height: 16px; " class="item printSource">print</a><a href="http://www.nowamagic.net/php/php_PhpDesignPatterns.php#about" title="?" style="width: 16px; height: 16px; " class="item about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="plain">&lt;?php</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="keyword">interface</code> <code class="plain">IStrategy</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="keyword">function</code> <code class="plain">filter( </code><code class="variable">$record</code> <code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="keyword">class</code> <code class="plain">FindAfterStrategy </code><code class="keyword">implements</code> <code class="plain">IStrategy</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="keyword">private</code> <code class="variable">$_name</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="keyword">function</code> <code class="plain">__construct( </code><code class="variable">$name</code> <code class="plain">)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="variable">$this</code><code class="plain">-&gt;_name = </code><code class="variable">$name</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="keyword">function</code> <code class="plain">filter( </code><code class="variable">$record</code> <code class="plain">)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">return</code> <code class="functions">strcmp</code><code class="plain">( </code><code class="variable">$this</code><code class="plain">-&gt;_name, </code><code class="variable">$record</code> <code class="plain">) &lt;= 0;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content"><code class="keyword">class</code> <code class="plain">RandomStrategy </code><code class="keyword">implements</code> <code class="plain">IStrategy</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>24</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="keyword">function</code> <code class="plain">filter( </code><code class="variable">$record</code> <code class="plain">)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>25</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>26</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">return</code> <code class="plain">rand( 0, 1 ) &gt;= 0.5;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>27</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>28</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>29</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>30</code></td><td class="content"><code class="keyword">class</code> <code class="plain">UserList</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>31</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>32</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="keyword">private</code> <code class="variable">$_list</code> <code class="plain">= </code><code class="keyword">array</code><code class="plain">();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>33</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>34</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="keyword">function</code> <code class="plain">__construct( </code><code class="variable">$names</code> <code class="plain">)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>35</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>36</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">if</code> <code class="plain">( </code><code class="variable">$names</code> <code class="plain">!= null )</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>37</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>38</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">foreach</code><code class="plain">( </code><code class="variable">$names</code> <code class="keyword">as</code> <code class="variable">$name</code> <code class="plain">)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>39</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>40</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="variable">$this</code><code class="plain">-&gt;_list []= </code><code class="variable">$name</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>41</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>42</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>43</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>44</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>45</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="keyword">function</code> <code class="plain">add( </code><code class="variable">$name</code> <code class="plain">)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>46</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>47</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="variable">$this</code><code class="plain">-&gt;_list []= </code><code class="variable">$name</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>48</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>49</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>50</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="keyword">public</code> <code class="keyword">function</code> <code class="plain">find( </code><code class="variable">$filter</code> <code class="plain">)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>51</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>52</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="variable">$recs</code> <code class="plain">= </code><code class="keyword">array</code><code class="plain">();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>53</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">foreach</code><code class="plain">( </code><code class="variable">$this</code><code class="plain">-&gt;_list </code><code class="keyword">as</code> <code class="variable">$user</code> <code class="plain">)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>54</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>55</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">if</code> <code class="plain">( </code><code class="variable">$filter</code><code class="plain">-&gt;filter( </code><code class="variable">$user</code> <code class="plain">) )</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>56</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="variable">$recs</code> <code class="plain">[]= </code><code class="variable">$user</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>57</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>58</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword">return</code> <code class="variable">$recs</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>59</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>60</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>61</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>62</code></td><td class="content"><code class="variable">$ul</code> <code class="plain">= </code><code class="keyword">new</code> <code class="plain">UserList( </code><code class="keyword">array</code><code class="plain">( </code><code class="string">"Andy"</code><code class="plain">, </code><code class="string">"Jack"</code><code class="plain">, </code><code class="string">"Lori"</code><code class="plain">, </code><code class="string">"Megan"</code> <code class="plain">) );</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>63</code></td><td class="content"><code class="variable">$f1</code> <code class="plain">= </code><code class="variable">$ul</code><code class="plain">-&gt;find( </code><code class="keyword">new</code> <code class="plain">FindAfterStrategy( </code><code class="string">"J"</code> <code class="plain">) );</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>64</code></td><td class="content"><code class="plain">print_r( </code><code class="variable">$f1</code> <code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>65</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>66</code></td><td class="content"><code class="variable">$f2</code> <code class="plain">= </code><code class="variable">$ul</code><code class="plain">-&gt;find( </code><code class="keyword">new</code> <code class="plain">RandomStrategy() );</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>67</code></td><td class="content"><code class="plain">print_r( </code><code class="variable">$f2</code> <code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>68</code></td><td class="content"><code class="plain">?&gt;</code></td></tr></tbody></table></div></div></div>
	
	<p>此代码的 UML 如图 6 所示。</p>
    
    <p>图 6. 用户列表和用于选择用户的策略</p>
	
	<div style="background:url(images/design-patterns.png) no-repeat 0px -470px; width:309px; height:138px;"></div>
  
  	<p>UserList 类是打包名称数组的一个包装器。它实现 find 方法，该方法利用几个策略之一来选择这些名称的子集。这些策略由 IStrategy 接口定义，该接口有两个实现：一个随机选择用户，另一个根据指定名称选择其后的所有名称。</p>
    
    <p>测试代码为两个策略运行同一用户列表，并显示结果。在第一种情况中，策略查找排列在 J 后的任何名称，所以您将得到 Jack、Lori 和 Megan。第二个策略随机选取名称，每次会产生不同的结果。在这种情况下，结果为 Andy 和 Megan。</p>
	
	<p>策略模式非常适合复杂数据管理系统或数据处理系统，二者在数据筛选、搜索或处理的方式方面需要较高的灵活性。</p>
    
    <h4>结束语</h4>
  
  	<p>本文介绍的仅仅是 PHP 应用程序中使用的几种最常见的设计模式。在设计模式 一书中演示了更多的设计模式。不要因架构的神秘性而放弃。模式是一种绝妙的理念，适用于任何编程语言、任何技能水平。</p>
    
    <p><a href="http://www.ibm.com/developerworks/cn/opensource/os-php-designptrns/" target="_blank">source</a></p>

	</div>

  	</div>
  
  	<div class="additionalContent" id="additionalContent"> <style type="text/css">
#apDiv1 {
	position:absolute;
	left:-20px;
	top:-15px;
	width:55px;
	height:70px;
	z-index:1;
	background-image: url(../images/ul_leaf_overhang.png);
}
</style>




<div id="apDiv1"></div>
<table width="215" border="0">
  <tbody><tr>
    <td colspan="2" height="50" align="center" background="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/sidebarHeader.gif"><span class="white">随机文章推荐</span></td>
    
  </tr>
</tbody></table>


<ul class="adition">
  <li><a href="http://www.nowamagic.net/php/php_ReferenceOperator.php">PHP引用符&amp;的用法介绍</a></li>

  <li><a href="http://www.nowamagic.net/php/php_CountDown.php">PHP 实现类商品秒杀计时</a></li>

  <li><a href="http://www.nowamagic.net/php/php_FunctionExit.php">PHP exit函数介绍</a></li>

  <li><a href="http://www.nowamagic.net/php/php_FunctionPlanStrpos.php">PHP函数补完计划：strpos()函数</a></li>

  <li><a href="http://www.nowamagic.net/php/php_ZendLoaderAutoloader.php">Zend_Loader_Autoloader的运行原理</a></li>

  <li><a href="http://www.nowamagic.net/php/php_IntroToCacheFunction.php">PHP的缓存相关函数介绍</a></li>

  <li><a href="http://www.nowamagic.net/php/php_UseOfSession.php">PHP中关于session使用</a></li>

  <li><a href="http://www.nowamagic.net/php/php_Calendar.php">PHP 日历算法</a></li>

  <li><a href="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/PHP一些常用的设计模式介绍 -- 简明现代魔法.htm">PHP一些常用的设计模式介绍</a></li>

  <li><a href="http://www.nowamagic.net/php/php_MutipleExtends.php">PHP面向对象：使用接口与组合模拟多继承</a></li>

  <li><a href="http://www.nowamagic.net/php/php_ComputeDate.php">PHP计算时间差</a></li>

  <li><a href="http://www.nowamagic.net/php/php_ErrorInMysqlRealEscapeString.php">mysql_real_escape_string()函数遇到一个错误</a></li>

</ul>
  
    
    
     


<table width="215" border="0">
<!--
  <tr>
    <td height="50" align="center" background="../images/sidebarHeader.gif"><span class="white">赞助商链接</span></td>
  </tr>
-->
  <tbody><tr>
    <td height="5px;">
    </td>
  </tr>
  <tr>
    <td align="center">
<script type="text/javascript"><!--
google_ad_client = "pub-3908995730077629";
/* 200x200, 创建于 10-6-23 */
google_ad_slot = "2030993783";
google_ad_width = 200;
google_ad_height = 200;
//-->
</script>
<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>    </td>
  </tr>
</tbody></table>

<table width="215" border="0">
  <tbody><tr>
    <td colspan="2" height="50" align="center" background="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/sidebarHeader.gif"><span class="white">网站分类</span></td>
  </tr>
</tbody></table>



<table width="210" border="0">
  <tbody><tr>
    <td>
<ul class="adition">

<li><a href="http://www.nowamagic.net/html/html.php" target="_blank">HTML</a> (44)</li><li><a href="http://www.nowamagic.net/csszone/css.php" target="_blank">CSS</a> (105)</li><li><a href="http://www.nowamagic.net/javascript/javascript.php" target="_blank">JavaScript</a> (232)</li><li><a href="http://www.nowamagic.net/jquery/jquey.php" target="_blank">JQuery</a> (53)</li><li><a href="http://www.nowamagic.net/ajax/ajax.php" target="_blank">Ajax</a> (34)</li><li><a href="http://www.nowamagic.net/php/php.php" target="_blank">PHP</a> (314)</li><li><a href="http://www.nowamagic.net/java/java.php" target="_blank">Java</a> (39)</li><li><a href="http://www.nowamagic.net/cpp/cpp.php" target="_blank">C/C++</a> (35)</li><li><a href="http://www.nowamagic.net/flex/flex.php" target="_blank">ActionScript</a> (21)</li><li><a href="http://www.nowamagic.net/photoshop/photoshop.php" target="_blank">PhotoShop</a> (4)</li><li><a href="http://www.nowamagic.net/xmlzone/xml.php" target="_blank">XML</a> (1)</li><li><a href="http://www.nowamagic.net/wordpress/wordpress.php" target="_blank">WordPress</a> (9)</li><li><a href="http://www.nowamagic.net/datastructures/datastructures.php" target="_blank">数据结构</a> (14)</li><li><a href="http://www.nowamagic.net/algorithm/algorithm.php" target="_blank">计算机算法</a> (56)</li><li><a href="http://www.nowamagic.net/database/database.php" target="_blank">数据库技术</a> (66)</li><li><a href="http://www.nowamagic.net/operatingsystem/operatingsystem.php" target="_blank">操作系统</a> (1)</li><li><a href="http://www.nowamagic.net/internet/internet.php" target="_blank">互联网时代</a> (160)</li><li><a href="http://www.nowamagic.net/projects/projects.php" target="_blank">软件项目</a> (27)</li><li><a href="http://www.nowamagic.net/program/program.php" target="_blank">编程思想</a> (57)</li><li><a href="http://www.nowamagic.net/seo/seo.php" target="_blank">搜索引擎优化</a> (31)</li><li><a href="http://www.nowamagic.net/webdesign/webdesign.php" target="_blank">Web设计理念</a> (77)</li><li><a href="http://www.nowamagic.net/architecture/architecture.php" target="_blank">软件架构技术</a> (31)</li><li><a href="http://www.nowamagic.net/tool/tool.php" target="_blank">信息化工具</a> (12)</li><li><a href="http://www.nowamagic.net/advertisement/ads.php" target="_blank">广告设计</a> (7)</li><li><a href="http://www.nowamagic.net/programlife/programlife.php" target="_blank">程序人生</a> (18)</li><li><a href="http://www.nowamagic.net/word/word.php" target="_blank">喃喃细语</a> (61)</li>
</ul>
    </td>
  </tr>
</tbody></table>

 </div>
  	<div class="bottom" id="bottom"> ﻿<style>
input { margin:5px 0px 5px 0px;}
textarea { margin:5px 0px 5px 0px; }
.bottomAds {
	border:1px solid white;
	margin:10px 3px 0 3px;
}
.bottomAds_quote{
	width:700px;
	margin:0px 5px 0px 5px;
	line-height:150%;
	font-family:Verdana,宋体;  
    font-size: 12px;  
	padding: 5px 5px 5px 5px;
	border: 1px solid #CCC;	
}
.bottomAds_quote legend{
	color:green;
	font-family:微软雅黑;
	font-size:16px;
}
.bottomAds_quote p{
	margin:0;
	padding:0;
	text-indent:24px;
	line-height:150%;
}
.ads {
	margin:5px 5px 5px 5px;
	width:350px;
	float:left;
}

.ads_content {
	margin:8px 5px 8px 10px;
	width:305px;
	float:right;
}

</style>


<p style=" text-indent:2em; ">注：如需转载本文，请注明出处（原文链接），谢谢。更多精彩内容，请进入<a href="http://www.nowamagic.net/index.php" target="_blank">简明现代魔法</a>首页。</p>

<table width="700" border="0">
  <tbody><tr>
    <td align="center"><a href="http://www.nowamagic.net/librarys/veda/" target="_blank" title="进入新博客" class="tbtns t-b">进入新博客</a></td>
  </tr>
</tbody></table>

<div class="bottomAds">
<fieldset class="bottomAds_quote"><legend>你也许还会对以下文章感兴趣</legend>
<table width="700" border="0">
  <tbody><tr>
    <td>


<ul class="adition">

  <li><a href="http://www.nowamagic.net/php/php_ArrayIsImplementedWithHash.php">PHP的数组是用hash实现的</a></li>


  <li><a href="http://www.nowamagic.net/php/php_CrossTimezone.php">PHP跨时区的实现</a></li>


  <li><a href="http://www.nowamagic.net/php/php_FunctionStrstr.php">PHP strstr()函数补完</a></li>


  <li><a href="http://www.nowamagic.net/php/php_OopCourseClassObject.php">PHP 面向对象：类和对象</a></li>


  <li><a href="http://www.nowamagic.net/php/php_SimpleFactoryPattern.php">PHP面向对象：简单工厂模式</a></li>

</ul>
    </td>
    <td>
    <ul class="adition">

  <li><a href="http://www.nowamagic.net/php/php_ImportRequestVariables.php">将页面传值写入全局作用域 import_request_variables</a></li>


  <li><a href="http://www.nowamagic.net/php/php_ImageUpload.php">PHP图片上传程序设计</a></li>


  <li><a href="http://www.nowamagic.net/php/php_GetBrowserType.php">PHP判断浏览器类型的代码</a></li>


  <li><a href="http://www.nowamagic.net/php/php_FunctionsInGame.php">游戏中常见功能的PHP实现</a></li>


  <li><a href="http://www.nowamagic.net/php/php_DisallowedKeyCharacters.php">CI报Disallowed Key Characters的解决</a></li>

    </ul>
    </td>
  </tr>
</tbody></table>


</fieldset>
</div>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/ga.js" type="text/javascript"></script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-15029466-1");
pageTracker._trackPageview();
} catch(err) {}</script>
<script language="javascript">
function chkinput(form)
{
	if(form.name.value=="")
	{
		alert("请输入名称");
	   	form.name.select();
	   	return(false);
	}
	if(form.email.value=="")
	{
		alert("请输入电子邮件");
	   	form.email.select();
	   	return(false);
	}
	if(form.content.value=="")
	{
	   	alert("请输入留言");
	   	form.content.select();
	   	return(false);
	}
	if(form.check.value=="")
	{
	   	alert("请输入验证码");
	   	form.check.select();
	   	return(false);
	}
    return(true);
}
</script>

<style type="text/css">
.inputstyle { font-family: Verdana,Arial,Helvetica,sans-serif !important; font-size:14px !important; height:22px !important; padding-top:4px !important;}
.reptext {
	width:340px;
	border:1px solid #6CAEDF;
	height:120px;
	word-wrap:break-word;
	line-height: 150%;
	overflow:auto;
	overflow-x: hidden;
	outline:none;
	font-family: Verdana,Arial,Helvetica,sans-serif !important;
    font-size: 14px !important;
    padding-top: 4px !important;
}
</style>

<div style="margin:10px 0 0 10px; height:45px; overflow:hidden;"><script type="text/javascript"> /*640*60，创建于2010-8-31*/ var cpro_id = 'u176816';</script>
<script type="text/javascript" src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/c.js"></script><script type="text/javascript" charset="utf-8" src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/ecom"></script><div style="display:none">-</div> <iframe id="cproIframe1" src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/uijs(1).htm" width="640" height="60" align="center,center" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" allowtransparency="true"></iframe></div>

<div class="bottomAds">
<fieldset class="bottomAds_quote" style="padding:12px 12px 12px 15px">
	<legend>喜欢本文，就分享它吧</legend>
<!-- JiaThis Button BEGIN -->
<div id="jiathis_style_32x32">
	<a class="jiathis_button_tsina" title="分享到新浪微博"><span class="jiathis_txt jtico jtico_tsina"></span></a>
	<a class="jiathis_button_tqq" title="分享到腾讯微博"><span class="jiathis_txt jtico jtico_tqq"></span></a>
	<a class="jiathis_button_qzone" title="分享到QQ空间"><span class="jiathis_txt jtico jtico_qzone"></span></a>
	<a class="jiathis_button_t163" title="分享到网易微博"><span class="jiathis_txt jtico jtico_t163"></span></a>
	<a class="jiathis_button_renren" title="分享到人人网"><span class="jiathis_txt jtico jtico_renren"></span></a>
	<a class="jiathis_button_kaixin001" title="分享到开心网"><span class="jiathis_txt jtico jtico_kaixin001"></span></a>
	<a class="jiathis_button_douban" title="分享到豆瓣"><span class="jiathis_txt jtico jtico_douban"></span></a>
	<a class="jiathis_button_xiaoyou" title="分享到朋友网"><span class="jiathis_txt jtico jtico_xiaoyou"></span></a>
	<a class="jiathis_button_googlereader"></a>
	<a class="jiathis_button_buzz" title="分享到谷歌Buzz"><span class="jiathis_txt jtico jtico_buzz"></span></a>
	<a class="jiathis_button_fb" title="分享到Facebook"><span class="jiathis_txt jtico jtico_fb"></span></a>
	<a class="jiathis_button_twitter" title="分享到Twitter"><span class="jiathis_txt jtico jtico_twitter"></span></a>
	<a class="jiathis_button_gmail" title="分享到Gmail邮箱"><span class="jiathis_txt jtico jtico_gmail"></span></a>
	<a class="jiathis_button_youdao" title="分享到有道书签"><span class="jiathis_txt jtico jtico_youdao"></span></a>
	<a class="jiathis_button_taobao" title="分享到淘江湖"><span class="jiathis_txt jtico jtico_taobao"></span></a>
	<a class="jiathis_button_fav" title="添加到收藏夹"><span class="jiathis_txt jtico jtico_fav"></span></a>
	<a href="http://www.jiathis.com/share/?uid=1511560" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
</div>
<script type="text/javascript" src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/jia.js" charset="utf-8"></script><script type="text/javascript" src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/plugin.client.js" charset="utf-8"></script><div style="position:absolute;width:0px;height:0px;"><object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="0" height="0" id="JIATHISSWF" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab"><param name="allowScriptAccess" value="always"><param name="swLiveConnect" value="true"><param name="movie" value="http://www.jiathis.com/code/swf/m.swf"><param name="FlashVars" value="z=a"><embed name="JIATHISSWF" src="http://www.jiathis.com/code/swf/m.swf" flashvars="z=a" width="0" height="0" allowscriptaccess="always" swliveconnect="true" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer"></object></div>
<!-- JiaThis Button END -->
</fieldset>
</div>

<div class="bottomAds">
<fieldset class="bottomAds_quote"><legend>给我留言</legend>
<div class="ads">
<form action="http://www.nowamagic.net/utity/post.php" method="post" onsubmit="return chkinput(this)">
<table width="300" border="0">
	<tbody><tr>
		<td width="22%">您的名字：</td>
		<td width="78%"><input name="name" type="text" class="inputstyle"> </td>
	</tr>
	<tr>
		<td>您的邮件：</td>
		<td><input name="email" type="text" class="inputstyle"> </td>
	</tr>
	<tr>
		<td>您的网站：</td>
		<td><input name="website" type="text" class="inputstyle"> </td>
	</tr>
	<tr>
		<td colspan="2"><textarea name="content" class="reptext"></textarea></td>
	</tr>
	<tr>
		<td><img src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/checkcode.php"></td>
		<td><input type="text" name="check" class="inputstyle"> </td>
	</tr>
</tbody></table>

	<input type="submit" value="提交">
</form>
</div>
<div class="ads_content">
	<br>
<script type="text/javascript"> /*300*250，创建于2010-8-26*/ var cpro_id = 'u168559';</script>
<script type="text/javascript" src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/c.js"></script><script type="text/javascript" charset="utf-8" src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/ecom(1)"></script><div style="display:none">-</div> <iframe id="cproIframe2" src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/uijs.htm" width="300" height="250" align="center,center" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" allowtransparency="true"></iframe>
</div>
<br clear="both"> 
<!-- <a href="http://www.nowamagic.net/utity/MessageBoard.php">查看所有留言</a> -->
</fieldset>
</div> </div>

  	<div class="siteInfo" id="siteInfo"> <div class="ball_footer"> 
<object height="204" width="960" border="0">
<param value="templates/weeshine/images/flower.swf" name="movie"><param value="High" name="quality"><param value="ExactFit" name="scale"> <param value="transparent" name="wmode">
<embed height="204" width="960" scale="ExactFit" wmode="transparent" quality="High" name="FlashH" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" src="../swf/mnsv3.swf">

</object>
</div>
<table width="960" height="204" border="0" background="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/footer_2.jpg" align="center">
  <tbody><tr>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>
    <p align="center"><font color="gray">copyright © 2009 简明现代魔法 &nbsp;&nbsp; 学习、分享、进步</font></p>
    <p align="center"><font color="gray">power by Gonn 感谢所有关心和支持本站的朋友们</font></p></td>
  </tr>
</tbody></table>

 </div>
    
</div>
<script type="text/javascript" src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/shCore.js"></script>
<script type="text/javascript" src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/shBrushCpp.js"></script>
<script type="text/javascript" src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/shBrushCSharp.js"></script>
<script type="text/javascript" src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/shBrushCss.js"></script>
<script type="text/javascript" src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/shBrushJava.js"></script>
<script type="text/javascript" src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/shBrushJScript.js"></script>
<script type="text/javascript" src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/shBrushPhp.js"></script>
<script type="text/javascript" src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/shBrushPython.js"></script>
<script type="text/javascript" src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/shBrushSql.js"></script>
<script type="text/javascript" src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/shBrushXml.js"></script>
<link type="text/css" rel="stylesheet" href="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/shCore.css">
<link type="text/css" rel="stylesheet" href="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/shThemeDefault.css">
<script type="text/javascript">
	SyntaxHighlighter.config.clipboardSwf = '../includes/syntaxhighlighter_2.1.364/scripts/clipboard.swf';
	SyntaxHighlighter.all();
</script>
<iframe style="position: absolute; width: 100px; height: 1px; z-index: -10240; visibility: hidden; " src="./PHP一些常用的设计模式介绍 -- 简明现代魔法_files/e.htm"></iframe></body></html>