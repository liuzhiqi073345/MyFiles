(function(){function _debug(o){var str="";for(var i in o)if(typeof o[i]===Object||String(o[i])==="[object Object]"){str+="\n"+i+" =>\n";str+=_debug(o[i])}else str+=i+" : "+o[i]+"\n";return str}function debug(o){alert(_debug(o))}WMDEditor=function(options){this.options=WMDEditor.util.extend({},WMDEditor.defaults,options||{});wmdBase(this,this.options);this.startEditor()};window.WMDEditor=WMDEditor;var upload_path=DW.global.editor_upload_path;WMDEditor.defaults={is_select_code:false,code_number:0,link_or_img:[], version:2,output_format:"markdown",lineLength:40,button_bar:"wmd-button-bar",preview:"wmd-preview",output:"wmd-output",input:"wmd-input",imageDialogText:"<p style='margin-top: 0px'><b>Enter the image URL.</b></p>"+"<p>You can also add a title, which will be displayed as a tool tip.</p>"+'<p>Example:<br />http://wmd-editor.com/images/cloud1.jpg "Optional title"</p>',linkDialogText:"<p style='margin-top: 0px'><b>\u8f93\u5165\u7f51\u5740</b></p>",imageDefaultText:"http://",linkDefaultText:"http://", imageDirectory:"images/",helpLink:"javascript:void(0)",helpHoverTitle:"\u7f16\u8f91\u5668\u4f7f\u7528\u5e2e\u52a9",helpTarget:"",previewPollInterval:500,pastePollInterval:100,buttons:"bold italic link blockquote code image ol ul heading hr",tagFilter:{enabled:true,allowedTags:/^(<\/?(b|blockquote|code|del|dd|dl|dt|em|h1|h2|h3|i|kbd|li|ol|p|pre|s|sup|sub|strong|strike|ul)>|<(br|hr)\s?\/?>)$/i,patternCode:/^(<coding-\d+\s*lang="\w*">|<\/coding>)$/i,patternLink:/^(<a\s*(target="_blank")?\s*href="(\#\d+|(https?|ftp):\/\/[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+)"(\stitle="[^"<>]+")?\s?>|<\/a>)$/i, patternImage:/^(<img\ssrc="https?:(\/\/[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+)"(\swidth="\d{1,3}")?(\sheight="\d{1,3}")?(\salt="[^"<>]*")?(\stitle="[^"<>]*")?\s?\/?>)$/i}};WMDEditor.prototype={getPanels:function(){return{buttonBar:typeof this.options.button_bar=="string"?document.getElementById(this.options.button_bar):this.options.button_bar,preview:typeof this.options.preview=="string"?document.getElementById(this.options.preview):this.options.preview,output:typeof this.options.output=="string"?document.getElementById(this.options.output): this.options.output,input:typeof this.options.input=="string"?document.getElementById(this.options.input):this.options.input}},startEditor:function(){this.panels=this.getPanels();this.previewMgr=new PreviewManager(this);edit=new this.editor(this.previewMgr.refresh);this.previewMgr.refresh(true)}};var util={isVisible:function(elem){return elem.offsetWidth>0||elem.offsetHeight>0},addEvent:function(elem,event,listener){if(elem.attachEvent)elem.attachEvent("on"+event,listener);else elem.addEventListener(event, listener,false)},removeEvent:function(elem,event,listener){if(elem.detachEvent)elem.detachEvent("on"+event,listener);else elem.removeEventListener(event,listener,false)},fixEolChars:function(text){text=text.replace(/\r\n/g,"\n");text=text.replace(/\r/g,"\n");return text},extendRegExp:function(regex,pre,post){if(pre===null||pre===undefined)pre="";if(post===null||post===undefined)post="";var pattern=regex.toString();var flags="";var result=pattern.match(/\/([gim]*)$/);if(result===null)flags=result[0]; else flags="";pattern=pattern.replace(/(^\/|\/[gim]*$)/g,"");pattern=pre+pattern+post;return new RegExp(pattern,flags)},createImage:function(img){var imgPath=imageDirectory+img;var elem=document.createElement("img");elem.className="wmd-button";elem.src=imgPath;return elem},prompt:function(text,defaultInputText,makeLinkMarkdown,uploadImage,defaultSelectionText,is_codedialog){var dialog;var background;var input;if(defaultInputText===undefined)defaultInputText="";var selecttext=defaultSelectionText!= ""?defaultSelectionText:"";var checkEscape=function(key){var code=key.charCode||key.keyCode;if(code===27)close(true)};var checkurl=function(linktitle,linkurl){var linkurl=$.trim(linkurl);if($.trim(linktitle)==""){errortitle_msg.style.display="inline";return false}else if(linkurl==""||linkurl=="http://"){errorurl_msg.style.display="inline";return false}else{var matchurl=new RegExp("((?:http|https|ftp|mms|rtsp)://(&(?=amp;)|[A-Za-z0-9./=?%_~@#:;+-])+)","ig");linkurl=linkurl.replace("&nbsp;","");if(!matchurl.test(linkurl)){var matchurl_other= /^(www)\..+/i;var matchurl_otherone=/^([A-Za-z0-9]+)\.(.+)$/i;if(matchurl_other.test(linkurl)){linkurl_other="http://"+linkurl;return true}else if(matchurl_otherone.test(linkurl)){linkurl_other="http://"+linkurl;return true}else if(!matchurl_otherone.test(linkurl)){errorurl_msg.style.display="inline";return false}}return true}};var close=function(isCancel){util.removeEvent(document.body,"keydown",checkEscape);var text=input.value;if(typeof linkurl_other=="undefined"||linkurl_other=="");else text= linkurl_other;if(isCancel)text=null;else{text=text.replace("http://http://","http://");text=text.replace("http://https://","https://");text=text.replace("http://ftp://","ftp://")}dialog.parentNode.removeChild(dialog);background.parentNode.removeChild(background);makeLinkMarkdown(text);return false};var createBackground=function(){background=document.createElement("div");background.className="wmd-prompt-background";style=background.style;style.position="absolute";style.top="0";style.zIndex="10000"; if(browser.isKonqueror)style.backgroundColor="transparent";else if(browser.isIE)style.filter="alpha(opacity=50)";else style.opacity="0.5";var pageSize=position.getPageSize();style.height=pageSize[1]+"px";style.left="0";style.width=document.body.scrollWidth+"px";document.body.appendChild(background)};var createDialog=function(){dialog=document.createElement("div");dialog.className="wmd-prompt-dialog";dialog.style.padding="10px;";dialog.style.position="absolute";dialog.style.width="500px";dialog.style.zIndex= "10001";var question=document.createElement("div");question.innerHTML=text;question.style.padding="5px";question.style.zoom="1";question.style.overflow="hidden";dialog.appendChild(question);var dialog_body=document.createElement("div");dialog_body.className="prompt-dialog-text";dialog_body.style.textAlign="left";dialog_body.innerHTML='<p style="margin:10px;">\u4f60\u4e5f\u53ef\u4ee5\u6dfb\u52a0\u4e00\u4e2a\u6807\u9898, \u5c06\u663e\u793a\u4e3a\u4e00\u4e2a\u63d0\u793a. \u4f8b\u5b50\uff1a<br /> http://www.dewen.org "\u53ef\u9009\u6807\u9898"</p>'; var form=document.createElement("form");form.onsubmit=function(){var checkstatus=checkurl($.trim(title_url.value),$.trim(input.value));if(checkstatus)return close(false)};form.className="imgbox_upload";style=form.style;style.padding="0";style.margin="0";style.cssFloat="left";style.width="100%";style.textAlign="center";style.position="relative";question.appendChild(form);form.appendChild(dialog_body);var div1=document.createElement("div");div1.style.padding="5px";div1.style.textAlign="left";form.appendChild(div1); var span1=document.createElement("span");span1.innerHTML="\u6807\u9898\u540d\u79f0:";span1.style.padding="10px";span1.style.paddingLeft="35px";span1.style.width="30px";div1.appendChild(span1);title_url=document.createElement("input");title_url.type="text";title_url.value=selecttext;if(selecttext!="")title_url.readOnly=true;title_url.className="dialog-input";title_url.style.width="300px";div1.appendChild(title_url);title_url.onfocus=function(){errorurl_msg.style.display="none";errortitle_msg.style.display= "none"};errortitle_msg=document.createElement("span");errortitle_msg.innerHTML="\u6807\u9898\u4e0d\u4e3a\u7a7a";errortitle_msg.style.width="40px";errortitle_msg.style.display="none";errortitle_msg.style.margin="10px";errortitle_msg.style.color="#FF0000";div1.appendChild(errortitle_msg);var div2=document.createElement("div");div2.style.margin="2px";div2.style.padding="5px";div2.style.textAlign="left";form.appendChild(div2);var span2=document.createElement("span");span2.innerHTML="\u7f51\u5740:";span2.style.padding= "10px";span2.style.paddingLeft="55px";span2.style.width="30px";div2.appendChild(span2);input=document.createElement("input");input.type="text";input.value=defaultInputText;input.className="dialog-input";input.style.width="300px";div2.appendChild(input);input.onfocus=function(){errortitle_msg.style.display="none";errorurl_msg.style.display="none"};errorurl_msg=document.createElement("span");errorurl_msg.style.width="40px";errorurl_msg.style.margin="5px";errorurl_msg.style.color="#FF0000";errorurl_msg.innerHTML= "\u7f51\u5740\u4e0d\u5408\u6cd5";errorurl_msg.style.display="none";div2.appendChild(errorurl_msg);var okButton=document.createElement("input");okButton.type="button";okButton.onclick=function(){var checkstatus=checkurl($.trim(title_url.value),$.trim(input.value));if(checkstatus)return close(false)};okButton.value="\u786e \u5b9a";style=okButton.style;okButton.className="re";style.margin="10px";style.display="inline";style.width="4em";style.border="1px solid #19558D";var cancelButton=document.createElement("input"); cancelButton.type="button";cancelButton.className="dialog-button special_btn";cancelButton.onclick=function(){return close(true)};cancelButton.value="\u53d6\u6d88";style=cancelButton.style;style.margin="10px";style.display="inline";style.width="4em";style.background="none";style.border="none";if(/mac/.test(nav.platform.toLowerCase())){form.appendChild(cancelButton);form.appendChild(okButton)}else{form.appendChild(okButton);form.appendChild(cancelButton)}util.addEvent(document.body,"keydown",checkEscape); var winSize=position.getWinSize();dialog.style.left=winSize[0]-460+"px";dialog.style.top=winSize[1]-10+"px";dialog.style.display="block";document.body.appendChild(dialog);window.document.onkeydown=submitdialog};var submitdialog=function(evt){evt=window.event||evt;if(evt.keyCode==13){var checkstatus=checkurl($.trim(title_url.value),$.trim(input.value));if(checkstatus)return close(false)}};var createUploadImageDialog=function(){dialog=document.createElement("div");dialog.className="wmd-prompt-dialog"; dialog.style.padding="10px;";dialog.style.position="absolute";dialog.style.width="400px";dialog.style.zIndex="10001";dialog.innerHTML="<p style='padding:7px 0 0 5px; text-align:left;'><b>\u63d2\u5165\u4e00\u5f20\u56fe\u7247</b></p><div class='imgbox_upload'><p style='padding-top: 10px; height:35px; text-align:center;'><a href='javascript:void(0)' class='wmd-mini-button selected' id='upload-image-button'>\u4ece\u672c\u5730\u4e0a\u4f20</a><a href='javascript:void(0)' class='wmd-mini-button' id='upload-url-button'>\u4eceweb\u83b7\u53d6</a></p><iframe id='upload-iframe' style='display:none;' src='about:blank' name='upload-iframe'></iframe><form target='upload-iframe' id='upload-image-form' action='/ajax/wmd_upload' method='post' enctype='multipart/form-data'><div style='position: relative' id='upload-file-input'> <input type='file' name='upload_image' id='filename-input' value='browse' style='border:0; font-size:18px; position:relative; text-align:right; -moz-opacity:0; filter:alpha(opacity: 0); opacity: 0; z-index: 2; width:280px; height:28px;margin-left:64px;'><div style='position: absolute; top:0px; left:0px; z-index: 1;'> <input type='input' name='shadow-filename' value='' id='shadow-filename' style='width: 280px; margin-left:14px;'> <input type='button' name='choose-file' id='choose-file' value='\u6d4f\u89c8 ...' style='width: 4em; margin-left: 5px;height:28px;'> </div></div><div id='upload-url-input' style='display:none; text-align:center;'> <input type='input' name='upload-url' value='http://' style='width: 280px;'></div><p id='upload-message' style='padding-top: 4px; margin:0; line-height: 16px;'></p><div class='ac_loading' id='image-upload-progress' style='display:none;'>\u4e0a\u4f20\u4e2d ...</div><div style='padding:10px 0 20px; text-align:center;'><input type='button' value='\u786e \u8ba4' style='display:inline-block; width: 4em; margin:0 10px;border:1px solid #19558D;' id='ok-dialog-button' class='re' /><input type='button' value='\u53d6 \u6d88' id='close-dialog-button' style='display:inline-block; border:none;'></div></form></div>"; util.addEvent(document.body,"keydown",checkEscape);var winSize=position.getWinSize();dialog.style.left=winSize[0]-200+"px";dialog.style.top=winSize[1]-150+"px";dialog.style.display="block";document.body.appendChild(dialog);var tabname="upload";input=document.getElementsByName("shadow-filename")[0];$("#filename-input").change(function(){$("#shadow-filename").val("uploading...");$("#image-upload-progress").show();$("#upload-image-form").submit()});$("#upload-image-button").unbind("click").click(function(){tabname= "upload";$(".wmd-mini-button").removeClass("selected");$(this).addClass("selected");$("#upload-file-input").show();$("#upload-url-input").hide();input=document.getElementsByName("shadow-filename")[0]});$("#upload-url-button").unbind("click").click(function(){tabname="web";$(".wmd-mini-button").removeClass("selected");$(this).addClass("selected");$("#upload-file-input").hide();$("#upload-url-input").show();input=document.getElementsByName("upload-url")[0]});$("#ok-dialog-button").unbind("click").click(function(){if(tabname== "upload")if($.trim(input.value)!=""&&input.value!="uploading...")input.value=upload_path+input.value;else input.value="http://";else if(tabname=="web"){var reg=/^(http|ftp|https):\/\/.*\.(png|gif|jpg|jpeg|bmp)$/i;if(reg.test($.trim(input.value)))$.ajax({type:"POST",url:"/ajax/wmd_upload",data:"image_url="+encodeURIComponent($.trim(input.value))+"&ajax=1&round="+Math.random(),success:function(msg){var result=$.parseJSON(msg);if(result.success==1);else;}})}return close(false)});$("#close-dialog-button").unbind("click").click(function(){return close(true)})}; var closecode=function(content,lang){$(".wmd-prompt-dialog").remove();$(".wmd-prompt-background").remove();util.removeEvent(document.body,"keydown",checkEscape);makeLinkMarkdown(content,lang);return false};function move_achor(chunkbofore_str){var obj=document.getElementById("codearea");if(obj.createTextRange){var range=obj.createTextRange();range.moveStart("character",chunkbofore_str.length);range.collapse(true);range.select()}else{obj.setSelectionRange(obj.value.length,chunkbofore_str.length);obj.focus()}} var create_codedialog=function(){$(".answertips").fadeIn(300);dialog=document.createElement("div");dialog.className="wmd-prompt-dialog";dialog.style.padding="10px;";dialog.style.position="absolute";dialog.style.width="800px";dialog.style.zIndex="10001";var dialog_toolbar=document.createElement("div");dialog.appendChild(dialog_toolbar);var _table=document.createElement("table");_table.setAttribute("width","99%");var _tr=_table.insertRow(0);var _td1=_tr.insertCell(0);_td1.style.padding="5px";_td1.width= "79%";if($.trim(defaultSelectionText))_td1.innerHTML="<b>\u7f16\u8f91\u4ee3\u7801</b>";else _td1.innerHTML="<b>\u63d2\u5165\u4ee3\u7801</b>";_tr.appendChild(_td1);var selectlang="";var trimcode="";var reg=/^(<coding)\-(\d+)\s*lang="(as|bsh|c|cpp|cs|csh|delphi|htm|html|java|js|m|mxml|perl|php|py|rb|sh|xhtml|xsl|other)"\s*>([\s\S]+)(<\/coding>)$/i;if(reg.test($.trim(defaultSelectionText))&&$.trim(defaultSelectionText)!=""){var arr=reg.exec($.trim(defaultSelectionText));selectlang=arr[3];trimcode=arr[4].replace(/^([\r\n]+)|([\r\n]+$)/ig, "")}var language_arr=["ActionScript","Base Shell","C","C++","Css","C#","Delphi","Htm","Html","Java","Javascript","Matlab","Mxml","Perl","Php","Python","Ruby","Shell","Xhtml","Xslt"];language_arr.push("Other");var lang_arr_option=["as","bsh","c","cpp","cs","csh","delphi","htm","html","java","js","m","mxml","perl","php","py","rb","sh","xhtml","xsl"];lang_arr_option.push("other");var selectObj=document.createElement("select");selectObj.id="language";selectObj.style.fontSize="12px";var selectstyle=selectObj.style; for(var k=0;k<language_arr.length;k++){var options=new Option(language_arr[k],lang_arr_option[k]);if(selectlang==lang_arr_option[k])options.selected=true;selectObj.options.add(options)}var _td2=_tr.insertCell(1);_td2.style.textAlign="right";var spanobj=document.createElement("span");spanobj.innerHTML="\u9009\u62e9\u8bed\u8a00\uff1a";spanobj.style.fontSize="12px";_td2.appendChild(spanobj);_td2.appendChild(selectObj);_tr.appendChild(_td2);dialog_toolbar.appendChild(_table);var question=document.createElement("div"); question.innerHTML=text;question.style.padding="5px";question.style.zoom="1";question.style.overflow="hidden";dialog.appendChild(question);var dialog_body=document.createElement("div");dialog_body.className="prompt-dialog-text";var form=document.createElement("form");form.className="imgbox_upload";style=form.style;style.padding="0";style.margin="0";style.cssFloat="left";style.width="100%";style.textAlign="center";style.position="relative";question.appendChild(form);form.appendChild(dialog_body);var div1= document.createElement("div");div1.style.padding="5px";form.appendChild(div1);var textarea_obj=document.createElement("textarea");textarea_obj.id="codearea";textarea_obj.value=trimcode.length?trimcode:defaultSelectionText;textarea_obj.rows=20;textarea_obj.cols=108;div1.appendChild(textarea_obj);var okButton=document.createElement("input");okButton.type="button";okButton.onclick=function(){var content=$("#codearea").val().replace(/^([\r\n]+)|([\r\n]+)$/ig,"");var lang=$("#language").find("option:selected").val(); return closecode(content,lang)};okButton.value="\u786e \u5b9a";style=okButton.style;okButton.className="re";style.margin="10px";style.display="inline";style.width="4em";style.cursor="pointer";style.border="1px solid #19558D";var cancelButton=document.createElement("input");cancelButton.type="button";cancelButton.className="dialog-button special_btn";cancelButton.onclick=function(){return closecode("","")};cancelButton.value="\u53d6\u6d88";style=cancelButton.style;style.margin="10px";style.display= "inline";style.width="4em";style.background="none";style.border="none";if(/mac/.test(nav.platform.toLowerCase())){form.appendChild(cancelButton);form.appendChild(okButton)}else{form.appendChild(okButton);form.appendChild(cancelButton)}util.addEvent(document.body,"keydown",checkEscape);var winSize=position.getWinSize();dialog.style.left=winSize[0]-470+"px";dialog.style.top=winSize[1]-165+"px";dialog.style.display="block";document.body.appendChild(dialog)};createBackground();window.setTimeout(function(){if(is_codedialog){create_codedialog(); if($.trim(defaultSelectionText)!=""){var reg1=/^(<coding)\-(\d+)\s*lang=\"(as|bsh|cpp|cs|csh|delphi|htm|html|java|js|m|mxml|perl|php|py|rb|sh|xhtml|xsl|other)\"\s*>([\s\S]+)(<\/coding>)$/i;if(reg1.test($.trim(defaultSelectionText))){var tmp_arr=reg1.exec($.trim(defaultSelectionText));move_achor(defaultSelectionText.replace(/(^[\r\n]+)|([\r\n\s]+$)/ig,""))}else move_achor(defaultSelectionText)}else $("#codearea").focus()}else{if(uploadImage===true)createUploadImageDialog();else createDialog();var defTextLen= defaultInputText.length;if(input.selectionStart!==undefined){input.selectionStart=0;input.selectionEnd=defTextLen}else if(input.createTextRange){var range=input.createTextRange();range.collapse(false);range.moveStart("character",-defTextLen);range.moveEnd("character",defTextLen);range.select()}input.focus()}},0)},suggest:function(makeLinkMarkdown,c,input_id,is_click){var checkEscape=function(key){var code=key.charCode||key.keyCode;if(code===27)close(true)};var close=function(isCancel){util.removeEvent(document.body, "keydown",checkEscape);if(isCancel){text=null;link=null}else{link=link.replace("http://http://","http://");link=link.replace("http://https://","https://");link=link.replace("http://ftp://","ftp://")}makeLinkMarkdown({text:text,link:link});return false};var init_mouse=function(){$("#qlink_suggest dd").unbind("mousedown").mousedown(function(e){$("#qlink_input").val($(this).attr("title"));$("#qlink_url").val($(this).attr("url"));close(false)})};var reg=/\d+/i;var timestamp=reg.exec(input_id);if(timestamp== null)timestamp=12;if(!$("#qlink_box_"+timestamp).length){var suggestBox=$('<div id="qlink_box_'+timestamp+'" class="qlink_box"><div style="margin-left:2px;color:#333;"><span class="hide_act">\u5173\u95ed</span>\u94fe\u63a5\u5230\u95ee\u9898, \u8bdd\u9898\u6216\u4eba</div><input id="qlink_input_'+timestamp+'" type="text" /></div>');var b=$("<em>...</em>");a=$("#"+input_id);var tt=document.getElementById(input_id);var tscroll=false;var d=a.offset(),e={};var widthHider=a.width();if(tt.scrollHeight>tt.clientHeight){tscroll= true;widthHider-=24}var mentionflag=$("<div id='tp_hidden_"+timestamp+"'></div>").css({position:"absolute",left:-99999,width:widthHider+"px",height:a.height()+"px",padding:"0 3px",font:"13px/18px Consolas,Menlo,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New,monospace,serif","word-wrap":"break-word",border:"1px solid #DDD",overflow:"hidden",top:"0","word-break":"break-all"});mentionflag.appendTo("body");var text=util.fixEolChars(c.before);text=text.replace(/[<>]/g, function(c){return{"<":"&lt;",">":"&gt;"}[c]});text=text.replace(/&/ig,"&amp;");text=text.replace(/\n/g,"<br>");text=text.replace(/ /g,"<span>&nbsp;&nbsp;&nbsp;&nbsp;</span>");text=text.replace(/ /g,"<span>&nbsp;&nbsp;&nbsp;</span>");text=text.replace(/ /g,"<span>&nbsp;&nbsp;</span>");text=text.replace(/ /g,"<span> </span>");mentionflag.html(text).append(b);e=b.position();var left=e.left+d.left+2;var top=tscroll==true?e.top+d.top+12-tt.scrollTop:e.top+d.top+12;suggestBox.appendTo("body");suggestBox.css({top:top+ "px",left:left+"px"}).show();$("#qlink_input").focus()}util.addEvent(document.body,"keydown",checkEscape);var suggest=setup_suggest({id:"qlink_input_"+timestamp,filter:"",func:function(obj){makeLinkMarkdown(obj);$("#qlink_box_"+timestamp).remove();$("#tp_hidden_"+timestamp).remove();suggest.row_id.remove();suggest.row_url.remove();suggest.row_type.remove();suggest.row_text.remove();$('.suggest_box[rel="qlink_input_'+timestamp+'"]').remove()},link:true,rs:true});$("#qlink_input_"+timestamp).focus(); function move_linkachor(chunkbofore_str){var obj=document.getElementById(input_id);if(obj.createTextRange){var range=obj.createTextRange();range.moveStart("character",chunkbofore_str.length);range.collapse(true);range.select()}else{obj.setSelectionRange(obj.value.length,chunkbofore_str.length);obj.focus()}}$("#qlink_box_"+timestamp).find(".hide_act").unbind("click").click(function(){if(c.before.substr(c.before.length-1,1)=="@"&&is_click){var lastindex=c.before.lastIndexOf("@");c.before=c.before.substring(0, lastindex)}var trim_suggest=c.before+c.selection+c.after;$("#"+input_id).val(trim_suggest);$("#qlink_box_"+timestamp).remove();$("#tp_hidden_"+timestamp).remove();suggest.row_id.remove();suggest.row_url.remove();suggest.row_type.remove();suggest.row_text.remove();$('.suggest_box[rel="qlink_input_'+timestamp+'"]').remove();move_linkachor(c.before);suggest.close(0)})},extend:function(){function _update(a,b){for(var k in b)a[k]=b[k];return a}var d={};for(var i=0;i<arguments.length;i++)_update(d,arguments[i]); return d}};var position={getTop:function(elem,isInner){var result=elem.offsetTop;if(!isInner)while(elem=elem.offsetParent)result+=elem.offsetTop;return result},getHeight:function(elem){return elem.offsetHeight||elem.scrollHeight},getWidth:function(elem){return elem.offsetWidth||elem.scrollWidth},getPageSize:function(){var scrollWidth,scrollHeight;var innerWidth,innerHeight;if(self.innerHeight&&self.scrollMaxY){scrollWidth=document.body.scrollWidth;scrollHeight=self.innerHeight+self.scrollMaxY}else if(document.body.scrollHeight> document.body.offsetHeight){scrollWidth=document.body.scrollWidth;scrollHeight=document.body.scrollHeight}else{scrollWidth=document.body.offsetWidth;scrollHeight=document.body.offsetHeight}if(self.innerHeight){innerWidth=self.innerWidth;innerHeight=self.innerHeight}else if(document.documentElement&&document.documentElement.clientHeight){innerWidth=document.documentElement.clientWidth;innerHeight=document.documentElement.clientHeight}else if(document.body){innerWidth=document.body.clientWidth;innerHeight= document.body.clientHeight}var maxWidth=Math.max(scrollWidth,innerWidth);var maxHeight=Math.max(scrollHeight,innerHeight);return[maxWidth,maxHeight,innerWidth,innerHeight]},getWinSize:function(){var left=0,top=0;try{top=window.innerHeight/2+pageYOffset;left=window.innerWidth/2+pageXOffset}catch(e){var _docElement=document.documentElement;if(!document.body.scrollTop){top=_docElement.offsetHeight/2+_docElement.scrollTop;left=_docElement.offsetWidth/2+_docElement.scrollLeft}else{top=_docElement.offsetHeight/ 2+document.body.scrollTop;left=_docElement.offsetWidth/2+document.body.scrollLeft}}return[left,top]}};var TextareaState=function(textarea,wmd){var stateObj=this;var inputArea=textarea;this.init=function(){if(!util.isVisible(inputArea))return;this.setInputAreaSelectionStartEnd();this.scrollTop=inputArea.scrollTop;if(!this.text&&inputArea.selectionStart||inputArea.selectionStart===0)this.text=inputArea.value};this.setInputAreaSelection=function(){if(!util.isVisible(inputArea))return;if(inputArea.selectionStart!== undefined&&!browser.isOpera){inputArea.focus();inputArea.selectionStart=stateObj.start;inputArea.selectionEnd=stateObj.end;inputArea.scrollTop=stateObj.scrollTop}else if(document.selection){if(typeof document.activeElement!="unknown"&&document.activeElement&&document.activeElement!==inputArea)return;inputArea.focus();var range=inputArea.createTextRange();range.moveStart("character",-inputArea.value.length);range.moveEnd("character",-inputArea.value.length);range.moveEnd("character",stateObj.end); range.moveStart("character",stateObj.start);range.select()}};this.setInputAreaSelectionStartEnd=function(){if(inputArea.selectionStart||inputArea.selectionStart===0){stateObj.start=inputArea.selectionStart;stateObj.end=inputArea.selectionEnd}else if(document.selection){stateObj.text=util.fixEolChars(inputArea.value);var range;if(wmd.ieRetardedClick&&wmd.ieCachedRange){range=wmd.ieCachedRange;wmd.ieRetardedClick=false}else range=document.selection.createRange();var fixedRange=util.fixEolChars(range.text); var marker="\u0007";var markedRange=marker+fixedRange+marker;range.text=markedRange;var inputText=util.fixEolChars(inputArea.value);range.moveStart("character",-markedRange.length);range.text=fixedRange;stateObj.start=inputText.indexOf(marker);stateObj.end=inputText.lastIndexOf(marker)-marker.length;var len=stateObj.text.length-util.fixEolChars(inputArea.value).length;if(len){range.moveStart("character",-fixedRange.length);while(len--){fixedRange+="\n";stateObj.end+=1}range.text=fixedRange}this.setInputAreaSelection()}}; this.restore=function(){if(stateObj.text!=undefined&&stateObj.text!=inputArea.value)inputArea.value=stateObj.text;this.setInputAreaSelection();inputArea.scrollTop=stateObj.scrollTop};this.getChunks=function(){var chunk=new Chunks;chunk.before=util.fixEolChars(stateObj.text.substring(0,stateObj.start));chunk.startTag="";chunk.selection=util.fixEolChars(stateObj.text.substring(stateObj.start,stateObj.end));chunk.endTag="";chunk.after=util.fixEolChars(stateObj.text.substring(stateObj.end));chunk.scrollTop= stateObj.scrollTop;chunk.lastChar=util.fixEolChars(stateObj.text.substring(stateObj.end-1,stateObj.end));return chunk};this.setChunks=function(chunk){chunk.before=chunk.before+chunk.startTag;chunk.after=chunk.endTag+chunk.after;if(browser.isOpera){chunk.before=chunk.before.replace(/\n/g,"\r\n");chunk.selection=chunk.selection.replace(/\n/g,"\r\n");chunk.after=chunk.after.replace(/\n/g,"\r\n")}this.start=chunk.before.length;this.end=chunk.before.length+chunk.selection.length;this.text=chunk.before+ chunk.selection+chunk.after;this.scrollTop=chunk.scrollTop};this.init()};var Chunks=function(){};Chunks.prototype.findTags=function(startRegex,endRegex){var chunkObj=this;var regex;if(startRegex){regex=util.extendRegExp(startRegex,"","$");this.before=this.before.replace(regex,function(match){chunkObj.startTag=chunkObj.startTag+match;return""});regex=util.extendRegExp(startRegex,"^","");this.selection=this.selection.replace(regex,function(match){chunkObj.startTag=chunkObj.startTag+match;return""})}if(endRegex){regex= util.extendRegExp(endRegex,"","$");this.selection=this.selection.replace(regex,function(match){chunkObj.endTag=match+chunkObj.endTag;return""});regex=util.extendRegExp(endRegex,"^","");this.after=this.after.replace(regex,function(match){chunkObj.endTag=match+chunkObj.endTag;return""})}};Chunks.prototype.trimWhitespace=function(remove){this.selection=this.selection.replace(/^(\s*)/,"");if(!remove)this.before+=re.$1;this.selection=this.selection.replace(/(\s*)$/,"");if(!remove)this.after=re.$1+this.after}; Chunks.prototype.addBlankLines=function(nLinesBefore,nLinesAfter,findExtraNewlines){if(nLinesBefore===undefined)nLinesBefore=1;if(nLinesAfter===undefined)nLinesAfter=1;nLinesBefore++;nLinesAfter++;var regexText;var replacementText;var match=/(^\n*)/.exec(this.selection);this.selection=this.selection.replace(/(^\n*)/,"");this.startTag=this.startTag+(match?match[1]:"");match=/(\n*$)/.exec(this.selection);this.selection=this.selection.replace(/(\n*$)/,"");this.endTag=this.endTag+(match?match[1]:""); match=/(^\n*)/.exec(this.startTag);this.startTag=this.startTag.replace(/(^\n*)/,"");this.before=this.before+(match?match[1]:"");match=/(\n*$)/.exec(this.endTag);this.endTag=this.endTag.replace(/(\n*$)/,"");this.after=this.after+(match?match[1]:"");if(this.before){regexText=replacementText="";while(nLinesBefore--){regexText+="\\n?";replacementText+="\n"}if(findExtraNewlines)regexText="\\n*";this.before=this.before.replace(new re(regexText+"$",""),replacementText)}if(this.after){regexText=replacementText= "";while(nLinesAfter--){regexText+="\\n?";replacementText+="\n"}if(findExtraNewlines)regexText="\\n*";this.after=this.after.replace(new re(regexText,""),replacementText)}};var InputPoller=function(textarea,callback,interval){var pollerObj=this;var inputArea=textarea;var lastStart;var lastEnd;var markdown;var killHandle;this.tick=function(){if(!util.isVisible(inputArea))return;if(inputArea.selectionStart||inputArea.selectionStart===0){var start=inputArea.selectionStart;var end=inputArea.selectionEnd; if(start!=lastStart||end!=lastEnd){lastStart=start;lastEnd=end;if(markdown!=inputArea.value){markdown=inputArea.value;return true}}}return false};var doTickCallback=function(){if(!util.isVisible(inputArea))return;if(pollerObj.tick())callback()};var assignInterval=function(){killHandle=window.setInterval(doTickCallback,interval)};this.destroy=function(){window.clearInterval(killHandle)};assignInterval()};var PreviewManager=function(wmd){var managerObj=this;var converter;var poller;var timeout;var elapsedTime; var oldInputText;var htmlOut;var maxDelay=3E3;var startType="delayed";var setupEvents=function(inputElem,listener){util.addEvent(inputElem,"input",listener);inputElem.onpaste=listener;inputElem.ondrop=listener;util.addEvent(inputElem,"keypress",listener);util.addEvent(inputElem,"keydown",listener);poller=new InputPoller(wmd.panels.input,listener,wmd.options.previewPollInterval)};var getDocScrollTop=function(){var result=0;if(window.innerHeight)result=window.pageYOffset;else if(document.documentElement&& document.documentElement.scrollTop)result=document.documentElement.scrollTop;else if(document.body)result=document.body.scrollTop;return result};var makePreviewHtml=function(){if(!wmd.panels.preview&&!wmd.panels.output)return;var text=wmd.panels.input.value;if(text&&text==oldInputText)return;else oldInputText=text;var prevTime=(new Date).getTime();if(!converter&&wmd.showdown)converter=new wmd.showdown.converter;if(converter)text=converter.makeHtml(text);var currTime=(new Date).getTime();elapsedTime= currTime-prevTime;pushPreviewHtml(text);htmlOut=text};var applyTimeout=function(){if(timeout){window.clearTimeout(timeout);timeout=undefined}if(startType!=="manual"){var delay=0;if(startType==="delayed")delay=elapsedTime;if(delay>maxDelay)delay=maxDelay;timeout=window.setTimeout(makePreviewHtml,delay)}};var getScaleFactor=function(panel){if(panel.scrollHeight<=panel.clientHeight)return 1;return panel.scrollTop/(panel.scrollHeight-panel.clientHeight)};var setPanelScrollTops=function(){if(wmd.panels.preview)wmd.panels.preview.scrollTop= (wmd.panels.preview.scrollHeight-wmd.panels.preview.clientHeight)*getScaleFactor(wmd.panels.preview);if(wmd.panels.output)wmd.panels.output.scrollTop=(wmd.panels.output.scrollHeight-wmd.panels.output.clientHeight)*getScaleFactor(wmd.panels.output)};this.refresh=function(requiresRefresh){if(requiresRefresh){oldInputText="";makePreviewHtml()}else applyTimeout()};this.processingTime=function(){return elapsedTime};this.output=function(){return htmlOut};this.setUpdateMode=function(mode){startType=mode; managerObj.refresh()};var isFirstTimeFilled=true;var pushPreviewHtml=function(text){var emptyTop=position.getTop(wmd.panels.input)-getDocScrollTop();if(wmd.panels.output)if(wmd.panels.output.value!==undefined)wmd.panels.output.value=text;else{var newText=text.replace(/&/g,"&amp;");newText=newText.replace(/</g,"&lt;");wmd.panels.output.innerHTML="<pre><code>"+newText+"</code></pre>"}if(wmd.panels.preview){if(wmd.options.tagFilter.enabled){var reg=/^(<\/?(b|blockquote|script|noscript|del|dd|dl|dt|em|h1|h2|h3|i|kbd|li|ol|p|pre|s|sup|sub|strong|strike|ul)>|<(br|hr)\s?\/?>)$/i; text=text.replace(/<[^<>]*>/gi,function(tag){return tag.match(reg)||tag.match(wmd.options.tagFilter.patternLink)||tag.match(wmd.options.tagFilter.patternImage)||tag.match(wmd.options.tagFilter.patternCode)?tag:""})}text=text.replace(/(.*)<coding-\d+\s*lang="(as|bsh|c|cpp|cs|csh|delphi|htm|html|java|js|m|mxml|perl|php|py|rb|sh|xhtml|xml|xsh|other)">([^\r]*?)<\/coding>(.*)/gi,function(whomematch,$1,$2,$3,$4){return $1+'<pre class="noscroll"><code class="prettyprint">'+prettyPrintOne($3)+"</code></pre>"+ $4});text=text.replace(/\@([^\(\@\[\{]+?)(\[|\{|\()(\d+)(\]|\}|\))/g,function(whole,title,type,id){if(type=="(")return'<a href="/people/'+id+'">@'+title+"</a>";else if(type=="[")return'<a href="/topic/'+id+'">@'+title+"</a>";else if(type=="{")return'<a href="/q/'+id+'">@'+title+"</a>"});if($.browser.msie)text=text.replace("<p>","").replace("</p>","<br/>").replace("<p/>","");wmd.panels.preview.innerHTML=text;$(".noscroll").css("max-height","none")}setPanelScrollTops();if(isFirstTimeFilled){isFirstTimeFilled= false;return}var fullTop=position.getTop(wmd.panels.input)-getDocScrollTop();if(browser.isIE)window.setTimeout(function(){window.scrollBy(0,fullTop-emptyTop)},0);else window.scrollBy(0,fullTop-emptyTop)};var init=function(){setupEvents(wmd.panels.input,applyTimeout);makePreviewHtml();if(wmd.panels.preview)wmd.panels.preview.scrollTop=0;if(wmd.panels.output)wmd.panels.output.scrollTop=0};this.destroy=function(){if(poller)poller.destroy()};init()};var UndoManager=function(wmd,textarea,pastePollInterval, callback){var undoObj=this;var undoStack=[];var stackPtr=0;var mode="none";var lastState;var poller;var timer;var inputStateObj;var setMode=function(newMode,noSave){if(mode!=newMode){mode=newMode;if(!noSave)saveState()}if(!browser.isIE||mode!="moving")timer=window.setTimeout(refreshState,1);else inputStateObj=null};var refreshState=function(){inputStateObj=new TextareaState(textarea,wmd);poller.tick();timer=undefined};this.setCommandMode=function(){mode="command";saveState();timer=window.setTimeout(refreshState, 0)};this.canUndo=function(){return stackPtr>1};this.canRedo=function(){if(undoStack[stackPtr+1])return true;return false};this.undo=function(){if(undoObj.canUndo())if(lastState){lastState.restore();lastState=null}else{undoStack[stackPtr]=new TextareaState(textarea,wmd);undoStack[--stackPtr].restore();if(callback)callback()}mode="none";textarea.focus();refreshState()};this.redo=function(){if(undoObj.canRedo()){undoStack[++stackPtr].restore();if(callback)callback()}mode="none";textarea.focus();refreshState()}; var saveState=function(){var currState=inputStateObj||new TextareaState(textarea,wmd);if(!currState)return false;if(mode=="moving"){if(!lastState)lastState=currState;return}if(lastState){if(undoStack[stackPtr-1].text!=lastState.text)undoStack[stackPtr++]=lastState;lastState=null}undoStack[stackPtr++]=currState;undoStack[stackPtr+1]=null;if(callback)callback()};var handleCtrlYZ=function(event){var handled=false;if(event.ctrlKey||event.metaKey){var keyCode=event.charCode||event.keyCode;var keyCodeChar= String.fromCharCode(keyCode);switch(keyCodeChar){case "y":undoObj.redo();handled=true;break;case "z":if(!event.shiftKey)undoObj.undo();else undoObj.redo();handled=true;break}}if(handled){if(event.preventDefault)event.preventDefault();if(window.event)window.event.returnValue=false;return}};var handleModeChange=function(event){if(!event.ctrlKey&&!event.metaKey){var keyCode=event.keyCode;if(keyCode>=33&&keyCode<=40||keyCode>=63232&&keyCode<=63235)setMode("moving");else if(keyCode==8||keyCode==46||keyCode== 127)setMode("deleting");else if(keyCode==13)setMode("newlines");else if(keyCode==27)setMode("escape");else if((keyCode<16||keyCode>20)&&keyCode!=91)setMode("typing")}};var setEventHandlers=function(){util.addEvent(textarea,"keypress",function(event){if((event.ctrlKey||event.metaKey)&&(event.keyCode==89||event.keyCode==90))event.preventDefault()});var handlePaste=function(){if(browser.isIE||inputStateObj&&inputStateObj.text!=textarea.value)if(timer==undefined){mode="paste";saveState();refreshState()}}; poller=new InputPoller(textarea,handlePaste,pastePollInterval);util.addEvent(textarea,"keydown",handleCtrlYZ);util.addEvent(textarea,"keydown",handleModeChange);util.addEvent(textarea,"mousedown",function(){setMode("moving")});textarea.onpaste=handlePaste;textarea.ondrop=handlePaste};var init=function(){setEventHandlers();refreshState();saveState()};this.destroy=function(){if(poller)poller.destroy()};init()};WMDEditor.util=util;WMDEditor.position=position;WMDEditor.TextareaState=TextareaState;WMDEditor.InputPoller= InputPoller;WMDEditor.PreviewManager=PreviewManager;WMDEditor.UndoManager=UndoManager;var doc=window.document;var re=window.RegExp;var nav=window.navigator;function get_browser(){var b={};b.isIE=/msie/.test(nav.userAgent.toLowerCase());b.isIE_5or6=/msie 6/.test(nav.userAgent.toLowerCase())||/msie 5/.test(nav.userAgent.toLowerCase());b.isIE_7plus=b.isIE&&!b.isIE_5or6;b.isOpera=/opera/.test(nav.userAgent.toLowerCase());b.isKonqueror=/konqueror/.test(nav.userAgent.toLowerCase());return b}var browser= get_browser();var wmdBase=function(wmd,wmd_options){wmd.Command={};wmd.Global={};wmd.buttons={};wmd.showdown=window.Showdown;var util=WMDEditor.util;var position=WMDEditor.position;var command=wmd.Command;wmd.ieCachedRange=null;wmd.ieRetardedClick=false;wmd.editor=function(previewRefreshCallback){if(!previewRefreshCallback)previewRefreshCallback=function(){};var inputBox=wmd.panels.input;var offsetHeight=0;var editObj=this;var mainDiv;var mainSpan;var div;var creationHandle;var undoMgr;var doClick= function(button,is_click){if(typeof is_click=="undefined")is_click=true;inputBox.focus();if(button.textOp){if(undoMgr)undoMgr.setCommandMode();var state=new TextareaState(wmd.panels.input,wmd);if(!state)return;var chunks=state.getChunks();var fixupInputArea=function(){inputBox.focus();if(chunks)state.setChunks(chunks);state.restore();previewRefreshCallback()};var useDefaultText=true;var noCleanup=button.textOp(chunks,fixupInputArea,useDefaultText,is_click);if(!noCleanup)fixupInputArea()}if(button.execute)button.execute(editObj)}; var setUndoRedoButtonStates=function(){if(undoMgr){setupButton(wmd.buttons["wmd-undo-button"],undoMgr.canUndo());setupButton(wmd.buttons["wmd-redo-button"],undoMgr.canRedo())}};var setupButton=function(button,isEnabled){var normalYShift="0px";var disabledYShift="-27px";var highlightYShift="-55px";if(isEnabled){button.style.backgroundPosition=button.XShift+" "+normalYShift;button.onmouseover=function(){this.style.backgroundPosition=this.XShift+" "+highlightYShift};button.onmouseout=function(){this.style.backgroundPosition= this.XShift+" "+normalYShift};if(browser.isIE)button.onmousedown=function(){wmd.ieRetardedClick=true;wmd.ieCachedRange=document.selection.createRange()};if(!button.isHelp)if(button.className.indexOf("wmd-switch-button")!=-1)button.onclick=function(){if(this.onmouseout)this.onmouseout();var classarr=["wmd-spacer1","wmd-italic-button","wmd-quote-button","wmd-olist-button","wmd-ulist-button","wmd-heading-button","wmd-undo-button","wmd-redo-button","wmd-help-button"];for(var k in classarr){if($("."+classarr[k]).css("display")== "none")$("."+classarr[k]).css("display","block");else $("."+classarr[k]).css("display","none");if(button.className.indexOf("wmd-switch-button")!=-1)if($(".wmd-quote-button").css("display")=="none")button.title="\u5207\u6362\u5230\u666e\u901a\u6a21\u5f0f";else button.title="\u5207\u6362\u5230\u9ad8\u7ea7\u6a21\u5f0f"}return false};else button.onclick=function(){if(this.onmouseout)this.onmouseout();doClick(this);return false}}else{button.style.backgroundPosition=button.XShift+" "+disabledYShift;button.onmouseover= button.onmouseout=button.onclick=function(){}}};var makeSpritedButtonRow=function(){var buttonBar=typeof wmd_options.button_bar=="string"?document.getElementById(wmd_options.button_bar||"wmd-button-bar"):wmd_options.button_bar;var normalYShift="0px";var disabledYShift="-20px";var highlightYShift="-40px";var buttonRow=document.createElement("ul");buttonRow.className="wmd-button-row";buttonRow=buttonBar.appendChild(buttonRow);var xoffset;function createButton(name,title,textOp){if(name=="wmd-code-button")xoffset= -5;else if(name=="wmd-link-button")xoffset=-48;else if(name=="wmd-switch-button")xoffset=-530;var button=document.createElement("li");wmd.buttons[name]=button;button.className="wmd-button "+name;button.XShift=xoffset+"px";xoffset-=29;if(title)button.title=title;if(textOp)button.textOp=textOp;return button}function addButton(name,title,textOp){var button=createButton(name,title,textOp);if(name!="wmd-undo-button"&&name!="wmd-redo-button")setupButton(button,true);else setupButton(button,false);buttonRow.appendChild(button); return button}function addSpacer(className){var spacer=document.createElement("li");spacer.className="wmd-spacer "+className;buttonRow.appendChild(spacer);return spacer}var insertcodeButton=addButton("wmd-code-button","\u4ee3\u7801",function(chunk,postProcessing,useDefaultText){command.insertCode(chunk,postProcessing)});var linkButton=addButton("wmd-link-button","\u94fe\u63a5 [Ctrl+L]",function(chunk,postProcessing,useDefaultText){return command.doLinkOrImage(chunk,postProcessing,false)});var imageButton= addButton("wmd-image-button","\u56fe\u7247 [Ctrl+G]",function(chunk,postProcessing,useDefaultText){return command.doLinkOrImage(chunk,postProcessing,true)});var boldButton=addButton("wmd-bold-button","\u7c97\u4f53 [Ctrl+B]",command.doBold);var suggestButton=addButton("wmd-at-button","Shift+@",function(chunk,postProcessing,useDefaultText,is_click){return command.doSuggest(chunk,postProcessing,false,wmd_options.input,is_click)});var spacer1=addSpacer("wmd-spacer1");var olistButton=addButton("wmd-olist-button", "\u6570\u5b57\u5217\u8868 [Ctrl+O]",function(chunk,postProcessing,useDefaultText){command.doList(chunk,postProcessing,true,useDefaultText)});var ulistButton=addButton("wmd-ulist-button","\u5217\u8868 [Ctrl+U]",function(chunk,postProcessing,useDefaultText){command.doList(chunk,postProcessing,false,useDefaultText)});var headingButton=addButton("wmd-heading-button","\u6807\u9898 [Ctrl+H]",command.doHeading);var italicButton=addButton("wmd-italic-button","\u659c\u4f53 [Ctrl+I]",command.doItalic);var quoteButton= addButton("wmd-quote-button","\u5f15\u7528 [Ctrl+Q]",command.doBlockquote);var undoButton=addButton("wmd-undo-button","\u64a4\u9500 [Ctrl+Z]");undoButton.execute=function(manager){manager.undo()};var redo_title=null;var redoButton=addButton("wmd-redo-button","\u91cd\u505a [Ctrl+Y]");if(/win/.test(nav.platform.toLowerCase()))redoButton.title="\u91cd\u505a [Ctrl+Y]";else redoButton.title="\u91cd\u505a [Ctrl+Shift+Z]";redoButton.execute=function(manager){manager.redo()};var helpButton=createButton("wmd-help-button"); helpButton.isHelp=true;setupButton(helpButton,true);buttonRow.appendChild(helpButton);var helpAnchor=document.createElement("a");helpAnchor.href=wmd_options.helpLink;helpAnchor.target=wmd_options.helpTarget;helpAnchor.title=wmd_options.helpHoverTitle;helpButton.appendChild(helpAnchor);var switchButton=addButton("wmd-switch-button","\u5207\u6362\u5230\u666e\u901a\u6a21\u5f0f",function(chunk,postProcessing,useDefaultText){});setUndoRedoButtonStates();var markDownHelp=function(){var bar=$(this).closest("div"); var help=bar.find(".md_help");if(help.is(":hidden"))help.slideDown("fast");else help.slideUp("fast")};$(helpAnchor).bind("click",markDownHelp);var markup=['<div class="md_help">','<ul class="help_items">','<li rel="bold">\u52a0\u7c97</li>','<li rel="italic">\u503e\u659c</li>','<li rel="link">\u94fe\u63a5</li>','<li rel="quote">\u5f15\u7528</li>','<li rel="code">\u4ee3\u7801</li>','<li rel="img">\u56fe\u7247</li>','<li rel="list">\u5217\u8868</li>','<li rel="header">\u6807\u9898</li>','<li rel="at">@</li>', "</ul>",'<div class="help_cnt">','<div id="c_bold"><p><pre>**\u8fd9\u662f\u7c97\u4f53\u5b57**, \u5fc5\u8981\u65f6\u60a8\u53ef\u4ee5***\u540c\u65f6\u4f7f\u7528\u8fd9\u4e24\u79cd\u6837\u5f0f***</pre></p></div>','<div id="c_italic"><p><pre>*\u8fd9\u662f\u659c\u4f53\u5b57*, \u60a8\u4e5f\u53ef\u4ee5\u4f7f\u7528***\u5c06\u659c\u4f53\u52a0\u7c97***\u3002</pre></p></div>','<div id="c_link"><p>\u94fe\u63a5\u529f\u80fd\u67093\u79cd\u4f7f\u7528\u65b9\u6cd5\uff0c\u5177\u4f53\u6709\uff1a<br> 1\u3001\u60a8\u53ef\u4ee5\u4f7f\u7528\u5c16\u62ec\u53f7\u6807\u8bb0\u6587\u672c\u4e3a\u8d85\u94fe\u63a5\uff0c\u4f8b\u5982\uff1a<pre>&lt;http://dewen.org&gt;</pre>2\u3001\u4f7f\u7528\u65b9\u62ec\u53f7\u6807\u8bb0\u6587\u672c\u4e3a\u8d85\u94fe\u63a5\uff0c\u4f8b\u5982\uff1a<pre>[\u5fb7\u95ee](http://www.dewen.org/)\u662f\u4e00\u4e2a\u6280\u672f\u793e\u533a\u3002</pre>3\u3001\u4f7f\u7528\u65b9\u62ec\u53f7\u6dfb\u52a0\u5f15\u7528\u94fe\u63a5\uff0c\u4f8b\u5982\uff1a<pre>\u8fd9\u91cc [\u5fb7\u95ee][1] \u94fe\u63a5\u4e86\u4e00\u4e2a\u9875\u9762\u3002<br>[1]: http://www.dewen.org<code> </code></pre></p></div>', '<div id="c_quote"><p><pre>&gt;<code> </code>\u521b\u5efa\u4e00\u6bb5\u5f15\u7528\u6587\u5b57\n&gt;<code> </code>\u53ef\u4ee5\u6bcf\u884c\u6587\u5b57\u5f00\u5934\u52a0\u4e0a\u201c&gt;\u201d\u7b26\u53f7\u3002\n&gt;<code> </code><b>\u5176\u4ed6\u683c\u5f0f\u5316\u89c4\u5219\u4e5f\u53ef\u4ee5\u8fd0\u884c, \u4f8b\u5982\uff1a</b>\n&gt;<code> </code>1. \u5217\u8868\u6587\u5b57\n&gt;<code> </code>2. \u5217\u8868\u6587\u5b57\n&gt;<code> </code>## \u6807\u9898\u6587\u5b57 ##</pre></p></div>','<div id="c_code"><p>1\u3001\u9009\u4e2d\u7f16\u8f91\u5668\u4e2d\u7684\u4e00\u6bb5\u4ee3\u7801\u70b9\u51fb\u7f16\u8f91\u5668\u5de5\u5177\u6761\u4e0a\u7684"code"\u56fe\u6807\uff0c\u5b8c\u6210\u4ee3\u7801\u683c\u5f0f\u751f\u6210\u3002<br>2\u3001\u5728\u63d2\u5165\u4ee3\u7801\u4f4d\u7f6e\u70b9\u51fb\u7f16\u8f91\u5668\u5de5\u5177\u6761\u4e0a\u7684"code"\u56fe\u6807\uff0c\u5bf9\u8bdd\u6846\u4e2d\u8f93\u5165\u4ee3\u7801\uff0c\u9009\u62e9\u4ee3\u7801\u7c7b\u578b\uff0c\u70b9\u51fb\u786e\u5b9a\u3002</p></div>', '<div id="c_img"><p>\u56fe\u7247\u521b\u5efa\u8ddf\u94fe\u63a5\u5f88\u50cf\uff0c\u4f46\u56fe\u7247\u521b\u5efa\u65f6\u5728\u6700\u524d\u9762\u8981\u52a0\u4e2a"!"\uff0c\u4f8b\u5982\uff1a<pre>![xx_logo](http://example.com/img/logo.jpg)\n![xx_logo][1]\n[1]:<code> </code>http://example.com/img/logo.jpg<code> </code>"\u53ef\u9009\u6807\u9898"</pre>\u65b9\u62ec\u53f7\u5185\u4e3a\u56fe\u7247\u7684Alt\u6ce8\u91ca\u4fe1\u606f</p></div>','<div id="c_list"><p>\u6709\u5e8f\u548c\u65e0\u5e8f\u4e24\u79cd\u5217\u8868\u7684\u7528\u6cd5<pre>1.<code> </code>\u7528\u6570\u5b57\u6807\u8bb0\u6709\u5e8f\u5217\u8868\n2.<code> </code>\u6709\u5e8f\u5217\u8868\u6587\u5b57\n\n*<code> </code>\u5982\u4f55\u6807\u8bb0\u65e0\u5e8f\u5217\u8868\uff0c\u7528\u661f\u53f7\u6807\u8bb0\u4e00\u884c\n+<code> </code>\u7528\u52a0\u53f7\u6807\u8bb0\n-<code> </code>\u7528\u51cf\u53f7\u6807\u8bb0</p></div>', '<div id="c_header"><p>\u4e3a\u4e86\u5c06\u8f93\u5165\u7684\u6587\u5b57\u5206\u6bb5\uff0c\u60a8\u8fd8\u53ef\u4ee5\u4f7f\u7528\u6807\u9898\u6837\u5f0f\uff1a</p><p><pre>\u5927\u6807\u9898\n==============\n\u5c0f\u6807\u9898\n-----------------</pre></p><p>\u5982\u679c\u60a8\u9700\u8981\u5206\u5c42\u8bba\u8ff0\u4e00\u4e2a\u95ee\u9898\uff0c\u8bf7\u4f7f\u7528\u6563\u5217\u6807\u8bb0\uff1a<pre># \u5206\u5c42 1 #\n## \u5206\u5c42 2 ##\n### \u5206\u5c42 3 ###</pre></p></div>','<div id="c_at"><p>@\u63d0\u53ca\u529f\u80fd\uff0c\u63d0\u53ca\u5bf9\u8c61\u53ef\u4ee5\u662f\u7528\u6237\uff0c\u8bdd\u9898\uff0c\u95ee\u9898\u3002<br /> \u5feb\u6377\u952e\uff1aShift+@\uff0c\u7136\u540e\u901a\u8fc7sugest\u641c\u7d22\u60a8\u8981\u63d0\u53ca\u7684\u5bf9\u8c61\u3002</p></div>', "</div>","</div>"];var help_items=$(markup.join("")).appendTo($(helpAnchor).closest("div")).hide();help_items.find(".help_cnt div").hide();var flag=false;help_items.find("li").unbind("click").click(function(){var li=$(this);var id=$(this).attr("rel");if(help_items.find(".help_cnt #c_"+id).is(":hidden")){li.addClass("on");if(!flag){help_items.find(".help_cnt #c_"+id).slideDown("fast");flag=true}else help_items.find(".help_cnt #c_"+id).show()}else{help_items.find(".help_cnt #c_"+id).slideUp("fast"); flag=false;li.removeClass()}help_items.find(".help_cnt div[id!='c_"+id+"']").hide();help_items.find(".help_items li[rel!='"+id+"']").removeClass()})};var setupEditor=function(){if(/\?noundo/.test(document.location.href))wmd.nativeUndo=true;if(!wmd.nativeUndo)undoMgr=new UndoManager(wmd,wmd.panels.input,wmd.options.pastePollInterval,function(){previewRefreshCallback();setUndoRedoButtonStates()});makeSpritedButtonRow();var keyEvent="keydown";if(browser.isOpera)keyEvent="keypress";util.addEvent(inputBox, keyEvent,function(key){if(key.ctrlKey||key.metaKey){var keyCode=key.charCode||key.keyCode;var keyCodeStr=String.fromCharCode(keyCode).toLowerCase();switch(keyCodeStr){case "b":doClick(wmd.buttons["wmd-bold-button"]);break;case "i":doClick(wmd.buttons["wmd-italic-button"]);break;case "l":doClick(wmd.buttons["wmd-link-button"]);break;case "q":doClick(wmd.buttons["wmd-quote-button"]);break;case "k":doClick(wmd.buttons["wmd-code-button"]);break;case "g":doClick(wmd.buttons["wmd-image-button"]);break; case "o":doClick(wmd.buttons["wmd-olist-button"]);break;case "u":doClick(wmd.buttons["wmd-ulist-button"]);break;case "h":doClick(wmd.buttons["wmd-heading-button"]);break;case "r":doClick(wmd.buttons["wmd-hr-button"]);break;case "y":doClick(wmd.buttons["wmd-redo-button"]);break;case "z":if(key.shiftKey)doClick(wmd.buttons["wmd-redo-button"]);else doClick(wmd.buttons["wmd-undo-button"]);break;default:return}if(key.preventDefault)key.preventDefault();if(window.event)window.event.returnValue=false}}); var doClickTimer=null;util.addEvent(inputBox,"keyup",function(key){var keyCode=key.charCode||key.keyCode;if(!key.shiftKey&&!key.ctrlKey&&!key.metaKey)if(keyCode===13){fakeButton={};fakeButton.textOp=command.doAutoindent;doClick(fakeButton)}if(keyCode==13||keyCode==8||keyCode==27||keyCode==18||keyCode==17||keyCode==46||keyCode==16)return false;var state=new TextareaState(wmd.panels.input,wmd);if(!state)return;clearTimeout(doClickTimer);var chunks=state.getChunks();if(chunks.lastChar=="@")doClickTimer= setTimeout(function(){var is_click=false;doClick(wmd.buttons["wmd-at-button"],is_click)},500)});util.addEvent(inputBox,"keydown",function(key){doClickTimer&&clearTimeout(doClickTimer)});if(browser.isIE)util.addEvent(inputBox,"keydown",function(key){var code=key.keyCode;if(code===27)return false});$(inputBox).autoResize({onResize:function(){},animateCallback:function(){},animateDuration:300,extraSpace:18,limit:500})};this.undo=function(){if(undoMgr)undoMgr.undo()};this.redo=function(){if(undoMgr)undoMgr.redo()}; var init=function(){setupEditor()};this.destroy=function(){if(undoMgr)undoMgr.destroy();if(div.parentNode)div.parentNode.removeChild(div);if(inputBox)inputBox.style.marginTop="";window.clearInterval(creationHandle)};init()};command.prefixes="(?:\\s{4,}|\\s*>|\\s*-\\s+|\\s*\\d+\\.|=|\\+|-|_|\\*|#|\\s*\\[[^\n]]+\\]:)";command.unwrap=function(chunk){var txt=new re("([^\\n])\\n(?!(\\n|"+command.prefixes+"))","g");chunk.selection=chunk.selection.replace(txt,"$1 $2")};command.wrap=function(chunk,len){command.unwrap(chunk); var regex=new re("(.{1,"+len+"})( +|$\\n?)","gm");chunk.selection=chunk.selection.replace(regex,function(line,marked){if((new re("^"+command.prefixes,"")).test(line))return line;return marked+"\n"});chunk.selection=chunk.selection.replace(/\s+$/,"")};command.doBold=function(chunk,postProcessing,useDefaultText){return command.doBorI(chunk,2,"\u7c97\u4f53\u6587\u672c")};command.doItalic=function(chunk,postProcessing,useDefaultText){return command.doBorI(chunk,1,"\u659c\u4f53\u6587\u672c")};command.doBorI= function(chunk,nStars,insertText){chunk.trimWhitespace();chunk.selection=chunk.selection.replace(/\n{2,}/g,"\n");chunk.before.search(/(\**$)/);var starsBefore=re.$1;chunk.after.search(/(^\**)/);var starsAfter=re.$1;var prevStars=Math.min(starsBefore.length,starsAfter.length);if(prevStars>=nStars&&(prevStars!=2||nStars!=1)){chunk.before=chunk.before.replace(re("[*]{"+nStars+"}$",""),"");chunk.after=chunk.after.replace(re("^[*]{"+nStars+"}",""),"")}else if(!chunk.selection&&starsAfter){chunk.after= chunk.after.replace(/^([*_]*)/,"");chunk.before=chunk.before.replace(/(\s?)$/,"");var whitespace=re.$1;chunk.before=chunk.before+starsAfter+whitespace}else{if(!chunk.selection&&!starsAfter)chunk.selection=insertText;var markup=nStars<=1?"*":"**";chunk.before=chunk.before+markup;chunk.after=markup+chunk.after}return};command.stripLinkDefs=function(text,defsToAdd){text=text.replace(/^[ ]{0,3}\[(\d+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+|$)/gm,function(totalMatch, id,link,newlines,title){defsToAdd[id]=totalMatch.replace(/\s*$/,"");if(newlines){defsToAdd[id]=totalMatch.replace(/["(](.+?)[")]$/,"");return newlines+title}return""});return text};command.addLinkDef=function(chunk,linkDef){var refNumber=0;var defsToAdd={};chunk.before=command.stripLinkDefs(chunk.before,defsToAdd);chunk.selection=command.stripLinkDefs(chunk.selection,defsToAdd);chunk.after=command.stripLinkDefs(chunk.after,defsToAdd);var defs="";var regex=/(\[(?:\[[^\]]*\]|[^\[\]])*\][ ]?(?:\n[ ]*)?\[)(\d+)(\])/g; var addDefNumber=function(def){refNumber++;def=def.replace(/^[ ]{0,3}\[(\d+)\]:/," ["+refNumber+"]:");defs+="\n"+def};var getLink=function(wholeMatch,link,id,end){if(defsToAdd[id]){addDefNumber(defsToAdd[id]);return link+refNumber+end}return wholeMatch};chunk.before=chunk.before.replace(regex,getLink);if(linkDef)addDefNumber(linkDef);else chunk.selection=chunk.selection.replace(regex,getLink);var refOut=refNumber;chunk.after=chunk.after.replace(regex,getLink);if(chunk.after)chunk.after=chunk.after.replace(/\n*$/, "");if(!chunk.after)chunk.selection=chunk.selection.replace(/\n*$/,"");chunk.after+="\n\n"+defs;return refOut};command.doLinkOrImage=function(chunk,postProcessing,isImage){chunk.trimWhitespace(1);chunk.findTags(/\s*!?\[/,/\][ ]?(?:\n[ ]*)?(\[.*?\])?/);if(chunk.endTag.length>1){chunk.startTag=chunk.startTag.replace(/!?\[/,"");chunk.endTag="";command.addLinkDef(chunk,null)}else{if(/\n\n/.test(chunk.selection)){command.addLinkDef(chunk,null);return}var makeLinkMarkdown=function(link){if(link!==null){chunk.startTag= chunk.endTag="";var linkDef=" [999]: "+link;var num=command.addLinkDef(chunk,linkDef);chunk.startTag=isImage?"\n![":"[";chunk.endTag="]["+num+"]";if(!chunk.selection)if(isImage)chunk.selection="\u8bf7\u8f93\u5165\u56fe\u7247\u63cf\u8ff0";else{title_value=$.trim(title_url.value);chunk.selection=title_value}}postProcessing()};if(isImage)util.prompt(wmd_options.imageDialogText,wmd_options.imageDefaultText,makeLinkMarkdown,true,"",false);else util.prompt(wmd_options.linkDialogText,wmd_options.linkDefaultText, makeLinkMarkdown,false,chunk.selection,false);return true}};command.insertCode=function(chunk,postProcessing){chunk.trimWhitespace(true);if($.trim(chunk.selection)!="")WMDEditor.defaults.is_select_code=true;var makeLinkMarkdown=function(content,lang){function moveachor(chunkbofore_str){var obj=document.getElementsByName("content")[0];if(obj.createTextRange){var range=obj.createTextRange();range.moveStart("character",chunkbofore_str.length);range.collapse(true);range.select()}else{obj.setSelectionRange(obj.value.length, chunkbofore_str.length);obj.focus()}}if(content!=""&&lang!=""){function code_number(str,words){var code_number=0;if($.trim(str)!="")while(str.indexOf(words)!=-1){++code_number;str=str.replace(words,"")}return code_number}var wmd_text=$(".wmd-preview").html();var max_codenumber=0;if($(".wmd-preview").has(".prettyprint").length)max_codenumber=code_number(wmd_text,'class="prettyprint"');WMDEditor.defaults.code_number=max_codenumber;var code_number=++WMDEditor.defaults.code_number;chunk.startTag="<coding-"+ code_number+' lang="'+lang+'">\n';chunk.endTag="\n</coding>";chunk.selection=content;var reg=/^(<coding)\-(\d+)\s*lang=\"(as|bsh|cpp|cs|csh|htm|html|java|js|m|mxml|perl|php|py|rb|sh|xhtml|xsl|other)\"\s*>([\s\S]+)(<\/coding>)$/i;if(WMDEditor.defaults.is_select_code)if(reg.test($.trim(content))){var tmp_arr=reg.exec(content);chunk.selection=tmp_arr[4]}}else;WMDEditor.defaults.is_select_code=false;if(chunk.selection=="")moveachor(chunk.before);postProcessing()};var replacereg=/<coding\-(\d+)(\s*)lang="(as|bsh|c|cpp|cs|csh|delphi|htm|html|java|js|m|mxml|perl|php|py|rb|sh|xhtml|xsl|other)"\s*>([\s\S]*)<\/coding>/i; var str1=chunk.before;var str2=chunk.after;str11=str1.replace(replacereg,"");str22=str2.replace(replacereg,"");var reg=/(.*)<coding\-(\d+)(\s*)lang="(as|bsh|c|cpp|cs|csh|delphi|htm|html|java|js|m|mxml|perl|php|py|rb|sh|xhtml|xsl|other)"\s*>([\s\S]*)/i;var index=parseInt(str22.indexOf("</coding>"));var p=str2.substring(0,index)+"\n";p=p.replace(/([\r\n]+)$/ig,"\n")+"</coding>";var t=str2.substring(index+9,str2.length);if(reg.test(str11)&&str22.indexOf("</coding>")!=-1){var lang=str1.replace(str11, "");if(lang.replace(/^([\s\r\n]*)|([\s\r\n]*)$/ig,"")!=""){var word="</coding>";var index=str1.lastIndexOf(word);var str5=str1.substring(0,index+word.length);var lastindex=str1.lastIndexOf(word);var firstindex=str1.lastIndexOf("<coding");var tmpstr=str1.substring(lastindex+word.length,firstindex);if(tmpstr.replace(/^([\s\r\n]*)|([\s\r\n]*)$/ig,"")!="")str5+=tmpstr}else{var lastindex=str1.lastIndexOf("<coding");var str5=str1.substring(0,lastindex)}var str4=$.trim(str1.replace(str5,"").replace(/^([\s]*)|([\s]*)$/ig, ""));chunk.before=(str5+"\n").replace(/([\r\n]+)$/ig,"\n");chunk.selection=str4+chunk.selection+p;chunk.after=t}else;util.prompt("","",makeLinkMarkdown,true,chunk.selection,true);return true};command.doSuggest=function(chunk,postProcessing,isImage,input,is_click){chunk.trimWhitespace(true);var add="";if(chunk.lastChar!="@")add="@";chunk.before+=add;var input_text=chunk.before+chunk.selection+chunk.after;$("#"+input).val(input_text);var makeLinkMarkdown=function(obj){link=obj.link;text=obj.text;id= obj.id;type=obj.type;if(id!=""&&text!=""){chunk.startTag=chunk.endTag="";chunk.startTag="";var def="";switch(type){case "1":chunk.startTag=text+"("+id+")";break;case "2":chunk.startTag=text+"["+id+"]";break;case "3":chunk.startTag=text+"{"+id+"}";break}}chunk.selection="";postProcessing()};util.suggest(makeLinkMarkdown,chunk,input,is_click);return true};command.doAutoindent=function(chunk,postProcessing,useDefaultText){chunk.before=chunk.before.replace(/(\n|^)[ ]{0,3}([*+-]|\d+[.])[ \t]*\n$/,"\n\n"); chunk.before=chunk.before.replace(/(\n|^)[ ]{0,3}>[ \t]*\n$/,"\n\n");chunk.before=chunk.before.replace(/(\n|^)[ \t]+\n$/,"\n\n");useDefaultText=false;if(/(\n|^)[ ]{0,3}([*+-])[ \t]+.*\n$/.test(chunk.before))if(command.doList)command.doList(chunk,postProcessing,false,true);if(/(\n|^)[ ]{0,3}(\d+[.])[ \t]+.*\n$/.test(chunk.before))if(command.doList)command.doList(chunk,postProcessing,true,true);if(/(\n|^)[ ]{0,3}>[ \t]+.*\n$/.test(chunk.before))if(command.doBlockquote)command.doBlockquote(chunk,postProcessing, useDefaultText);if(/(\n|^)(\t|[ ]{4,}).*\n$/.test(chunk.before))if(command.doCode)command.doCode(chunk,postProcessing,useDefaultText)};command.doBlockquote=function(chunk,postProcessing,useDefaultText){chunk.selection=chunk.selection.replace(/^(\n*)([^\r]+?)(\n*)$/,function(totalMatch,newlinesBefore,text,newlinesAfter){chunk.before+=newlinesBefore;chunk.after=newlinesAfter+chunk.after;return text});chunk.before=chunk.before.replace(/(>[ \t]*)$/,function(totalMatch,blankLine){chunk.selection=blankLine+ chunk.selection;return""});var defaultText=useDefaultText?"\u5f15\u7528\u6587\u672c":"";chunk.selection=chunk.selection.replace(/^(\s|>)+$/,"");chunk.selection=chunk.selection||defaultText;if(chunk.before)chunk.before=chunk.before.replace(/\n?$/,"\n");if(chunk.after)chunk.after=chunk.after.replace(/^\n?/,"\n");chunk.before=chunk.before.replace(/(((\n|^)(\n[ \t]*)*>(.+\n)*.*)+(\n[ \t]*)*$)/,function(totalMatch){chunk.startTag=totalMatch;return""});chunk.after=chunk.after.replace(/^(((\n|^)(\n[ \t]*)*>(.+\n)*.*)+(\n[ \t]*)*)/, function(totalMatch){chunk.endTag=totalMatch;return""});var replaceBlanksInTags=function(useBracket){var replacement=useBracket?"> ":"";if(chunk.startTag)chunk.startTag=chunk.startTag.replace(/\n((>|\s)*)\n$/,function(totalMatch,markdown){return"\n"+markdown.replace(/^[ ]{0,3}>?[ \t]*$/gm,replacement)+"\n"});if(chunk.endTag)chunk.endTag=chunk.endTag.replace(/^\n((>|\s)*)\n/,function(totalMatch,markdown){return"\n"+markdown.replace(/^[ ]{0,3}>?[ \t]*$/gm,replacement)+"\n"})};if(/^(?![ ]{0,3}>)/m.test(chunk.selection)){command.wrap(chunk, wmd_options.lineLength-2);chunk.selection=chunk.selection.replace(/^/gm,"> ");replaceBlanksInTags(true);chunk.addBlankLines()}else{chunk.selection=chunk.selection.replace(/^[ ]{0,3}> ?/gm,"");command.unwrap(chunk);replaceBlanksInTags(false);if(!/^(\n|^)[ ]{0,3}>/.test(chunk.selection)&&chunk.startTag)chunk.startTag=chunk.startTag.replace(/\n{0,2}$/,"\n\n");if(!/(\n|^)[ ]{0,3}>.*$/.test(chunk.selection)&&chunk.endTag)chunk.endTag=chunk.endTag.replace(/^\n{0,2}/,"\n\n")}if(!/\n/.test(chunk.selection))chunk.selection= chunk.selection.replace(/^(> *)/,function(wholeMatch,blanks){chunk.startTag+=blanks;return""})};command.doCode=function(chunk,postProcessing,useDefaultText){var hasTextBefore=/\S[ ]*$/.test(chunk.before);var hasTextAfter=/^[ ]*\S/.test(chunk.after);if(!hasTextAfter&&!hasTextBefore||/\n/.test(chunk.selection)){chunk.before=chunk.before.replace(/[ ]{4}$/,function(totalMatch){chunk.selection=totalMatch+chunk.selection;return""});var nLinesBefore=1;var nLinesAfter=1;if(/\n(\t|[ ]{4,}).*\n$/.test(chunk.before)|| chunk.after==="")nLinesBefore=0;if(/^\n(\t|[ ]{4,})/.test(chunk.after))nLinesAfter=0;chunk.addBlankLines(nLinesBefore,nLinesAfter);if(!chunk.selection){chunk.startTag=" ";chunk.selection=useDefaultText?"\u8bf7\u8f93\u5165\u4ee3\u7801":""}else if(/^[ ]{0,3}\S/m.test(chunk.selection))chunk.selection=chunk.selection.replace(/^/gm," ");else chunk.selection=chunk.selection.replace(/^[ ]{4}/gm,"")}else{chunk.trimWhitespace();chunk.findTags(/`/,/`/);if(!chunk.startTag&&!chunk.endTag){chunk.startTag= chunk.endTag="`";if(!chunk.selection)chunk.selection=useDefaultText?"\u8bf7\u8f93\u5165\u4ee3\u7801":""}else if(chunk.endTag&&!chunk.startTag){chunk.before+=chunk.endTag;chunk.endTag=""}else chunk.startTag=chunk.endTag=""}};command.doList=function(chunk,postProcessing,isNumberedList,useDefaultText){var previousItemsRegex=/(\n|^)(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*$/;var nextItemsRegex=/^\n*(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*/; var bullet="-";var num=1;var getItemPrefix=function(){var prefix;if(isNumberedList){prefix=" "+num+". ";num++}else prefix=" "+bullet+" ";return prefix};var getPrefixedItem=function(itemText){if(isNumberedList===undefined)isNumberedList=/^\s*\d/.test(itemText);itemText=itemText.replace(/^[ ]{0,3}([*+-]|\d+[.])\s/gm,function(_){return getItemPrefix()});return itemText};chunk.findTags(/(\n|^)*[ ]{0,3}([*+-]|\d+[.])\s+/,null);if(chunk.before&&!/\n$/.test(chunk.before)&&!/^\n/.test(chunk.startTag)){chunk.before+= chunk.startTag;chunk.startTag=""}if(chunk.startTag){var hasDigits=/\d+[.]/.test(chunk.startTag);chunk.startTag="";chunk.selection=chunk.selection.replace(/\n[ ]{4}/g,"\n");command.unwrap(chunk);chunk.addBlankLines();if(hasDigits)chunk.after=chunk.after.replace(nextItemsRegex,getPrefixedItem);if(isNumberedList==hasDigits)return}var nLinesBefore=1;chunk.before=chunk.before.replace(previousItemsRegex,function(itemText){if(/^\s*([*+-])/.test(itemText))bullet=re.$1;nLinesBefore=/[^\n]\n\n[^\n]/.test(itemText)? 1:0;return getPrefixedItem(itemText)});if(!chunk.selection)chunk.selection=useDefaultText?"\u8bf7\u8f93\u5165\u5217\u8868\u6587\u5b57":" ";var prefix=getItemPrefix();var nLinesAfter=1;chunk.after=chunk.after.replace(nextItemsRegex,function(itemText){nLinesAfter=/[^\n]\n\n[^\n]/.test(itemText)?1:0;return getPrefixedItem(itemText)});chunk.trimWhitespace(true);chunk.addBlankLines(nLinesBefore,nLinesAfter,true);chunk.startTag=prefix;var spaces=prefix.replace(/./g," ");command.wrap(chunk,wmd_options.lineLength- spaces.length);chunk.selection=chunk.selection.replace(/\n/g,"\n"+spaces)};command.doHeading=function(chunk,postProcessing,useDefaultText){chunk.selection=chunk.selection.replace(/\s+/g," ");chunk.selection=chunk.selection.replace(/(^\s+|\s+$)/g,"");if(!chunk.selection){chunk.startTag="## ";chunk.selection="\u8bf7\u8f93\u5165\u6807\u9898";chunk.endTag=" ##";return}var headerLevel=0;chunk.findTags(/#+[ ]*/,/[ ]*#+/);if(/#+/.test(chunk.startTag))headerLevel=re.lastMatch.length;chunk.startTag=chunk.endTag= "";chunk.findTags(null,/\s?(-+|=+)/);if(/=+/.test(chunk.endTag))headerLevel=1;if(/-+/.test(chunk.endTag))headerLevel=2;chunk.startTag=chunk.endTag="";chunk.addBlankLines(1,1);var headerLevelToCreate=headerLevel==0?2:headerLevel-1;if(headerLevelToCreate>0){var headerChar=headerLevelToCreate>=2?"-":"=";var len=chunk.selection.length;if(len>wmd_options.lineLength)len=wmd_options.lineLength;chunk.endTag="\n";while(len--)chunk.endTag+=headerChar}};command.doHorizontalRule=function(chunk,postProcessing, useDefaultText){chunk.startTag="----------\n";chunk.selection="";chunk.addBlankLines(2,1,true)}}})();function setup_wmd(options){return new WMDEditor(options)};

//end wmd

var Showdown={converter:function(){var i,j,n,o=0;this.makeHtml=function(a){i=[];j=[];n=[];a=a.replace(/~/g,"~T");a=a.replace(/\$/g,"~D");a=a.replace(/\r\n/g,"\n");a=a.replace(/\r/g,"\n");a=u("\n\n"+a+"\n\n");a=a.replace(/^[ \t]+$/mg,"");a=v(a);a=A(a);a=p(a);a=B(a);a=a.replace(/~D/g,"$$");a=a.replace(/~T/g,"~");return a=a.replace(/[a-z0-9_\-+=.]+@[a-z0-9\-]+(\.[a-z0-9-]+)+/ig,function(a){return"<a href='mailto:"+a+"'>"+a+"</a>"})};var A=function(a){return a=a.replace(/^[ ]{0,3}\[(.+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+|\Z)/gm,
function(a,c,b,d,g){c=c.toLowerCase();i[c]=w(b);if(d)return d+g;g&&(j[c]=g.replace(/"/g,"&quot;"));return""})},v=function(a){a=a.replace(/\n/g,"\n\n");a=a.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,l);a=a.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\b[^\r]*?.*<\/\2>[ \t]*(?=\n+)\n)/gm,l);a=a.replace(/(\n[ ]{0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,
l);a=a.replace(/(\n\n[ ]{0,3}<!(--[^\r]*?--\s*)+>[ \t]*(?=\n{2,}))/g,l);a=a.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,l);return a=a.replace(/\n\n/g,"\n")},l=function(a,e){var c;c=e.replace(/\n\n/g,"\n");c=c.replace(/^\n/,"");c=c.replace(/\n+$/g,"");return c="\n\n~K"+(n.push(c)-1)+"K\n\n"},p=function(a){for(var a=C(a),e=h("<hr />"),a=a.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,e),a=a.replace(/^[ ]{0,2}([ ]?\-[ ]?){3,}[ \t]*$/gm,e),a=a.replace(/^[ ]{0,2}([ ]?\_[ ]?){3,}[ \t]*$/gm,
e),a=x(a),a=D(a),a=E(a),a=v(a),a=a.replace(/^\n+/g,""),a=a.replace(/\n+$/g,""),c=a.split(/\n{2,}/g),a=[],e=c.length,b=0;b<e;b++){var d=c[b];0<=d.search(/~K(\d+)K/g)?a.push(d):0<=d.search(/\S/)&&(d=m(d),d=d.replace(/\n/g,"<br />"),d=d.replace(/^([ \t]*)/g,"<p>"),d+="</p>",a.push(d))}e=a.length;for(b=0;b<e;b++)for(;0<=a[b].search(/~K(\d+)K/);)c=n[RegExp.$1],c=c.replace(/\$/g,"$$$$"),a[b]=a[b].replace(/~K\d+K/,c);return a=a.join("\n\n")},m=function(a){a=F(a);a=G(a);a=a.replace(/\\(\\)/g,q);a=a.replace(/\\([`*_{}\[\]()>#+-.!])/g,
q);a=a.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,y);a=a.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,y);a=a.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,r);a=a.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?(.*?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,r);a=a.replace(/(\[([^\[\]]+)\])()()()()()/g,r);a=w(a);a=a.replace(/(\*\*|__)(?=\S)([^\r]*?\S[*_]*)\1/g,"<strong>$2</strong>");a=a.replace(/(\w)_(\w)/g,"$1~E95E$2");a=a.replace(/(\*)(?=\S)([^\r]*?\S)\1/g,
"<em>$2</em>");return a=a.replace(/  +\n/g," <br />\n")},G=function(a){return a=a.replace(/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--.*?--\s*)+>)/gi,function(a){a=a.replace(/(.)<\/?code>(?=.)/g,"$1`");return a=k(a,"\\`*_")})},r=function(a,e,c,b,d,g,h,f){void 0==f&&(f="");a=b.toLowerCase();if(""==d)if(""==a&&(a=c.toLowerCase().replace(/ ?\n/g," ")),void 0!=i[a])d=i[a],void 0!=j[a]&&(f=j[a]);else if(-1<e.search(/\(\s*\)$/m))d="";else return e;d=k(d,"*_");e='<a target="_blank"  href="'+d+'"';""!=f&&
(f=f.replace(/"/g,"&quot;"),f=k(f,"*_"),e+=' title="'+f+'"');return e+(">"+c+"</a>")},y=function(a,e,c,b,d,g,h,f){a=c;b=b.toLowerCase();f||(f="");if(""==d)if(""==b&&(b=a.toLowerCase().replace(/ ?\n/g," ")),void 0!=i[b])d=i[b],void 0!=j[b]&&(f=j[b]);else return e;a=a.replace(/"/g,"&quot;");d=k(d,"*_");e='<img src="'+d+'" alt="'+a+'"';f=f.replace(/"/g,"&quot;");f=k(f,"*_");return e+(' title="'+f+'"')+" />"},C=function(a){a=a.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(a,c){return h("<h1>"+m(c)+"</h1>")});
a=a.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(a,c){return h("<h2>"+m(c)+"</h2>")});return a=a.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\1\n+/gm,function(a,c,b){a=c.length;return h("<h"+a+">"+m(b)+"</h"+a+">")})},s,x=function(a){var a=a+"~0",e=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;o?a=a.replace(e,function(a,e,d){a=e;d=-1<d.search(/[*+-]/g)?"ul":"ol";a=a.replace(/\n{2,}/g,"\n\n\n");a=s(a);a=a.replace(/\s+$/,"");return"<"+d+">"+a+"</"+d+">\n"}):
(e=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g,a=a.replace(e,function(a,e,d,g){a=d;g=-1<g.search(/[*+-]/g)?"ul":"ol";a=a.replace(/\n{2,}/g,"\n\n\n");a=s(a);return e+"<"+g+">\n"+a+"</"+g+">\n"}));return a=a.replace(/~0/,"")};s=function(a){o++;a=a.replace(/\n{2,}$/,"\n");a=(a+"~0").replace(/(\n)?(^[ \t]*)([*+-]|\d+[.])[ \t]+([^\r]+?(\n{1,2}))(?=\n*(~0|\2([*+-]|\d+[.])[ \t]+))/gm,function(a,c,b,d,g){a=g;c||-1<a.search(/\n{2,}/)?a=p(t(a)):(a=
x(t(a)),a=a.replace(/\n$/,""),a=m(a));return"<li>"+a+"</li>\n"});a=a.replace(/~0/g,"");o--;return a};var D=function(a){a=(a+"~0").replace(/(?:\n\n|\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,function(a,c,b){a=z(t(c));a=u(a);a=a.replace(/^\n+/g,"");a=a.replace(/\n+$/g,"");return h("<pre><code>"+a+"\n</code></pre>")+b});return a=a.replace(/~0/,"")},h=function(a){a=a.replace(/(^\n+|\n+$)/g,"");return"\n\n~K"+(n.push(a)-1)+"K\n\n"},F=function(a){return a=a.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,
function(a,c,b,d){a=d.replace(/^([ \t]*)/g,"");a=a.replace(/[ \t]*$/g,"");a=z(a);return c+"<code>"+a+"</code>"})},z=function(a){a=a.replace(/&/g,"&amp;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");return a=k(a,"*_{}[]\\",!1)},E=function(a){return a=a.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(a,c){var b;b=c.replace(/^[ \t]*>[ \t]?/gm,"~0");b=b.replace(/~0/g,"");b=b.replace(/^[ \t]+$/gm,"");b=p(b);b=b.replace(/(^|\n)/g,"$1  ");b=b.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(a,
b){var c;c=b.replace(/^  /mg,"~0");return c=c.replace(/~0/g,"")});return h("<blockquote>\n"+b+"\n</blockquote>")})},w=function(a){a=a.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;");a=a.replace(/<(?![a-z\/?\$!])/gi,"&lt;");a=a.replace(/\u2018/g,"&lsquo;");a=a.replace(/\u2019/g,"&rsquo;");a=a.replace(/\u201c/g,"&ldquo;");a=a.replace(/\u201d/g,"&rdquo;");return a=a.replace(/\u2013/g,"&mdash;")},B=function(a){return a=a.replace(/~E(\d+)E/g,function(a,c){var b=parseInt(c);return String.fromCharCode(b)})},
t=function(a){a=a.replace(/^(\t|[ ]{1,4})/gm,"~0");return a=a.replace(/~0/g,"")},u=function(a){a=a.replace(/\t(?=\t)/g,"    ");a=a.replace(/\t/g,"~A~B");a=a.replace(/~B(.+?)~A/g,function(a,c){for(var b=c,d=4-b.length%4,g=0;g<d;g++)b+=" ";return b});a=a.replace(/~A/g,"    ");return a=a.replace(/~B/g,"")},k=function(a,e,c){e="(["+e.replace(/([\[\]\\])/g,"\\$1")+"])";c&&(e="\\\\"+e);return a=a.replace(RegExp(e,"g"),q)},q=function(a,e){return"~E"+e.charCodeAt(0)+"E"}}};

/* jTemplates 0.7.8 (http://jtemplates.tpython.com) Copyright (c) 2009 Tomasz Gloc */
if(window.jQuery&&!window.jQuery.createTemplate)(function(jQuery){var Template=function(s,includes,settings){this._tree=[];this._param={};this._includes=null;this._templates={};this._templates_code={};this.settings=jQuery.extend({disallow_functions:false,filter_data:true,filter_params:false,runnable_functions:false,clone_data:true,clone_params:true},settings);this.f_cloneData=this.settings.f_cloneData!==undefined?this.settings.f_cloneData:TemplateUtils.cloneData;this.f_escapeString=this.settings.f_escapeString!==
undefined?this.settings.f_escapeString:TemplateUtils.escapeHTML;this.splitTemplates(s,includes);if(s)this.setTemplate(this._templates_code["MAIN"],includes,this.settings);this._templates_code=null};Template.prototype.version="0.7.8";Template.DEBUG_MODE=true;Template.prototype.splitTemplates=function(s,includes){var reg=/\{#template *(\w*?)( .*)*\}/g;var iter,tname,se;var lastIndex=null;var _template_settings=[];while((iter=reg.exec(s))!=null){lastIndex=reg.lastIndex;tname=iter[1];se=s.indexOf("{#/template "+
tname+"}",lastIndex);if(se==-1)throw new Error('jTemplates: Template "'+tname+'" is not closed.');this._templates_code[tname]=s.substring(lastIndex,se);_template_settings[tname]=TemplateUtils.optionToObject(iter[2])}if(lastIndex===null){this._templates_code["MAIN"]=s;return}for(var i in this._templates_code)if(i!="MAIN")this._templates[i]=new Template;for(var i in this._templates_code)if(i!="MAIN"){this._templates[i].setTemplate(this._templates_code[i],jQuery.extend({},includes||{},this._templates||
{}),jQuery.extend({},this.settings,_template_settings[i]));this._templates_code[i]=null}};Template.prototype.setTemplate=function(s,includes,settings){if(s==undefined){this._tree.push(new TextNode("",1,this));return}s=s.replace(/[\n\r]/g,"");s=s.replace(/\{\*.*?\*\}/g,"");this._includes=jQuery.extend({},this._templates||{},includes||{});this.settings=new Object(settings);var node=this._tree;var op=s.match(/\{#.*?\}/g);var ss=0,se=0;var e;var literalMode=0;var elseif_level=0;for(var i=0,l=op?op.length:
0;i<l;++i){var this_op=op[i];if(literalMode){se=s.indexOf("{#/literal}");if(se==-1)throw new Error("jTemplates: No end of literal.");if(se>ss)node.push(new TextNode(s.substring(ss,se),1,this));ss=se+11;literalMode=0;i=jQuery.inArray("{#/literal}",op);continue}se=s.indexOf(this_op,ss);if(se>ss)node.push(new TextNode(s.substring(ss,se),literalMode,this));var ppp=this_op.match(/\{#([\w\/]+).*?\}/);var op_=RegExp.$1;switch(op_){case "elseif":++elseif_level;node.switchToElse();case "if":e=new opIF(this_op,
node);node.push(e);node=e;break;case "else":node.switchToElse();break;case "/if":while(elseif_level){node=node.getParent();--elseif_level}case "/for":case "/foreach":node=node.getParent();break;case "foreach":e=new opFOREACH(this_op,node,this);node.push(e);node=e;break;case "for":e=opFORFactory(this_op,node,this);node.push(e);node=e;break;case "continue":case "break":node.push(new JTException(op_));break;case "include":node.push(new Include(this_op,this._includes));break;case "param":node.push(new UserParam(this_op));
break;case "cycle":node.push(new Cycle(this_op));break;case "ldelim":node.push(new TextNode("{",1,this));break;case "rdelim":node.push(new TextNode("}",1,this));break;case "literal":literalMode=1;break;case "/literal":if(Template.DEBUG_MODE)throw new Error("jTemplates: Missing begin of literal.");break;default:if(Template.DEBUG_MODE)throw new Error("jTemplates: unknown tag: "+op_+".");}ss=se+this_op.length}if(s.length>ss)node.push(new TextNode(s.substr(ss),literalMode,this))};Template.prototype.get=
function(d,param,element,deep){++deep;var $T=d,_param1,_param2;if(this.settings.clone_data)$T=this.f_cloneData(d,{escapeData:this.settings.filter_data&&deep==1,noFunc:this.settings.disallow_functions},this.f_escapeString);if(!this.settings.clone_params){_param1=this._param;_param2=param}else{_param1=this.f_cloneData(this._param,{escapeData:this.settings.filter_params,noFunc:false},this.f_escapeString);_param2=this.f_cloneData(param,{escapeData:this.settings.filter_params&&deep==1,noFunc:false},this.f_escapeString)}var $P=
jQuery.extend({},_param1,_param2);var $Q=element!=undefined?element:{};$Q.version=this.version;var ret="";for(var i=0,l=this._tree.length;i<l;++i)ret+=this._tree[i].get($T,$P,$Q,deep);--deep;return ret};Template.prototype.setParam=function(name,value){this._param[name]=value};TemplateUtils=function(){};TemplateUtils.escapeHTML=function(txt){return txt.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")};TemplateUtils.cloneData=function(d,filter,
f_escapeString){if(d==null)return d;switch(d.constructor){case Object:var o={};for(var i in d)o[i]=TemplateUtils.cloneData(d[i],filter,f_escapeString);if(!filter.noFunc)if(d.hasOwnProperty("toString"))o.toString=d.toString;return o;case Array:var o=[];for(var i=0,l=d.length;i<l;++i)o[i]=TemplateUtils.cloneData(d[i],filter,f_escapeString);return o;case String:return filter.escapeData?f_escapeString(d):d;case Function:if(filter.noFunc)if(Template.DEBUG_MODE)throw new Error("jTemplates: Functions are not allowed.");
else return undefined;default:return d}};TemplateUtils.optionToObject=function(optionText){if(optionText===null||optionText===undefined)return{};var o=optionText.split(/[= ]/);if(o[0]==="")o.shift();var obj={};for(var i=0,l=o.length;i<l;i+=2)obj[o[i]]=o[i+1];return obj};var TextNode=function(val,literalMode,template){this._value=val;this._literalMode=literalMode;this._template=template};TextNode.prototype.get=function(d,param,element,deep){var __t=this._value;if(!this._literalMode){var __template=
this._template;var $T=d;var $P=param;var $Q=element;__t=__t.replace(/\{(.*?)\}/g,function(__0,__1){try{var __tmp=eval(__1);if(typeof __tmp=="function")if(__template.settings.disallow_functions||!__template.settings.runnable_functions)return"";else __tmp=__tmp($T,$P,$Q);return __tmp===undefined?"":String(__tmp)}catch(e){if(Template.DEBUG_MODE){if(e instanceof JTException)e.type="subtemplate";throw e;}return""}})}return __t};var opIF=function(oper,par){this._parent=par;oper.match(/\{#(?:else)*if (.*?)\}/);
this._cond=RegExp.$1;this._onTrue=[];this._onFalse=[];this._currentState=this._onTrue};opIF.prototype.push=function(e){this._currentState.push(e)};opIF.prototype.getParent=function(){return this._parent};opIF.prototype.switchToElse=function(){this._currentState=this._onFalse};opIF.prototype.get=function(d,param,element,deep){var $T=d;var $P=param;var $Q=element;var ret="";try{var tab=eval(this._cond)?this._onTrue:this._onFalse;for(var i=0,l=tab.length;i<l;++i)ret+=tab[i].get(d,param,element,deep)}catch(e){if(Template.DEBUG_MODE||
e instanceof JTException)throw e;}return ret};opFORFactory=function(oper,par,template){if(oper.match(/\{#for (\w+?) *= *(\S+?) +to +(\S+?) *(?:step=(\S+?))*\}/)){oper="{#foreach opFORFactory.funcIterator as "+RegExp.$1+" begin="+(RegExp.$2||0)+" end="+(RegExp.$3||-1)+" step="+(RegExp.$4||1)+" extData=$T}";return new opFOREACH(oper,par,template)}else throw new Error('jTemplates: Operator failed "find": '+oper);};opFORFactory.funcIterator=function(i){return i};var opFOREACH=function(oper,par,template){this._parent=
par;this._template=template;oper.match(/\{#foreach (.+?) as (\w+?)( .+)*\}/);this._arg=RegExp.$1;this._name=RegExp.$2;this._option=RegExp.$3||null;this._option=TemplateUtils.optionToObject(this._option);this._onTrue=[];this._onFalse=[];this._currentState=this._onTrue};opFOREACH.prototype.push=function(e){this._currentState.push(e)};opFOREACH.prototype.getParent=function(){return this._parent};opFOREACH.prototype.switchToElse=function(){this._currentState=this._onFalse};opFOREACH.prototype.get=function(d,
param,element,deep){try{var $T=d;var $P=param;var $Q=element;var fcount=eval(this._arg);var key=[];var mode=typeof fcount;if(mode=="object"){var arr=[];jQuery.each(fcount,function(k,v){key.push(k);arr.push(v)});fcount=arr}var extData=this._option.extData!==undefined?eval(this._option.extData):$T!=null?$T:{};var s=Number(eval(this._option.begin)||0),e;var step=Number(eval(this._option.step)||1);if(mode!="function")e=fcount.length;else if(this._option.end===undefined||this._option.end===null)e=Number.MAX_VALUE;
else e=Number(eval(this._option.end))+(step>0?1:-1);var ret="";var i,l;if(this._option.count){var tmp=s+Number(eval(this._option.count));e=tmp>e?e:tmp}if(e>s&&step>0||e<s&&step<0){var iteration=0;var _total=mode!="function"?Math.ceil((e-s)/step):undefined;var ckey,cval;for(;step>0?s<e:s>e;s+=step,++iteration){ckey=key[s];if(mode!="function")cval=fcount[s];else{cval=fcount(s);if(cval===undefined||cval===null)break}if(typeof cval=="function"&&(this._template.settings.disallow_functions||!this._template.settings.runnable_functions))continue;
if(mode=="object"&&ckey in Object)continue;var prevValue=extData[this._name];extData[this._name]=cval;extData[this._name+"$index"]=s;extData[this._name+"$iteration"]=iteration;extData[this._name+"$first"]=iteration==0;extData[this._name+"$last"]=s+step>=e;extData[this._name+"$total"]=_total;extData[this._name+"$key"]=ckey!==undefined&&ckey.constructor==String?this._template.f_escapeString(ckey):ckey;extData[this._name+"$typeof"]=typeof cval;for(i=0,l=this._onTrue.length;i<l;++i)try{ret+=this._onTrue[i].get(extData,
param,element,deep)}catch(ex){if(ex instanceof JTException)switch(ex.type){case "continue":i=l;break;case "break":i=l;s=e;break;default:throw e;}else throw e;}delete extData[this._name+"$index"];delete extData[this._name+"$iteration"];delete extData[this._name+"$first"];delete extData[this._name+"$last"];delete extData[this._name+"$total"];delete extData[this._name+"$key"];delete extData[this._name+"$typeof"];delete extData[this._name];extData[this._name]=prevValue}}else for(i=0,l=this._onFalse.length;i<
l;++i)ret+=this._onFalse[i].get($T,param,element,deep);return ret}catch(e){if(Template.DEBUG_MODE||e instanceof JTException)throw e;return""}};var JTException=function(type){this.type=type};JTException.prototype=Error;JTException.prototype.get=function(d){throw this;};var Include=function(oper,includes){oper.match(/\{#include (.*?)(?: root=(.*?))?\}/);this._template=includes[RegExp.$1];if(this._template==undefined)if(Template.DEBUG_MODE)throw new Error("jTemplates: Cannot find include: "+RegExp.$1);
this._root=RegExp.$2};Include.prototype.get=function(d,param,element,deep){var $T=d;var $P=param;try{return this._template.get(eval(this._root),param,element,deep)}catch(e){if(Template.DEBUG_MODE||e instanceof JTException)throw e;}return""};var UserParam=function(oper){oper.match(/\{#param name=(\w*?) value=(.*?)\}/);this._name=RegExp.$1;this._value=RegExp.$2};UserParam.prototype.get=function(d,param,element,deep){var $T=d;var $P=param;var $Q=element;try{param[this._name]=eval(this._value)}catch(e){if(Template.DEBUG_MODE||
e instanceof JTException)throw e;param[this._name]=undefined}return""};var Cycle=function(oper){oper.match(/\{#cycle values=(.*?)\}/);this._values=eval(RegExp.$1);this._length=this._values.length;if(this._length<=0)throw new Error("jTemplates: cycle has no elements");this._index=0;this._lastSessionID=-1};Cycle.prototype.get=function(d,param,element,deep){var sid=jQuery.data(element,"jTemplateSID");if(sid!=this._lastSessionID){this._lastSessionID=sid;this._index=0}var i=this._index++%this._length;
return this._values[i]};jQuery.fn.setTemplate=function(s,includes,settings){if(s.constructor===Template)return jQuery(this).each(function(){jQuery.data(this,"jTemplate",s);jQuery.data(this,"jTemplateSID",0)});else return jQuery(this).each(function(){jQuery.data(this,"jTemplate",new Template(s,includes,settings));jQuery.data(this,"jTemplateSID",0)})};jQuery.fn.setTemplateURL=function(url_,includes,settings){var s=jQuery.ajax({url:url_,async:false}).responseText;return jQuery(this).setTemplate(s,includes,
settings)};jQuery.fn.setTemplateElement=function(elementName,includes,settings){var s=jQuery("#"+elementName).val();if(s==null){s=jQuery("#"+elementName).html();s=s.replace(/&lt;/g,"<").replace(/&gt;/g,">")}s=jQuery.trim(s);s=s.replace(/^<\!\[CDATA\[([\s\S]*)\]\]>$/im,"$1");s=s.replace(/^<\!--([\s\S]*)--\>$/im,"$1");return jQuery(this).setTemplate(s,includes,settings)};jQuery.fn.hasTemplate=function(){var count=0;jQuery(this).each(function(){if(jQuery.getTemplate(this))++count});return count};jQuery.fn.removeTemplate=
function(){jQuery(this).processTemplateStop();return jQuery(this).each(function(){jQuery.removeData(this,"jTemplate")})};jQuery.fn.setParam=function(name,value){return jQuery(this).each(function(){var t=jQuery.getTemplate(this);if(t===undefined)if(Template.DEBUG_MODE)throw new Error("jTemplates: Template is not defined.");else return;t.setParam(name,value)})};jQuery.fn.processTemplate=function(d,param){return jQuery(this).each(function(){var t=jQuery.getTemplate(this);if(t===undefined)if(Template.DEBUG_MODE)throw new Error("jTemplates: Template is not defined.");
else return;jQuery.data(this,"jTemplateSID",jQuery.data(this,"jTemplateSID")+1);jQuery(this).html(t.get(d,param,this,0))})};jQuery.fn.processTemplateURL=function(url_,param,options){var that=this;options=jQuery.extend({type:"GET",async:true,cache:false},options);jQuery.ajax({url:url_,type:options.type,data:options.data,dataFilter:options.dataFilter,async:options.async,cache:options.cache,timeout:options.timeout,dataType:"json",success:function(d){var r=jQuery(that).processTemplate(d,param);if(options.on_success)options.on_success(r)},
error:options.on_error,complete:options.on_complete});return this};var Updater=function(url,param,interval,args,objs,options){this._url=url;this._param=param;this._interval=interval;this._args=args;this.objs=objs;this.timer=null;this._options=options||{};var that=this;jQuery(objs).each(function(){jQuery.data(this,"jTemplateUpdater",that)});this.run()};Updater.prototype.run=function(){this.detectDeletedNodes();if(this.objs.length==0)return;var that=this;jQuery.getJSON(this._url,this._args,function(d){var r=
jQuery(that.objs).processTemplate(d,that._param);if(that._options.on_success)that._options.on_success(r)});this.timer=setTimeout(function(){that.run()},this._interval)};Updater.prototype.detectDeletedNodes=function(){this.objs=jQuery.grep(this.objs,function(o){if(jQuery.browser.msie){var n=o.parentNode;while(n&&n!=document)n=n.parentNode;return n!=null}else return o.parentNode!=null})};jQuery.fn.processTemplateStart=function(url,param,interval,args,options){return new Updater(url,param,interval,args,
this,options)};jQuery.fn.processTemplateStop=function(){return jQuery(this).each(function(){var updater=jQuery.data(this,"jTemplateUpdater");if(updater==null)return;var that=this;updater.objs=jQuery.grep(updater.objs,function(o){return o!=that});jQuery.removeData(this,"jTemplateUpdater")})};jQuery.extend({createTemplate:function(s,includes,settings){return new Template(s,includes,settings)},createTemplateURL:function(url_,includes,settings){var s=jQuery.ajax({url:url_,async:false}).responseText;return new Template(s,
includes,settings)},getTemplate:function(element){return jQuery.data(element,"jTemplate")},processTemplateToText:function(template,data,parameter){return template.get(data,parameter,undefined,0)},jTemplatesDebugMode:function(value){Template.DEBUG_MODE=value}})})(jQuery);

//prettify.js
window.PR_SHOULD_USE_CONTINUATION=!0;window.PR_TAB_WIDTH=8;window.PR_normalizedHtml=window.PR=window.prettyPrintOne=window.prettyPrint=void 0;window._pr_isIE6=function(){var w=navigator&&navigator.userAgent&&navigator.userAgent.match(/\bMSIE ([678])\./),w=w?+w[1]:!1;window._pr_isIE6=function(){return w};return w}; (function(){function w(a){return a.replace(H,"&amp;").replace(I,"&lt;").replace(J,"&gt;")}function D(a,c,d){switch(a.nodeType){case 1:var m=a.tagName.toLowerCase();c.push("<",m);var e=a.attributes,h=e.length;if(h){if(d){for(var v=[],j=h;0<=--j;)v[j]=e[j];v.sort(function(a,c){return a.name<c.name?-1:a.name===c.name?0:1});e=v}for(j=0;j<h;++j)v=e[j],v.specified&&c.push(" ",v.name.toLowerCase(),'="',v.value.replace(H,"&amp;").replace(I,"&lt;").replace(J,"&gt;").replace(S,"&quot;"),'"')}c.push(">");for(e= a.firstChild;e;e=e.nextSibling)D(e,c,d);(a.firstChild||!/^(?:br|link|img)$/.test(m))&&c.push("</",m,">");break;case 3:case 4:c.push(w(a.nodeValue))}}function K(a){function c(a){if("\\"!==a.charAt(0))return a.charCodeAt(0);switch(a.charAt(1)){case "b":return 8;case "t":return 9;case "n":return 10;case "v":return 11;case "f":return 12;case "r":return 13;case "u":case "x":return parseInt(a.substring(2),16)||a.charCodeAt(1);case "0":case "1":case "2":case "3":case "4":case "5":case "6":case "7":return parseInt(a.substring(1), 8);default:return a.charCodeAt(1)}}function d(a){if(32>a)return(16>a?"\\x0":"\\x")+a.toString(16);a=String.fromCharCode(a);if("\\"===a||"-"===a||"["===a||"]"===a)a="\\"+a;return a}function m(a){for(var g=a.substring(1,a.length-1).match(RegExp("\\\\u[0-9A-Fa-f]{4}|\\\\x[0-9A-Fa-f]{2}|\\\\[0-3][0-7]{0,2}|\\\\[0-7]{1,2}|\\\\[\\s\\S]|-|[^-\\\\]","g")),a=[],b=[],j="^"===g[0],f=j?1:0,k=g.length;f<k;++f){var i=g[f];switch(i){case "\\B":case "\\b":case "\\D":case "\\d":case "\\S":case "\\s":case "\\W":case "\\w":a.push(i); continue}var i=c(i),e;f+2<k&&"-"===g[f+1]?(e=c(g[f+2]),f+=2):e=i;b.push([i,e]);65>e||122<i||(65>e||90<i||b.push([Math.max(65,i)|32,Math.min(e,90)|32]),97>e||122<i||b.push([Math.max(97,i)&-33,Math.min(e,122)&-33]))}b.sort(function(a,b){return a[0]-b[0]||b[1]-a[1]});g=[];i=[NaN,NaN];for(f=0;f<b.length;++f)k=b[f],k[0]<=i[1]+1?i[1]=Math.max(i[1],k[1]):g.push(i=k);b=["["];j&&b.push("^");b.push.apply(b,a);for(f=0;f<g.length;++f)k=g[f],b.push(d(k[0])),k[1]>k[0]&&(k[1]+1>k[0]&&b.push("-"),b.push(d(k[1]))); b.push("]");return b.join("")}function e(a){for(var g=a.source.match(RegExp("(?:\\[(?:[^\\x5C\\x5D]|\\\\[\\s\\S])*\\]|\\\\u[A-Fa-f0-9]{4}|\\\\x[A-Fa-f0-9]{2}|\\\\[0-9]+|\\\\[^ux0-9]|\\(\\?[:!=]|[\\(\\)\\^]|[^\\x5B\\x5C\\(\\)\\^]+)","g")),b=g.length,c=[],f=0,d=0;f<b;++f){var i=g[f];"("===i?++d:"\\"===i.charAt(0)&&(i=+i.substring(1))&&i<=d&&(c[i]=-1)}for(f=1;f<c.length;++f)-1===c[f]&&(c[f]=++h);for(d=f=0;f<b;++f)i=g[f],"("===i?(++d,void 0===c[d]&&(g[f]="(?:")):"\\"===i.charAt(0)&&(i=+i.substring(1))&& i<=d&&(g[f]="\\"+c[d]);for(d=f=0;f<b;++f)"^"===g[f]&&"^"!==g[f+1]&&(g[f]="");if(a.ignoreCase&&v)for(f=0;f<b;++f)i=g[f],a=i.charAt(0),2<=i.length&&"["===a?g[f]=m(i):"\\"!==a&&(g[f]=i.replace(/[a-zA-Z]/g,function(a){a=a.charCodeAt(0);return"["+String.fromCharCode(a&-33,a|32)+"]"}));return g.join("")}for(var h=0,v=!1,j=!1,p=0,l=a.length;p<l;++p){var r=a[p];if(r.ignoreCase)j=!0;else if(/[a-z]/i.test(r.source.replace(/\\u[0-9a-f]{4}|\\x[0-9a-f]{2}|\\[^ux]/gi,""))){v=!0;j=!1;break}}for(var q=[],p=0,l=a.length;p< l;++p){r=a[p];if(r.global||r.multiline)throw Error(""+r);q.push("(?:"+e(r)+")")}return RegExp(q.join("|"),j?"gi":"g")}function T(a){var c=0;return function(d){for(var m=null,e=0,h=0,v=d.length;h<v;++h)switch(d.charAt(h)){case "\t":m||(m=[]);m.push(d.substring(e,h));e=a-c%a;for(c+=e;0<=e;e-=16)m.push(" ".substring(0,e));e=h+1;break;case "\n":c=0;break;default:++c}if(!m)return d;m.push(d.substring(e));return m.join("")}}function E(a,c,d,m){c&&(a={source:c,basePos:a},d(a),m.push.apply(m, a.decorations))}function z(a,c){var d={},m;(function(){for(var e=a.concat(c),j=[],h={},l=0,r=e.length;l<r;++l){var q=e[l],s=q[3];if(s)for(var g=s.length;0<=--g;)d[s.charAt(g)]=q;q=q[1];s=""+q;h.hasOwnProperty(s)||(j.push(q),h[s]=null)}j.push(/[\0-\uffff]/);m=K(j)})();var e=c.length,h=function(a){for(var j=a.basePos,p=[j,u],l=0,r=a.source.match(m)||[],q={},s=0,g=r.length;s<g;++s){var b=r[s],n=q[b],f=void 0,k;if("string"===typeof n)k=!1;else{var i=d[b.charAt(0)];if(i)f=b.match(i[1]),n=i[0];else{for(k= 0;k<e;++k)if(i=c[k],f=b.match(i[1])){n=i[0];break}f||(n=u)}if((k=5<=n.length&&"lang-"===n.substring(0,5))&&!(f&&"string"===typeof f[1]))k=!1,n=L;k||(q[b]=n)}i=l;l+=b.length;if(k){k=f[1];var o=b.indexOf(k),x=o+k.length;f[2]&&(x=b.length-f[2].length,o=x-k.length);n=n.substring(5);E(j+i,b.substring(0,o),h,p);E(j+i+o,k,M(n,k),p);E(j+i+x,b.substring(x),h,p)}else p.push(j+i,n)}a.decorations=p};return h}function t(a){var c=[],d=[];a.tripleQuotedStrings?c.push([y,/^(?:\'\'\'(?:[^\'\\]|\\[\s\S]|\'{1,2}(?=[^\']))*(?:\'\'\'|$)|\"\"\"(?:[^\"\\]|\\[\s\S]|\"{1,2}(?=[^\"]))*(?:\"\"\"|$)|\'(?:[^\\\']|\\[\s\S])*(?:\'|$)|\"(?:[^\\\"]|\\[\s\S])*(?:\"|$))/, null,"'\""]):a.multiLineStrings?c.push([y,/^(?:\'(?:[^\\\']|\\[\s\S])*(?:\'|$)|\"(?:[^\\\"]|\\[\s\S])*(?:\"|$)|\`(?:[^\\\`]|\\[\s\S])*(?:\`|$))/,null,"'\"`"]):c.push([y,/^(?:\'(?:[^\\\'\r\n]|\\.)*(?:\'|$)|\"(?:[^\\\"\r\n]|\\.)*(?:\"|$))/,null,"\"'"]);a.verbatimStrings&&d.push([y,/^@\"(?:[^\"]|\"\")*(?:\"|$)/,null]);a.hashComments&&(a.cStyleComments?(c.push([A,/^#(?:(?:define|elif|else|endif|error|ifdef|include|ifndef|line|pragma|undef|warning)\b|[^\r\n]*)/,null,"#"]),d.push([y,/^<(?:(?:(?:\.\.\/)*|\/?)(?:[\w-]+(?:\/[\w-]+)+)?[\w-]+\.h|[a-z]\w*)>/, null])):c.push([A,/^#[^\r\n]*/,null,"#"]));a.cStyleComments&&(d.push([A,/^\/\/[^\r\n]*/,null]),d.push([A,/^\/\*[\s\S]*?(?:\*\/|$)/,null]));a.regexLiterals&&d.push(["lang-regex",RegExp("^"+U+"(/(?=[^/*])(?:[^/\\x5B\\x5C]|\\x5C[\\s\\S]|\\x5B(?:[^\\x5C\\x5D]|\\x5C[\\s\\S])*(?:\\x5D|$))+/)")]);a=a.keywords.replace(/^\s+|\s+$/g,"");a.length&&d.push([N,RegExp("^(?:"+a.replace(/\s+/g,"|")+")\\b"),null]);c.push([u,/^\s+/,null," \r\n\t\u00a0"]);d.push([F,/^@[a-z_$][a-z_$@0-9]*/i,null],[O,/^@?[A-Z]+[a-z][A-Za-z_$@0-9]*/, null],[u,/^[a-z_$][a-z_$@0-9]*/i,null],[F,/^(?:0x[a-f0-9]+|(?:\d(?:_\d+)*\d*(?:\.\d*)?|\.\d\+)(?:e[+\-]?\d+)?)[a-z]*/i,null,"0123456789"],[B,/^.[^\s\w\.$@\'\"\`\/\#]*/,null]);return z(c,d)}function V(a){function c(a){if(a>v){j&&j!==p&&(h.push("</span>"),j=null);!j&&p&&(j=p,h.push('<span class="',j,'">'));var c=w(q(d.substring(v,a))).replace(f?g:s,"$1&#160;");f=n.test(c);h.push(c.replace(b,o));v=a}}var d=a.source,m=a.extractedTags,e=a.decorations,h=[],v=0,j=null,p=null,l=0,r=0,q=T(window.PR_TAB_WIDTH), s=/([\r\n ]) /g,g=/(^| ) /gm,b=/\r\n?|\n/g,n=/[ \r\n]$/,f=!0,k=window._pr_isIE6(),k=k?a.sourceNode&&"PRE"===a.sourceNode.tagName?6===k?"&#160;\r\n":7===k?"&#160;<br>\r":"&#160;\r":"&#160;<br />":"<br />",i=a.sourceNode?a.sourceNode.className.match(/\blinenums\b(?::(\d+))?/):null,o;if(i){for(var x=[],t=0;10>t;++t)x[t]=k+'</li><li class="L'+t+'">';var u=i[1]&&i[1].length?i[1]-1:0;h.push('<ol class="linenums"><li class="L',u%10,'"');u&&h.push(' value="',u+1,'"');h.push(">");o=function(){var a=x[++u% 10];return j?"</span>"+a+'<span class="'+j+'">':a}}else o=k;for(;;)if(l<m.length&&(r<e.length?m[l]<=e[r]:1))c(m[l]),j&&(h.push("</span>"),j=null),h.push(m[l+1]),l+=2;else if(r<e.length)c(e[r]),p=e[r+1],r+=2;else break;c(d.length);j&&h.push("</span>");i&&h.push("</li></ol>");a.prettyPrintedHtml=h.join("")}function o(a,c){for(var d=c.length;0<=--d;){var m=c[d];C.hasOwnProperty(m)?"console"in window&&console.warn("cannot override language handler %s",m):C[m]=a}}function M(a,c){if(!a||!C.hasOwnProperty(a))a= /^\s*</.test(c)?"default-markup":"default-code";return C[a]}function P(a){var c,d=a.sourceCodeHtml,m=a.langExtension;a.prettyPrintedHtml=d;try{var e=d.match(W),d=[],h=0,o=[];if(e)for(var j=0,p=e.length;j<p;++j){var l=e[j];if(1<l.length&&"<"===l.charAt(0)){if(!X.test(l))if(Y.test(l))d.push(l.substring(9,l.length-3)),h+=l.length-12;else if(Z.test(l))d.push("\n"),++h;else if(0<=l.indexOf(Q)&&l.replace(/\s(\w+)\s*=\s*(?:\"([^\"]*)\"|'([^\']*)'|(\S+))/g,' $1="$2$3$4"').match(/[cC][lL][aA][sS][sS]=\"[^\"]*\bnocode\b/)){var r= l.match(R)[2],q=1,s;s=j+1;a:for(;s<p;++s){var g=e[s].match(R);if(g&&g[2]===r)if("/"===g[1]){if(0===--q)break a}else++q}s<p?(o.push(h,e.slice(j,s+1).join("")),j=s):o.push(h,l)}else o.push(h,l)}else{var b;var q=l,n=q.indexOf("&");if(0>n)b=q;else{for(--n;0<=(n=q.indexOf("&#",n+1));){var f=q.indexOf(";",n);if(0<=f){var k=q.substring(n+3,f),i=10;k&&"x"===k.charAt(0)&&(k=k.substring(1),i=16);var t=parseInt(k,i);isNaN(t)||(q=q.substring(0,n)+String.fromCharCode(t)+q.substring(f+1))}}b=q.replace($,"<").replace(aa, ">").replace(ba,"'").replace(ca,'"').replace(da," ").replace(ea,"&")}d.push(b);h+=b.length}}c=d.join("");a.source=c;a.basePos=0;a.extractedTags=o;M(m,c)(a);V(a)}catch(u){"console"in window&&console.log(u&&u.stack?u.stack:u)}}var y="str",N="kwd",A="com",O="typ",F="lit",B="pun",u="pln",L="src",Q="nocode",U=function(){for(var a="! != !== # % %= & && &&= &= ( * *= += , -= -> / /= : :: ; < << <<= <= = == === > >= >> >>= >>> >>>= ? @ [ ^ ^= ^^ ^^= { | |= || ||= ~ break case continue delete do else finally instanceof return throw try typeof".split(" "), c="(?:^^|[+-]",d=0;d<a.length;++d)c+="|"+a[d].replace(/([^=<>:&a-z])/g,"\\$1");return c+")\\s*"}(),H=/&/g,I=/</g,J=/>/g,S=/\"/g,$=/&lt;/g,aa=/&gt;/g,ba=/&apos;/g,ca=/&quot;/g,ea=/&amp;/g,da=/&nbsp;/g,fa=/[\r\n]/g,G=null,W=RegExp("[^<]+|<\!--[\\s\\S]*?--\>|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>|</?[a-zA-Z](?:[^>\"']|'[^']*'|\"[^\"]*\")*>|<","g"),X=/^<\!--/,Y=/^<!\[CDATA\[/,Z=/^<br\b/i,R=/^<(\/?)([a-zA-Z][a-zA-Z0-9]*)/,ga=t({keywords:"break continue do else for if return while auto case char const default double enum extern float goto int long register short signed sizeof static struct switch typedef union unsigned void volatile catch class delete false import new operator private protected public this throw true try typeof alignof align_union asm axiom bool concept concept_map const_cast constexpr decltype dynamic_cast explicit export friend inline late_check mutable namespace nullptr reinterpret_cast static_assert static_cast template typeid typename using virtual wchar_t where break continue do else for if return while auto case char const default double enum extern float goto int long register short signed sizeof static struct switch typedef union unsigned void volatile catch class delete false import new operator private protected public this throw true try typeof abstract boolean byte extends final finally implements import instanceof null native package strictfp super synchronized throws transient as base by checked decimal delegate descending event fixed foreach from group implicit in interface internal into is lock object out override orderby params partial readonly ref sbyte sealed stackalloc string select uint ulong unchecked unsafe ushort var break continue do else for if return while auto case char const default double enum extern float goto int long register short signed sizeof static struct switch typedef union unsigned void volatile catch class delete false import new operator private protected public this throw true try typeof debugger eval export function get null set undefined var with Infinity NaN caller delete die do dump elsif eval exit foreach for goto if import last local my next no our print package redo require sub undef unless until use wantarray while BEGIN END break continue do else for if return while and as assert class def del elif except exec finally from global import in is lambda nonlocal not or pass print raise try with yield False True None break continue do else for if return while alias and begin case class def defined elsif end ensure false in module next nil not or redo rescue retry self super then true undef unless until when yield BEGIN END break continue do else for if return while case done elif esac eval fi function in local set then until ", hashComments:!0,cStyleComments:!0,multiLineStrings:!0,regexLiterals:!0}),C={};o(ga,["default-code"]);o(z([],[[u,/^[^<?]+/],["dec",/^<!\w[^>]*(?:>|$)/],[A,/^<\!--[\s\S]*?(?:-\->|$)/],["lang-",/^<\?([\s\S]+?)(?:\?>|$)/],["lang-",/^<%([\s\S]+?)(?:%>|$)/],[B,/^(?:<[%?]|[%?]>)/],["lang-",/^<xmp\b[^>]*>([\s\S]+?)<\/xmp\b[^>]*>/i],["lang-js",/^<script\b[^>]*>([\s\S]*?)(<\/script\b[^>]*>)/i],["lang-css",/^<style\b[^>]*>([\s\S]*?)(<\/style\b[^>]*>)/i],["lang-in.tag",/^(<\/?[a-z][^<>]*>)/i]]),"default-markup,htm,html,mxml,xhtml,xml,xsl".split(",")); o(z([[u,/^[\s]+/,null," \t\r\n"],["atv",/^(?:\"[^\"]*\"?|\'[^\']*\'?)/,null,"\"'"]],[["tag",/^^<\/?[a-z](?:[\w.:-]*\w)?|\/?>$/i],["atn",/^(?!style[\s=]|on)[a-z](?:[\w:-]*\w)?/i],["lang-uq.val",/^=\s*([^>\'\"\s]*(?:[^>\'\"\s\/]|\/(?=\s)))/],[B,/^[=<>\/]+/],["lang-js",/^on\w+\s*=\s*\"([^\"]+)\"/i],["lang-js",/^on\w+\s*=\s*\'([^\']+)\'/i],["lang-js",/^on\w+\s*=\s*([^\"\'>\s]+)/i],["lang-css",/^style\s*=\s*\"([^\"]+)\"/i],["lang-css",/^style\s*=\s*\'([^\']+)\'/i],["lang-css",/^style\s*=\s*([^\"\'>\s]+)/i]]), ["in.tag"]);o(z([],[["atv",/^[\s\S]+/]]),["uq.val"]);o(t({keywords:"break continue do else for if return while auto case char const default double enum extern float goto int long register short signed sizeof static struct switch typedef union unsigned void volatile catch class delete false import new operator private protected public this throw true try typeof alignof align_union asm axiom bool concept concept_map const_cast constexpr decltype dynamic_cast explicit export friend inline late_check mutable namespace nullptr reinterpret_cast static_assert static_cast template typeid typename using virtual wchar_t where ", hashComments:!0,cStyleComments:!0}),"c,cc,cpp,cxx,cyc,m".split(","));o(t({keywords:"null true false"}),["json"]);o(t({keywords:"break continue do else for if return while auto case char const default double enum extern float goto int long register short signed sizeof static struct switch typedef union unsigned void volatile catch class delete false import new operator private protected public this throw true try typeof abstract boolean byte extends final finally implements import instanceof null native package strictfp super synchronized throws transient as base by checked decimal delegate descending event fixed foreach from group implicit in interface internal into is lock object out override orderby params partial readonly ref sbyte sealed stackalloc string select uint ulong unchecked unsafe ushort var ", hashComments:!0,cStyleComments:!0,verbatimStrings:!0}),["cs"]);o(t({keywords:"break continue do else for if return while auto case char const default double enum extern float goto int long register short signed sizeof static struct switch typedef union unsigned void volatile catch class delete false import new operator private protected public this throw true try typeof abstract boolean byte extends final finally implements import instanceof null native package strictfp super synchronized throws transient ", cStyleComments:!0}),["java"]);o(t({keywords:"break continue do else for if return while case done elif esac eval fi function in local set then until ",hashComments:!0,multiLineStrings:!0}),["bsh","csh","sh"]);o(t({keywords:"break continue do else for if return while and as assert class def del elif except exec finally from global import in is lambda nonlocal not or pass print raise try with yield False True None ",hashComments:!0,multiLineStrings:!0,tripleQuotedStrings:!0}),["cv","py"]);o(t({keywords:"caller delete die do dump elsif eval exit foreach for goto if import last local my next no our print package redo require sub undef unless until use wantarray while BEGIN END ", hashComments:!0,multiLineStrings:!0,regexLiterals:!0}),["perl","pl","pm"]);o(t({keywords:"break continue do else for if return while alias and begin case class def defined elsif end ensure false in module next nil not or redo rescue retry self super then true undef unless until when yield BEGIN END ",hashComments:!0,multiLineStrings:!0,regexLiterals:!0}),["rb"]);o(t({keywords:"break continue do else for if return while auto case char const default double enum extern float goto int long register short signed sizeof static struct switch typedef union unsigned void volatile catch class delete false import new operator private protected public this throw true try typeof debugger eval export function get null set undefined var with Infinity NaN ", cStyleComments:!0,regexLiterals:!0}),["js"]);o(z([],[[y,/^[\s\S]+/]]),["regex"]);window.PR_normalizedHtml=D;window.prettyPrintOne=function(a,c){var d={sourceCodeHtml:a,langExtension:c};P(d);return d.prettyPrintedHtml};window.prettyPrint=function(a){function c(){for(var d=window.PR_SHOULD_USE_CONTINUATION?j.now()+250:Infinity;p<m.length&&j.now()<d;p++){var e=m[p];if(e.className&&0<=e.className.indexOf("prettyprint")){var h=e.className.match(/\blang-(\w+)\b/);h&&(h=h[1]);for(var g=!1,b=e.parentNode;b;b= b.parentNode)if(("pre"===b.tagName||"code"===b.tagName||"xmp"===b.tagName)&&b.className&&0<=b.className.indexOf("prettyprint")){g=!0;break}if(!g){b=e;null===G&&(g=document.createElement("PRE"),g.appendChild(document.createTextNode('<!DOCTYPE foo PUBLIC "foo bar">\n<foo />')),G=!/</.test(g.innerHTML));if(G)if(g=b.innerHTML,"XMP"===b.tagName)g=w(g);else{if("PRE"===b.tagName||!fa.test(g))b=!0;else{var n="";b.currentStyle?n=b.currentStyle.whiteSpace:window.getComputedStyle&&(n=window.getComputedStyle(b, null).whiteSpace);b=!n||"pre"===n}b||(g=g.replace(/(<br\s*\/?>)[\r\n]+/g,"$1").replace(/^(?:[\r\n]+[ \t]*)+$/g," "))}else{g=[];for(b=b.firstChild;b;b=b.nextSibling)D(b,g);g=g.join("")}g=g.replace(/(?:\r\n?|\n)$/,"");l={sourceCodeHtml:g,langExtension:h,sourceNode:e};P(l);if(e=l.prettyPrintedHtml)if(h=l.sourceNode,"XMP"===h.tagName){g=document.createElement("PRE");for(b=0;b<h.attributes.length;++b)n=h.attributes[b],n.specified&&("class"===n.name.toLowerCase()?g.className=n.value:g.setAttribute(n.name, n.value));g.innerHTML=e;h.parentNode.replaceChild(g,h)}else h.innerHTML=e}}}p<m.length?setTimeout(c,250):a&&a()}for(var d=[document.getElementsByTagName("pre"),document.getElementsByTagName("code"),document.getElementsByTagName("xmp")],m=[],e=0;e<d.length;++e)for(var h=0,o=d[e].length;h<o;++h)m.push(d[e][h]);var d=null,j=Date;j.now||(j={now:function(){return(new Date).getTime()}});var p=0,l;c()};window.PR={combinePrefixPatterns:K,createSimpleLexer:z,registerLangHandler:o,sourceDecorator:t,PR_ATTRIB_NAME:"atn", PR_ATTRIB_VALUE:"atv",PR_COMMENT:A,PR_DECLARATION:"dec",PR_KEYWORD:N,PR_LITERAL:F,PR_NOCODE:Q,PR_PLAIN:u,PR_PUNCTUATION:B,PR_SOURCE:L,PR_STRING:y,PR_TAG:"tag",PR_TYPE:O}})();
